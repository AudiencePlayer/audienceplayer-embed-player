{"version":3,"file":"bundle.js","mappings":"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MC,EAAyB,CAC3BC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KAC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","sources":["webpack://audienceplayer-embed-player/webpack/bootstrap","webpack://audienceplayer-embed-player/./src/models/play-config.ts","webpack://audienceplayer-embed-player/webpack/runtime/define property getters","webpack://audienceplayer-embed-player/webpack/runtime/hasOwnProperty shorthand","webpack://audienceplayer-embed-player/./src/utils/platform.ts","webpack://audienceplayer-embed-player/./src/models/player.ts","webpack://audienceplayer-embed-player/./src/logging/player-log-processor.ts","webpack://audienceplayer-embed-player/./src/logging/player-logger-service.ts","webpack://audienceplayer-embed-player/./src/video-player/hotkeys.ts","webpack://audienceplayer-embed-player/./src/utils/locale.ts","webpack://audienceplayer-embed-player/./src/api/graph-request.ts","webpack://audienceplayer-embed-player/./src/api/converters.ts","webpack://audienceplayer-embed-player/./src/api/api-service.ts","webpack://audienceplayer-embed-player/./src/api/queries.ts","webpack://audienceplayer-embed-player/./src/chromecast/chromecast-sender.ts","webpack://audienceplayer-embed-player/./src/video-player/video-player.ts","webpack://audienceplayer-embed-player/./src/video-player/plugins/audio-track-button.ts","webpack://audienceplayer-embed-player/./src/video-player/plugins/chromecast-button.ts","webpack://audienceplayer-embed-player/./src/video-player/plugins/custom-overlay.ts","webpack://audienceplayer-embed-player/./src/video-player/plugins/overlay.ts","webpack://audienceplayer-embed-player/./src/video-player/plugins/playback-rate-button.ts","webpack://audienceplayer-embed-player/./src/video-player/plugins/skip-intro.ts","webpack://audienceplayer-embed-player/./src/video-player/plugins/subtitles-button.ts","webpack://audienceplayer-embed-player/./src/video-player/plugins/chromecast-tech.ts","webpack://audienceplayer-embed-player/./src/utils/eme.ts","webpack://audienceplayer-embed-player/./src/embed-player.ts","webpack://audienceplayer-embed-player/./src/chromecast/chromecast-controls.ts"],"sourcesContent":["// The require scope\nvar __webpack_require__ = {};\n\n","export interface PlayConfig {\n    pulseToken: string;\n    currentTime: number;\n    entitlements: PlayEntitlement[];\n    subtitles: PlayConfigSubtitle[];\n    articleId?: number;\n    assetId: number;\n    subtitleLocale: string;\n    audioLocale: string;\n    aspectRatio: string;\n    localTimeDelta?: number;\n    skipIntro?: {\n        start: number;\n        end: number;\n    };\n    continuePaused?: boolean;\n}\n\nexport interface PlayEntitlement {\n    src: string;\n    type: MimeType;\n    isLive: boolean;\n    protectionInfo: PlayConfigProtection[] | null;\n    mediaProvider: string;\n}\n\nexport interface PlayConfigSubtitle {\n    src: string;\n    srclang: string;\n    kind: string;\n    label: string;\n}\n\nexport interface PlayConfigProtection {\n    type: DrmType;\n    authenticationToken?: string;\n    certificateUrl?: string;\n    keyDeliveryUrl: string;\n    encryptionProvider: string;\n    contentKeyId?: string;\n}\n\nexport enum ArticlePlayErrors {\n    noPlayableAsset = 'noPlayableAsset',\n    notAuthenticated = 'notAuthenticated',\n    needEntitlement = 'needEntitlement',\n    serverError = 'serverError',\n    offlineError = 'offlineError',\n    maxConcurrentStreamNumberError = 'maxConcurrentStreamNumberError',\n}\n\nexport type DrmType = 'Widevine' | 'PlayReady' | 'FairPlay';\nexport type MimeType = 'application/x-mpegURL' | 'application/dash+xml' | 'video/mp4';\nexport const MimeTypeHls = 'application/x-mpegURL';\nexport const MimeTypeDash = 'application/dash+xml';\nexport const MimeTypeMp4 = 'video/mp4';\n","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","export function supportsNativeHLS(videojs: any) {\n    return (videojs.browser.IS_ANY_SAFARI && videojs.browser.IS_IOS) || videojs.browser.IS_SAFARI;\n}\n\nexport function supportsHLS(videojs: any) {\n    return videojs.browser.IS_ANY_SAFARI || videojs.browser.IS_IOS;\n}\n","export interface PlaySession {\n    eventStack: PlayerEventState[];\n    localTimeDelta: number;\n    pulseToken: string;\n    deviceType: PlayerDeviceTypes;\n    isLive: boolean;\n    onStopCallback?: (appr: number) => void;\n}\n\nexport enum PlayingState {\n    loading, // chromecast only\n    playing,\n    paused,\n    idle,\n    buffering, // chromecast only\n    error,\n}\n\nexport interface PlayerProperties {\n    state: PlayingState;\n    error: string | null;\n    mediaDuration: number;\n    playPosition: number;\n    audioTrack: string;\n    textTrack: string;\n    resolution: string;\n}\n\nexport interface PlayerEventState extends PlayerProperties {\n    eventType: PlayerEventTypes;\n    timeStamp: number;\n}\n\nexport class PlayerLogPayload {\n    pulse_token: string;\n    event_stack: PlayerEventPayload[];\n    device_type: PlayerDeviceTypes;\n    pulse_mode: PulseMode;\n}\n\nexport interface PlayerEventPayload {\n    timestamp: number;\n    event_type: PlayerEventTypePayloads;\n    appa?: number;\n    appr?: number;\n    time_delta?: number;\n    subtitle_locale?: string;\n    audio_locale?: string;\n    event_payload?: string;\n    resolution_tag?: string;\n}\n\n// generic abstraction of player events that are taken from the video player, Chromecast and mobile implementations\nexport enum PlayerEventTypes {\n    playStart = 'playStart', // before attempt to play with given play configuration\n    playing = 'playing', // play state is playing\n    pause = 'pause', // play state is paused\n    error = 'error', // an error occured\n    stopped = 'stopped', // player was manually closed, or video was ended\n    timeupdate = 'timeupdate', // play position of video updated\n    textTrackChanged = 'textTrackChanged',\n    audioTrackChanged = 'audioTrackChanged',\n}\n\nexport enum PlayerDeviceTypes {\n    chromecast = 'chromecast',\n    default = '', // API should figure it out based on Navigator agent\n}\n\nexport enum PlayerEventTypePayloads {\n    play = 'play',\n    playing = 'playing',\n    paused = 'paused',\n    stop = 'stop',\n    error = 'error',\n    configure = 'configure',\n}\n\nexport enum PulseMode {\n    live = 'live',\n    archive = 'archive',\n    offline = 'offline',\n}\n","import {\n    PlayerEventPayload,\n    PlayerEventState,\n    PlayerEventTypePayloads,\n    PlayerEventTypes,\n    PlayerLogPayload,\n    PlayingState,\n    PlaySession,\n    PulseMode,\n} from '../models/player';\n\nconst MAX_EVENTS = 30;\n\nexport class PlayerLogProcessor {\n    protected apiUrl: string;\n    protected playLogs: PlayerLogPayload[] = [];\n    protected apiCallInProgress = false;\n    protected intervalHandle: any = null;\n\n    constructor(baseUrl: string, projectId: number) {\n        this.apiUrl = `${baseUrl}/service/${projectId}/analytics/stream/pulse/log`.replace(/\\/*$/, '');\n    }\n\n    init() {\n        if (this.intervalHandle === null) {\n            this.intervalHandle = setInterval(() => {\n                this.processFirstPlayLog();\n            }, 3000);\n        }\n    }\n\n    destroy() {\n        if (this.intervalHandle) {\n            clearInterval(this.intervalHandle);\n        }\n        this.intervalHandle = null;\n    }\n\n    processPlaySession(playSession: PlaySession, timeStamp: number) {\n        if (!playSession) {\n            return;\n        }\n\n        const eventStack = playSession.eventStack;\n\n        if (eventStack.length === 0) {\n            return;\n        }\n\n        const eventStackPayload: PlayerEventPayload[] = [];\n        let i = 0,\n            sumDelta = 0,\n            lastEventWasProcessed = false;\n\n        while (i < eventStack.length) {\n            const currentEvent = eventStack[i];\n\n            if (this.isEventTypeWithoutTimeDelta(currentEvent.eventType)) {\n                // directly process these events. they have no sumDelta and do not affect the play state\n                eventStackPayload.push(this.convertEventToEventPayload(currentEvent));\n                lastEventWasProcessed = true;\n            } else {\n                lastEventWasProcessed = false;\n                if (i - 1 >= 0) {\n                    const previousEvent = eventStack[i - 1];\n\n                    sumDelta += currentEvent.timeStamp - previousEvent.timeStamp;\n\n                    if (currentEvent.state !== previousEvent.state) {\n                        eventStackPayload.push(this.createDeltaEventPayload(previousEvent, previousEvent.timeStamp, sumDelta));\n                        sumDelta = 0;\n                    }\n                }\n            }\n            i++;\n        }\n\n        const lastEvent = eventStack[eventStack.length - 1];\n\n        if (sumDelta > 0 || !lastEventWasProcessed) {\n            eventStackPayload.push(this.createDeltaEventPayload(lastEvent, timeStamp, sumDelta));\n        }\n\n        if (eventStackPayload.length > 0) {\n            if (eventStackPayload.length > MAX_EVENTS) {\n                // if event stack too big, add error with runaway info and slice nr of items\n                const lastLogEvent = eventStackPayload[eventStackPayload.length - 1];\n                eventStackPayload.splice(MAX_EVENTS - 1);\n                lastLogEvent.event_type = PlayerEventTypePayloads.error;\n                lastLogEvent.event_payload = '{\"code\": 429, \"message\": \"Too many events\"}'; // runaway\n                eventStackPayload.push(lastLogEvent);\n            }\n\n            // check if there is already a log for this session\n            let playLogPayload = this.getPlayerLogPayloadWithPulseToken(playSession.pulseToken);\n            if (!playLogPayload) {\n                playLogPayload = {\n                    event_stack: [],\n                    pulse_token: playSession.pulseToken,\n                    pulse_mode: playSession.isLive ? PulseMode.live : PulseMode.offline,\n                    device_type: playSession.deviceType,\n                };\n                this.playLogs.push(playLogPayload);\n            }\n            // keep the event_stack pointer in tact by using push\n            eventStackPayload.forEach(e => playLogPayload.event_stack.push(e));\n\n            this.processPlayLog(playLogPayload, playSession);\n        }\n    }\n\n    processFirstPlayLog() {\n        if (this.playLogs.length > 0) {\n            this.processPlayLog(this.playLogs[0], null);\n        }\n    }\n\n    protected processPlayLog(currentLog: PlayerLogPayload, playSession: PlaySession) {\n        if (!currentLog || this.apiCallInProgress) {\n            return;\n        }\n\n        if (currentLog.event_stack.length === 0) {\n            this.removePlayLog(currentLog);\n            return;\n        }\n\n        const logToSend: PlayerLogPayload = {\n            ...currentLog,\n            event_stack: [],\n        };\n\n        let eventStackIndex = 0,\n            isStopCutOff = false;\n\n        while (eventStackIndex < currentLog.event_stack.length && logToSend.event_stack.length < MAX_EVENTS && !isStopCutOff) {\n            const currentEvent = currentLog.event_stack[eventStackIndex];\n            eventStackIndex++;\n            logToSend.event_stack.push(currentEvent);\n\n            if (currentEvent.event_type === PlayerEventTypePayloads.stop) {\n                isStopCutOff = true;\n            }\n        }\n\n        // for offline logging, always accumulate until MAX_EVENTS before sending unless it's a stop cut off.\n        if (logToSend.pulse_mode === PulseMode.offline && logToSend.event_stack.length < MAX_EVENTS && !isStopCutOff) {\n            return;\n        }\n\n        // transaction start\n        this.apiCallInProgress = true;\n\n        return fetch(this.apiUrl, {\n            method: 'POST',\n            headers: {\n                'Content-Type': 'application/json',\n                Accept: 'application/json',\n            },\n            body: JSON.stringify(logToSend),\n        })\n            .then(() => {\n                return true;\n            })\n            .catch(error => {\n                return error.status !== 0;\n            })\n            .then(response => {\n                if (response) {\n                    currentLog.event_stack.splice(0, eventStackIndex);\n                    if (currentLog.event_stack.length === 0) {\n                        this.removePlayLog(currentLog);\n                    }\n                } else {\n                    currentLog.pulse_mode = PulseMode.archive;\n                }\n                this.apiCallInProgress = false;\n            });\n    }\n\n    protected getPlayerLogPayloadWithPulseToken(pulseToken: string): PlayerLogPayload {\n        return this.playLogs.find(log => log.pulse_token === pulseToken);\n    }\n\n    protected removePlayLog(logPayload: PlayerLogPayload) {\n        const index = this.playLogs.findIndex(log => log.pulse_token === logPayload.pulse_token);\n        if (index >= 0) {\n            this.playLogs.splice(index, 1);\n        }\n    }\n\n    protected isEventTypeWithoutTimeDelta(eventType: PlayerEventTypes) {\n        return [PlayerEventTypes.textTrackChanged, PlayerEventTypes.audioTrackChanged, PlayerEventTypes.playStart].indexOf(eventType) >= 0;\n    }\n\n    protected createBaseEventPayload(playerEvent: PlayerEventState, eventType: PlayerEventTypePayloads): PlayerEventPayload {\n        return {\n            timestamp: playerEvent.timeStamp,\n            event_type: eventType,\n            appa: playerEvent.playPosition,\n            appr: Math.min(playerEvent.playPosition / playerEvent.mediaDuration, 1),\n            resolution_tag: playerEvent.resolution,\n        };\n    }\n\n    protected convertEventToEventPayload(playerEvent: PlayerEventState): PlayerEventPayload {\n        if (playerEvent.eventType === PlayerEventTypes.playStart) {\n            return {\n                timestamp: playerEvent.timeStamp,\n                event_type: PlayerEventTypePayloads.play,\n            };\n        }\n        const eventType = this.convertEventTypeToEventTypePayload(playerEvent);\n        const baseEvent = this.createBaseEventPayload(playerEvent, eventType);\n        switch (playerEvent.eventType) {\n            case PlayerEventTypes.audioTrackChanged:\n                return {\n                    ...baseEvent,\n                    audio_locale: playerEvent.audioTrack,\n                };\n            case PlayerEventTypes.textTrackChanged:\n                return {\n                    ...baseEvent,\n                    subtitle_locale: playerEvent.textTrack,\n                };\n            default:\n                return baseEvent;\n        }\n    }\n\n    protected createDeltaEventPayload(playerEvent: PlayerEventState, timestamp: number, timeDelta: number): PlayerEventPayload {\n        const eventType = this.getEventTypePayloadFromEventState(playerEvent);\n        const baseEvent = this.createBaseEventPayload(playerEvent, eventType);\n        const errorPart = playerEvent.state === PlayingState.error ? {event_payload: playerEvent.error} : {};\n\n        return {\n            ...baseEvent,\n            ...errorPart,\n            timestamp,\n            time_delta: timeDelta / 1000,\n        };\n    }\n\n    protected getEventTypePayloadFromEventState(playerEvent: PlayerEventState): PlayerEventTypePayloads {\n        switch (playerEvent.state) {\n            case PlayingState.playing:\n                return PlayerEventTypePayloads.playing;\n            case PlayingState.paused:\n                return PlayerEventTypePayloads.paused;\n            case PlayingState.error:\n                return PlayerEventTypePayloads.error;\n            case PlayingState.buffering:\n            case PlayingState.loading:\n                return PlayerEventTypePayloads.paused; // buffering and loading converted to paused for API\n            case PlayingState.idle:\n                return PlayerEventTypePayloads.stop;\n        }\n    }\n\n    protected convertEventTypeToEventTypePayload(playerEvent: PlayerEventState): PlayerEventTypePayloads {\n        switch (playerEvent.eventType) {\n            case PlayerEventTypes.playStart:\n                return PlayerEventTypePayloads.play;\n            case PlayerEventTypes.audioTrackChanged:\n            case PlayerEventTypes.textTrackChanged:\n                return PlayerEventTypePayloads.configure;\n\n            // because e.g. `timeupdate` events can happen while paused / playing, base the rest on state.\n            default: {\n                this.getEventTypePayloadFromEventState(playerEvent);\n            }\n        }\n    }\n}\n","import {PlayerLogProcessor} from './player-log-processor';\nimport {PlayerDeviceTypes, PlayerEventTypes, PlayerProperties, PlayingState, PlaySession} from '../models/player';\n\nexport class PlayerLoggerService {\n    private playerLogProcessor: PlayerLogProcessor;\n    protected playerProperties: PlayerProperties;\n    protected playSession: PlaySession;\n    protected intervalHandle = 0;\n\n    constructor(baseUrl: string, projectId: number) {\n        this.playerLogProcessor = new PlayerLogProcessor(baseUrl, projectId);\n        this.reset();\n    }\n\n    init() {\n        this.playerLogProcessor.init();\n    }\n\n    destroy() {\n        this.playerLogProcessor.destroy();\n    }\n\n    onStart(\n        pulseToken: string,\n        deviceType: PlayerDeviceTypes,\n        localTimeDelta: number,\n        isLive: boolean,\n        onStopCallback?: (appr: number) => void\n    ) {\n        this.reset();\n\n        this.playSession = {\n            pulseToken,\n            deviceType,\n            eventStack: [],\n            localTimeDelta,\n            isLive,\n            onStopCallback,\n        };\n    }\n\n    onCurrentTimeUpdated(currentTime: number) {\n        this.playerProperties.playPosition = currentTime;\n\n        if (this.playerProperties.mediaDuration > 0 && this.playerProperties.state !== PlayingState.idle) {\n            this.logEvent(PlayerEventTypes.timeupdate);\n        }\n    }\n\n    onDurationUpdated(duration: number) {\n        this.playerProperties.mediaDuration = duration;\n    }\n\n    onPlaying() {\n        if (this.playerProperties.state !== PlayingState.playing) {\n            if (this.playerProperties.state === PlayingState.idle) {\n                this.playerProperties.state = PlayingState.playing;\n                this.logEvent(PlayerEventTypes.playStart);\n                this.processPlaySession();\n                this.startInterval();\n            } else {\n                this.playerProperties.state = PlayingState.playing;\n                this.logEvent(PlayerEventTypes.playing);\n            }\n        }\n    }\n\n    onPause() {\n        if (this.playerProperties.state !== PlayingState.paused && this.playerProperties.state !== PlayingState.idle) {\n            this.playerProperties.state = PlayingState.paused;\n            this.logEvent(PlayerEventTypes.pause);\n        }\n    }\n\n    onError(error: string) {\n        if (this.playerProperties.state !== PlayingState.error) {\n            this.playerProperties.state = PlayingState.error;\n            this.playerProperties.error = error;\n            this.logEvent(PlayerEventTypes.error);\n        }\n    }\n\n    onStop() {\n        if (this.playerProperties.state !== PlayingState.idle) {\n            this.playerProperties.state = PlayingState.idle;\n            this.logEvent(PlayerEventTypes.stopped);\n            this.stopInterval();\n            this.processPlaySession();\n        }\n    }\n\n    onTextTrackChanged(textTrack: string) {\n        if (this.playerProperties.state === PlayingState.idle) {\n            return;\n        }\n        this.playerProperties.textTrack = textTrack;\n        this.logEvent(PlayerEventTypes.textTrackChanged);\n    }\n\n    onAudioTrackChanged(audioTrack: string) {\n        if (this.playerProperties.state === PlayingState.idle) {\n            return;\n        }\n        this.playerProperties.audioTrack = audioTrack;\n\n        this.logEvent(PlayerEventTypes.audioTrackChanged);\n    }\n\n    updateProperties(playerProperties: Partial<PlayerProperties>) {\n        this.playerProperties = {\n            ...this.playerProperties,\n            ...playerProperties,\n        };\n    }\n\n    protected startInterval() {\n        this.stopInterval();\n        // @ts-ignore\n        this.intervalHandle = setInterval(() => {\n            this.processPlaySession();\n        }, 30000);\n    }\n\n    protected stopInterval() {\n        if (this.intervalHandle) {\n            clearInterval(this.intervalHandle);\n        }\n    }\n\n    protected processPlaySession() {\n        this.playerLogProcessor.processPlaySession({...this.playSession}, this.getTimeStamp());\n        this.playSession.eventStack = [];\n    }\n\n    protected logEvent(eventType: PlayerEventTypes) {\n        if (this.playSession) {\n            this.playSession.eventStack.push({\n                ...this.playerProperties,\n                eventType,\n                timeStamp: this.getTimeStamp(),\n            });\n        }\n    }\n\n    protected reset() {\n        this.playSession = null;\n\n        this.playerProperties = {\n            state: PlayingState.idle,\n            error: null,\n            mediaDuration: 0,\n            playPosition: 0,\n            audioTrack: null,\n            textTrack: null,\n            resolution: null,\n        };\n    }\n\n    protected getTimeStamp() {\n        return Date.now() - (this.playSession ? this.playSession.localTimeDelta : 0);\n    }\n}\n","export function createHotKeysFunction(videojesInstance: any, options: {backward: number; forward: number}) {\n    const PlayToggle = videojesInstance.getComponent('PlayToggle');\n\n    function skip(component: any, skipTime: number) {\n        const currentVideoTime = component.currentTime();\n        const liveTracker = component.liveTracker;\n        const duration = liveTracker && liveTracker.isLive() ? liveTracker.seekableEnd() : component.duration();\n        let newTime = currentVideoTime + skipTime;\n        if (newTime > duration) {\n            newTime = duration;\n        } else if (newTime < 0) {\n            newTime = 0;\n        }\n        component.currentTime(newTime);\n    }\n\n    return function (event: KeyboardEvent) {\n        switch (event.key) {\n            case ' ':\n                PlayToggle.prototype.handleClick.call(this, event);\n                break;\n            case 'ArrowLeft':\n                skip(this, options.backward);\n                break;\n            case 'ArrowRight':\n                skip(this, options.forward);\n                break;\n        }\n    };\n}\n","// https://raw.githubusercontent.com/vtex/country-iso-3-to-2/master/index.js\nexport function getISO2Locale(countryCode: string) {\n    const countryISOMapping: any = {\n        AFG: 'AF',\n        ALA: 'AX',\n        ALB: 'AL',\n        DZA: 'DZ',\n        ASM: 'AS',\n        AND: 'AD',\n        AGO: 'AO',\n        AIA: 'AI',\n        ATA: 'AQ',\n        ATG: 'AG',\n        ARG: 'AR',\n        ARM: 'AM',\n        ABW: 'AW',\n        AUS: 'AU',\n        AUT: 'AT',\n        AZE: 'AZ',\n        BHS: 'BS',\n        BHR: 'BH',\n        BGD: 'BD',\n        BRB: 'BB',\n        BLR: 'BY',\n        BEL: 'BE',\n        BLZ: 'BZ',\n        BEN: 'BJ',\n        BMU: 'BM',\n        BTN: 'BT',\n        BOL: 'BO',\n        BES: 'BQ',\n        BIH: 'BA',\n        BWA: 'BW',\n        BVT: 'BV',\n        BRA: 'BR',\n        VGB: 'VG',\n        IOT: 'IO',\n        BRN: 'BN',\n        BGR: 'BG',\n        BFA: 'BF',\n        BDI: 'BI',\n        KHM: 'KH',\n        CMR: 'CM',\n        CAN: 'CA',\n        CPV: 'CV',\n        CYM: 'KY',\n        CAF: 'CF',\n        TCD: 'TD',\n        CHL: 'CL',\n        CHN: 'CN',\n        HKG: 'HK',\n        MAC: 'MO',\n        CXR: 'CX',\n        CCK: 'CC',\n        COL: 'CO',\n        COM: 'KM',\n        COG: 'CG',\n        COD: 'CD',\n        COK: 'CK',\n        CRI: 'CR',\n        CIV: 'CI',\n        HRV: 'HR',\n        CUB: 'CU',\n        CUW: 'CW',\n        CYP: 'CY',\n        CZE: 'CZ',\n        DNK: 'DK',\n        DJI: 'DJ',\n        DMA: 'DM',\n        DOM: 'DO',\n        ECU: 'EC',\n        EGY: 'EG',\n        SLV: 'SV',\n        GNQ: 'GQ',\n        ERI: 'ER',\n        EST: 'EE',\n        ETH: 'ET',\n        FLK: 'FK',\n        FRO: 'FO',\n        FJI: 'FJ',\n        FIN: 'FI',\n        FRA: 'FR',\n        GUF: 'GF',\n        PYF: 'PF',\n        ATF: 'TF',\n        GAB: 'GA',\n        GMB: 'GM',\n        GEO: 'GE',\n        DEU: 'DE',\n        GHA: 'GH',\n        GIB: 'GI',\n        GRC: 'GR',\n        GRL: 'GL',\n        GRD: 'GD',\n        GLP: 'GP',\n        GUM: 'GU',\n        GTM: 'GT',\n        GGY: 'GG',\n        GIN: 'GN',\n        GNB: 'GW',\n        GUY: 'GY',\n        HTI: 'HT',\n        HMD: 'HM',\n        VAT: 'VA',\n        HND: 'HN',\n        HUN: 'HU',\n        ISL: 'IS',\n        IND: 'IN',\n        IDN: 'ID',\n        IRN: 'IR',\n        IRQ: 'IQ',\n        IRL: 'IE',\n        IMN: 'IM',\n        ISR: 'IL',\n        ITA: 'IT',\n        JAM: 'JM',\n        JPN: 'JP',\n        JEY: 'JE',\n        JOR: 'JO',\n        KAZ: 'KZ',\n        KEN: 'KE',\n        KIR: 'KI',\n        PRK: 'KP',\n        KOR: 'KR',\n        KWT: 'KW',\n        KGZ: 'KG',\n        LAO: 'LA',\n        LVA: 'LV',\n        LBN: 'LB',\n        LSO: 'LS',\n        LBR: 'LR',\n        LBY: 'LY',\n        LIE: 'LI',\n        LTU: 'LT',\n        LUX: 'LU',\n        MKD: 'MK',\n        MDG: 'MG',\n        MWI: 'MW',\n        MYS: 'MY',\n        MDV: 'MV',\n        MLI: 'ML',\n        MLT: 'MT',\n        MHL: 'MH',\n        MTQ: 'MQ',\n        MRT: 'MR',\n        MUS: 'MU',\n        MYT: 'YT',\n        MEX: 'MX',\n        FSM: 'FM',\n        MDA: 'MD',\n        MCO: 'MC',\n        MNG: 'MN',\n        MNE: 'ME',\n        MSR: 'MS',\n        MAR: 'MA',\n        MOZ: 'MZ',\n        MMR: 'MM',\n        NAM: 'NA',\n        NRU: 'NR',\n        NPL: 'NP',\n        NLD: 'NL',\n        ANT: 'AN',\n        NCL: 'NC',\n        NZL: 'NZ',\n        NIC: 'NI',\n        NER: 'NE',\n        NGA: 'NG',\n        NIU: 'NU',\n        NFK: 'NF',\n        MNP: 'MP',\n        NOR: 'NO',\n        OMN: 'OM',\n        PAK: 'PK',\n        PLW: 'PW',\n        PSE: 'PS',\n        PAN: 'PA',\n        PNG: 'PG',\n        PRY: 'PY',\n        PER: 'PE',\n        PHL: 'PH',\n        PCN: 'PN',\n        POL: 'PL',\n        PRT: 'PT',\n        PRI: 'PR',\n        QAT: 'QA',\n        REU: 'RE',\n        ROU: 'RO',\n        RUS: 'RU',\n        RWA: 'RW',\n        BLM: 'BL',\n        SHN: 'SH',\n        KNA: 'KN',\n        LCA: 'LC',\n        MAF: 'MF',\n        SPM: 'PM',\n        VCT: 'VC',\n        WSM: 'WS',\n        SMR: 'SM',\n        STP: 'ST',\n        SAU: 'SA',\n        SEN: 'SN',\n        SRB: 'RS',\n        SYC: 'SC',\n        SLE: 'SL',\n        SGP: 'SG',\n        SXM: 'SX',\n        SVK: 'SK',\n        SVN: 'SI',\n        SLB: 'SB',\n        SOM: 'SO',\n        ZAF: 'ZA',\n        SGS: 'GS',\n        SSD: 'SS',\n        ESP: 'ES',\n        LKA: 'LK',\n        SDN: 'SD',\n        SUR: 'SR',\n        SJM: 'SJ',\n        SWZ: 'SZ',\n        SWE: 'SE',\n        CHE: 'CH',\n        SYR: 'SY',\n        TWN: 'TW',\n        TJK: 'TJ',\n        TZA: 'TZ',\n        THA: 'TH',\n        TLS: 'TL',\n        TGO: 'TG',\n        TKL: 'TK',\n        TON: 'TO',\n        TTO: 'TT',\n        TUN: 'TN',\n        TUR: 'TR',\n        TKM: 'TM',\n        TCA: 'TC',\n        TUV: 'TV',\n        UGA: 'UG',\n        UKR: 'UA',\n        ARE: 'AE',\n        GBR: 'GB',\n        USA: 'US',\n        UMI: 'UM',\n        URY: 'UY',\n        UZB: 'UZ',\n        VUT: 'VU',\n        VEN: 'VE',\n        VNM: 'VN',\n        VIR: 'VI',\n        WLF: 'WF',\n        ESH: 'EH',\n        YEM: 'YE',\n        ZMB: 'ZM',\n        ZWE: 'ZW',\n        XKX: 'XK',\n    };\n\n    if (countryCode && countryCode.length === 3) {\n        countryCode = countryCode.toUpperCase();\n\n        if (countryISOMapping[countryCode]) {\n            return countryISOMapping[countryCode].toLowerCase();\n        }\n        return countryCode.substr(0, 2).toLowerCase();\n    }\n    return ('' + countryCode).toLowerCase();\n}\n\nexport function getNativeLanguage(lang: string) {\n    const locale = lang && lang.length === 3 ? getISO2Locale(lang) : lang;\n\n    const isoLocales: any = {\n        ab: '',\n        aa: 'Afaraf',\n        af: 'Afrikaans',\n        ak: 'Akan',\n        sq: 'Shqip',\n        am: '',\n        ar: '',\n        an: 'Aragons',\n        hy: '',\n        as: '',\n        av: ' ,  ',\n        ae: 'avesta',\n        ay: 'aymar aru',\n        az: 'azrbaycan dili',\n        bm: 'bamanankan',\n        ba: ' ',\n        eu: 'euskara, euskera',\n        be: '',\n        bn: '',\n        bh: '',\n        bi: 'Bislama',\n        bs: 'bosanski jezik',\n        br: 'brezhoneg',\n        bg: ' ',\n        my: '',\n        ca: 'Catal',\n        ch: 'Chamoru',\n        ce: ' ',\n        ny: 'chiChea, chinyanja',\n        zh: ' (Zhngwn), , ',\n        cv: ' ',\n        kw: 'Kernewek',\n        co: 'corsu, lingua corsa',\n        cr: '',\n        hr: 'hrvatski',\n        cs: 'etina',\n        da: 'dansk',\n        dv: '',\n        nl: 'Nederlands',\n        en: 'English',\n        eo: 'Esperanto',\n        et: 'eesti',\n        ee: 'Eegbe',\n        fo: 'froyskt',\n        fj: 'vosa Vakaviti',\n        fi: 'suomi',\n        fr: 'franais',\n        ff: 'Fulfulde, Pulaar, Pular',\n        gl: 'Galego',\n        ka: '',\n        de: 'Deutsch',\n        el: '',\n        gn: 'Avae',\n        gu: '',\n        ht: 'Kreyl ayisyen',\n        ha: 'Hausa, ',\n        he: '',\n        hz: 'Otjiherero',\n        hi: ', ',\n        ho: 'Hiri Motu',\n        hu: 'Magyar',\n        ia: 'Interlingua',\n        id: 'Bahasa Indonesia',\n        ie: 'Interlingue',\n        ga: 'Gaeilge',\n        ig: 'Ass Igbo',\n        ik: 'Iupiaq',\n        io: 'Ido',\n        is: 'slenska',\n        it: 'Italiano',\n        iu: '',\n        ja: '',\n        jv: 'basa Jawa',\n        kl: 'kalaallisut, kalaallit oqaasii',\n        kn: '',\n        kr: 'Kanuri',\n        ks: ', ',\n        kk: ' ',\n        km: '',\n        ki: 'Gky',\n        rw: 'Ikinyarwanda',\n        ky: ' ',\n        kv: ' ',\n        kg: 'KiKongo',\n        ko: ' (),  ()',\n        ku: '',\n        kj: 'Kuanyama',\n        la: 'latine',\n        lb: 'Ltzebuergesch',\n        lg: 'Luganda',\n        li: 'Limburgs',\n        ln: 'Lingla',\n        lo: '',\n        lt: 'lietuvi kalba',\n        lu: 'Luba-Katanga',\n        lv: 'latvieu valoda',\n        gv: 'Gaelg, Gailck',\n        mk: ' ',\n        mg: 'Malagasy fiteny',\n        ms: 'bahasa Melayu,  ',\n        ml: '',\n        mt: 'Malti',\n        mi: 'te reo Mori',\n        mr: '',\n        mh: 'Kajin Maje',\n        mn: '',\n        na: 'Ekakair Naoero',\n        nv: 'Din bizaad, Dinkeh',\n        nb: 'Norsk bokml',\n        nd: 'isiNdebele',\n        ne: '',\n        ng: 'Owambo',\n        nn: 'Norsk nynorsk',\n        no: 'Norsk',\n        ii: ' Nuosuhxop',\n        nr: 'isiNdebele',\n        oc: 'Occitan',\n        oj: '',\n        cu: ' ',\n        om: 'Afaan Oromoo',\n        or: '',\n        os: ' ',\n        pa: ', ',\n        pi: '',\n        fa: '',\n        pl: 'polski',\n        ps: '',\n        pt: 'Portugus',\n        qu: 'Runa Simi, Kichwa',\n        rm: 'rumantsch grischun',\n        rn: 'kiRundi',\n        ro: 'romn',\n        ru: '',\n        sa: '',\n        sc: 'sardu',\n        sd: ',  ',\n        se: 'Davvismegiella',\n        sm: 'gagana faa Samoa',\n        sg: 'yng t sng',\n        sr: ' ',\n        gd: 'Gidhlig',\n        sn: 'chiShona',\n        si: '',\n        sk: 'slovenina',\n        sl: 'slovenina',\n        so: 'Soomaaliga, af Soomaali',\n        st: 'Sesotho',\n        es: 'espaol',\n        su: 'Basa Sunda',\n        sw: 'Kiswahili',\n        ss: 'SiSwati',\n        sv: 'svenska',\n        ta: '',\n        te: '',\n        tg: '',\n        th: '',\n        ti: '',\n        bo: '',\n        tk: 'Trkmen',\n        tl: 'Wikang Tagalog',\n        tn: 'Setswana',\n        to: 'faka Tonga',\n        tr: 'Trke',\n        ts: 'Xitsonga',\n        tt: '',\n        tw: 'Twi',\n        ty: 'Reo Tahiti',\n        ug: '',\n        uk: '',\n        ur: '',\n        uz: 'zbek, , ',\n        ve: 'Tshivena',\n        vi: 'Ting Vit',\n        vo: 'Volapk',\n        wa: 'Walon',\n        cy: 'Cymraeg',\n        wo: 'Wollof',\n        fy: 'Frysk',\n        xh: 'isiXhosa',\n        yi: '',\n        yo: 'Yorb',\n        za: 'Sa cue, Saw cuengh',\n        mis: 'uncoded languages',\n        mul: 'multiple languages',\n        und: 'undetermined',\n        zxx: 'no linguistic content/not applicable',\n    };\n\n    if (locale && isoLocales[locale]) {\n        return isoLocales[locale];\n    }\n    return locale;\n}\n","export function graphRequest(apiFetchUrl: string, query: string, variables: any, token: string) {\n    const authHeader = token ? {Authorization: 'Bearer ' + token} : {};\n\n    return fetch(apiFetchUrl, {\n        method: 'POST',\n        headers: {\n            'Content-Type': 'application/json',\n            Accept: 'application/json',\n            ...authHeader,\n        },\n        body: JSON.stringify({\n            query,\n            variables,\n        }),\n    }).then(response => response.json());\n}\n","import {PlayConfig, PlayEntitlement, ArticlePlayErrors, MimeType, MimeTypeHls, MimeTypeDash, MimeTypeMp4} from '../models/play-config';\nimport {Article} from '../models/article';\nimport {FileData} from '../models/file-data';\nimport {PlayParams} from '../models/play-params';\n\nexport function toPlayConfig(config: any, playParams: PlayParams, supportsDRM = true): PlayConfig {\n    const timeStamp = Date.parse(config.issued_at);\n    const entitlements: PlayEntitlement[] = [];\n\n    // check if the entitlements contain FPS in order to know when to filter out aes\n    const filterAES = supportsDRM && !!config.entitlements.find((entitlement: any) => entitlement.encryption_type === 'fps');\n    const configEntitlements = filterAES\n        ? config.entitlements.filter((entitlement: any) => {\n              return entitlement.encryption_type !== 'aes';\n          })\n        : config.entitlements;\n\n    configEntitlements.forEach((entitlement: any) => {\n        const entitlementConfig: PlayEntitlement = {\n            src: entitlement.manifest,\n            type: toMimeType(entitlement.mime_type),\n            isLive: entitlement.is_live,\n            protectionInfo: null,\n            mediaProvider: entitlement.media_provider,\n        };\n\n        if (entitlement.encryption_type) {\n            if (entitlement.encryption_type === 'cenc' && entitlement.protocol.indexOf('dash') === 0) {\n                if (!supportsDRM) {\n                    return;\n                }\n                entitlementConfig.protectionInfo = [\n                    {\n                        type: 'Widevine',\n                        authenticationToken:\n                            entitlement.encryption_provider === 'azl' && !!entitlement.token ? 'Bearer ' + entitlement.token : '',\n                        keyDeliveryUrl: entitlement.key_delivery_url,\n                        encryptionProvider: entitlement.encryption_provider,\n                    },\n                ];\n            } else if (entitlement.encryption_type === 'fps' && entitlement.protocol.indexOf('hls') === 0) {\n                if (!supportsDRM) {\n                    return;\n                }\n                entitlementConfig.protectionInfo = [\n                    {\n                        type: 'FairPlay',\n                        authenticationToken:\n                            entitlement.encryption_provider === 'azl' && !!entitlement.token ? 'Bearer ' + entitlement.token : '',\n                        certificateUrl: config.fairplay_certificate_url,\n                        keyDeliveryUrl: entitlement.key_delivery_url,\n                        encryptionProvider: entitlement.encryption_provider,\n                        contentKeyId:\n                            entitlement.encryption_provider === 'azl'\n                                ? entitlement.key_delivery_url.replace('https://', 'skd://')\n                                : entitlement.hls_key_uri,\n                    },\n                ];\n            }\n        }\n        entitlements.push(entitlementConfig);\n    });\n\n    const subtitles = config.subtitles.map((item: any) => ({\n        src: item.url,\n        srclang: item.locale,\n        kind: 'subtitles',\n        label: item.locale_label,\n    }));\n\n    const currentTime = playParams.continueFromPreviousPosition && config.appa < config.time_marker_end ? config.appa : 0;\n    const skipIntro =\n        config.time_marker_intro_end > 0 && config.time_marker_intro_end > config.time_marker_intro_start\n            ? {\n                  skipIntro: {\n                      start: config.time_marker_intro_start,\n                      end: config.time_marker_intro_end,\n                  },\n              }\n            : {};\n\n    return {\n        entitlements: entitlements,\n        subtitles: subtitles,\n        pulseToken: config.pulse_token,\n        currentTime: currentTime,\n        continuePaused: playParams.continuePaused,\n        articleId: config.article_id,\n        assetId: config.asset_id,\n        subtitleLocale: config.user_subtitle_locale,\n        audioLocale: config.user_audio_locale,\n        localTimeDelta: isNaN(timeStamp) ? 0 : Date.now() - timeStamp,\n        aspectRatio: config.aspect_ratio.replace('x', ':'),\n        ...skipIntro,\n    };\n}\n\nexport function toArticleMetas(metas: any) {\n    return metas.reduce(\n        (metaObj: any, item: any) => ({\n            ...metaObj,\n            [item.key]: item.value,\n        }),\n        {}\n    );\n}\n\nexport function toArticle(article: any): Article {\n    return {\n        name: article.name,\n        metas: toArticleMetas(article.metas),\n        posters: article.posters.map(toFile),\n        images: article.images.map(toFile),\n    } as Article;\n}\n\nexport function toFile(file: any): FileData {\n    return {\n        type: file.type,\n        url: file.url,\n        baseUrl: file.base_url,\n        fileName: file.file_name,\n    } as FileData;\n}\n\nexport function getMetaValue(metas: any, key: string) {\n    return metas[key] ? metas[key] : '';\n}\n\nexport function getResizedUrl(fileData: FileData, size: {width: number; height: number}): string {\n    if (fileData) {\n        const {width, height} = size;\n        return `${fileData.baseUrl}/${width}x${height}/${fileData.fileName}`;\n    }\n    return '';\n}\n\nexport function getArticleTitle(article: Article) {\n    return getMetaValue(article.metas, 'title') || article.name;\n}\n\nexport function getArticleBackgroundImage(article: Article): FileData {\n    if (article.posters.length > 0) {\n        return article.posters[0];\n    }\n    if (this.article.length > 0) {\n        return article.images[0];\n    }\n    return null;\n}\n\nexport function toPlayConfigError(code: number): ArticlePlayErrors {\n    switch (code) {\n        case 0:\n            return ArticlePlayErrors.offlineError;\n        case 401:\n            return ArticlePlayErrors.notAuthenticated;\n        case 402:\n            return ArticlePlayErrors.needEntitlement;\n        case 403:\n            return ArticlePlayErrors.notAuthenticated;\n        case 404:\n            return ArticlePlayErrors.noPlayableAsset;\n        case 429:\n            return ArticlePlayErrors.maxConcurrentStreamNumberError;\n\n        default:\n            return ArticlePlayErrors.serverError;\n    }\n}\n\nexport function toMimeType(mimeType: string): MimeType {\n    switch (mimeType) {\n        case MimeTypeHls:\n        case MimeTypeDash:\n        case MimeTypeMp4:\n            return mimeType;\n        case 'application/vnd.apple.mpegurl': // convert legacy HLS mime-type\n            return MimeTypeHls;\n        default:\n            console.warn(`Unknown mime-type ${mimeType}, defaulting to mp4`);\n            return MimeTypeMp4;\n    }\n}\n","import {graphRequest} from './graph-request';\nimport {articleAssetPlayMutation, articleQuery} from './queries';\nimport {toArticle, toPlayConfig} from './converters';\nimport {DeviceModelContextEnum, PlayParams} from '../models/play-params';\n\nexport class ApiService {\n    private apiFetchUrl: string;\n    private token: string;\n\n    constructor(baseUrl: string, projectId: number) {\n        this.apiFetchUrl = `${baseUrl}/graphql/${projectId}/user`;\n        this.token = null;\n    }\n\n    setToken(token: string) {\n        this.token = token;\n    }\n\n    getArticle(articleId: number) {\n        return graphRequest(this.apiFetchUrl, articleQuery, {articleId}, this.token).then((response: any) => {\n            if (!response || !response.data || response.errors) {\n                const {message, code} = response.errors[0];\n                throw {message, code};\n            }\n            return toArticle(response.data.Article);\n        });\n    }\n\n    getArticleAssetPlayConfig(playParams: PlayParams, deviceModelContext: DeviceModelContextEnum = null, supportsDRM = true) {\n        return graphRequest(\n            this.apiFetchUrl,\n            articleAssetPlayMutation,\n            {\n                articleId: playParams.articleId,\n                assetId: playParams.assetId,\n                protocols: ['dash', 'hls'],\n                device_model_context: deviceModelContext,\n            },\n            this.token\n        ).then((response: any) => {\n            if (!response || !response.data || response.errors) {\n                const {message, code} = response.errors[0];\n                throw {message, code};\n            }\n\n            return toPlayConfig(response.data.ArticleAssetPlay, playParams, supportsDRM);\n        });\n    }\n}\n","export const articleAssetPlayMutation = `\n    mutation ArticleAssetPlay($articleId: Int, $assetId: Int, $protocols: [ArticlePlayProtocolEnum]) {\n        ArticleAssetPlay(article_id: $articleId, asset_id: $assetId, protocols: $protocols) {\n            article_id\n            asset_id\n            entitlements {\n                mime_type\n                protocol\n                manifest\n                is_live\n                token\n                encryption_type\n                key_delivery_url\n                encryption_provider\n                hls_key_uri\n                media_provider\n            }\n            subtitles {\n                url\n                locale\n                locale_label\n            }\n            pulse_token\n            appa\n            appr\n            fairplay_certificate_url\n            user_subtitle_locale\n            user_audio_locale\n            aspect_ratio\n            issued_at\n            time_marker_end\n            time_marker_intro_start\n            time_marker_intro_end\n        }\n    }\n`;\n\nexport const articleQuery = `\n    query Article($articleId: Int!) {\n        Article(id: $articleId) {\n            id\n            name\n            metas {\n                key\n                value\n            }\n            assets {\n                id\n                duration\n                linked_type\n                accessibility\n            }\n            posters {\n                type\n                url\n                title\n                base_url\n                file_name\n            }\n            images {\n                type\n                url\n                title\n                base_url\n                file_name\n            }\n        }\n    }\n`;\n","import {PlayConfig} from '../models/play-config';\nimport {Article} from '../models/article';\nimport {getArticleTitle} from '../api/converters';\nimport {PlayParams} from '../models/play-params';\nimport {ChromecastConnectionInfo, ChromecastPlayInfo, TrackInfo} from '../models/cast-info';\n\nexport class ChromecastSender {\n    private static initPromise: Promise<void> = null;\n    private castContext: cast.framework.CastContext = null;\n    private castPlayer: cast.framework.RemotePlayer = null;\n    private castPlayerController: cast.framework.RemotePlayerController = null;\n    private lastConnectionInfo: ChromecastConnectionInfo = null;\n    private lastPlayStateInfo: {state: chrome.cast.media.PlayerState; info: ChromecastPlayInfo} = null;\n    private updateInterval: any = null;\n    private supportsHDR = false;\n    private playConfig: PlayConfig = null;\n    private onConnectedListeners: Array<(info: ChromecastConnectionInfo) => void> = [];\n    private onPlayStateListeners: Array<(state: chrome.cast.media.PlayerState, info: ChromecastPlayInfo) => void> = [];\n    private onCurrentTimeListeners: Array<(currentTime: number) => void> = [];\n    private onMediaTracksListeners: Array<(audioTracks: TrackInfo[], textTracks: TrackInfo[]) => void> = [];\n    private onDurationListeners: Array<(duration: number) => void> = [];\n    private onApiErrorListeners: Array<(error: {code: number; message: string}, playParams: PlayParams) => void> = [];\n\n    constructor(private chromecastReceiverAppId: string) {\n        if (ChromecastSender.initPromise) {\n            throw Error('ChromecastSender already initialized');\n        }\n        ChromecastSender.initPromise = new Promise<void>((resolve, reject) => {\n            if (this.chromecastReceiverAppId) {\n                window['__onGCastApiAvailable'] = (isAvailable: boolean) => {\n                    if (isAvailable && cast && cast.framework && chrome && chrome.cast) {\n                        try {\n                            this.initializeCastApi(this.chromecastReceiverAppId);\n                            this.dispatchConnectionInfo({available: true, connected: false, friendlyName: ''});\n                            resolve();\n                        } catch (e) {\n                            this.dispatchConnectionInfo({available: false, connected: false, friendlyName: ''});\n                            reject(e);\n                        }\n                    } else {\n                        this.dispatchConnectionInfo({available: false, connected: false, friendlyName: ''});\n                        reject('Chromecast not available');\n                    }\n                };\n\n                const scriptElement = document.createElement('script');\n                scriptElement.async = true;\n                scriptElement.src = 'https://www.gstatic.com/cv/js/sender/v1/cast_sender.js?loadCastFramework=1';\n                document.head.appendChild(scriptElement);\n            } else {\n                this.dispatchConnectionInfo({available: false, connected: false, friendlyName: ''});\n                reject('Chromecast Receiver Application Id is missing');\n            }\n        });\n    }\n\n    init() {\n        return ChromecastSender.initPromise;\n    }\n\n    initializeCastApi(chromecastReceiverAppId: string) {\n        cast.framework.CastContext.getInstance().setOptions({\n            receiverApplicationId: chromecastReceiverAppId,\n            autoJoinPolicy: chrome.cast.AutoJoinPolicy.TAB_AND_ORIGIN_SCOPED, // to rejoin when reloading the page on the same tab\n        });\n        this.castContext = cast.framework.CastContext.getInstance();\n        this.castPlayer = new cast.framework.RemotePlayer();\n        this.castPlayerController = new cast.framework.RemotePlayerController(this.castPlayer);\n\n        this.castPlayerController.addEventListener(cast.framework.RemotePlayerEventType.IS_CONNECTED_CHANGED, event => {\n            if (this.castPlayer.isConnected) {\n                const castSession = this.getCastSession();\n                if (castSession) {\n                    castSession.addMessageListener('urn:x-cast:com.audienceplayer.messagebus', (namespace, message) => {\n                        const messageObject = JSON.parse(message);\n                        if (typeof messageObject.is_hdr_supported === 'boolean') {\n                            this.supportsHDR = messageObject && messageObject.is_hdr_supported;\n                        } else if (typeof messageObject.error === 'object' && messageObject.error.code) {\n                            const error = {code: messageObject.error.code, message: messageObject.error.message};\n                            this.onApiErrorListeners.forEach(listener => {\n                                listener(error, messageObject.playParams);\n                            });\n                        } else if (typeof messageObject.playConfig === 'object') {\n                            this.playConfig = messageObject.playConfig;\n                        }\n                    });\n                }\n            } else {\n                this.supportsHDR = false;\n            }\n        });\n\n        this.castPlayerController.addEventListener(cast.framework.RemotePlayerEventType.IS_CONNECTED_CHANGED, event => {\n            if (this.castPlayer.isConnected) {\n                const castSession = this.getCastSession();\n                if (castSession) {\n                    const device = castSession.getCastDevice();\n                    if (device) {\n                        this.dispatchConnectionInfo({\n                            available: true,\n                            connected: true,\n                            friendlyName: device.friendlyName || 'Chromecast',\n                        });\n                        return;\n                    }\n                }\n            }\n            if (!this.castPlayer.isConnected && this.lastPlayStateInfo !== null) {\n                this.lastPlayStateInfo = null;\n                this.dispatchPlayState(null, null);\n            }\n            this.dispatchConnectionInfo({available: true, connected: false, friendlyName: ''});\n        });\n\n        this.castPlayerController.addEventListener(cast.framework.RemotePlayerEventType.PLAYER_STATE_CHANGED, () => {\n            const state = this.castPlayer.playerState;\n            let info: any = null;\n\n            // only when media is loaded, otherwise IDLE state will cause issues\n            if (this.castPlayer.isMediaLoaded) {\n                if (this.castPlayer.mediaInfo && state !== null && state !== chrome.cast.media.PlayerState.IDLE) {\n                    const customData: any = this.castPlayer.mediaInfo.customData;\n                    if (customData) {\n                        // @TODO extraInfo will be deprecated\n                        if (customData.extraInfo) {\n                            const parsedInfo = JSON.parse(customData.extraInfo);\n                            if (parsedInfo.articleId && parsedInfo.assetId) {\n                                info = {articleId: parsedInfo.articleId, assetId: parsedInfo.assetId};\n                                if (customData.token) {\n                                    info.token = customData.token;\n                                }\n                            }\n                        } else if (customData.articleId && customData.assetId) {\n                            info = {articleId: customData.articleId, assetId: customData.assetId, token: customData.token};\n                        }\n                    }\n                }\n                this.dispatchPlayState(state, info);\n            }\n        });\n\n        this.castPlayerController.addEventListener(cast.framework.RemotePlayerEventType.DURATION_CHANGED, () => {\n            if (this.castPlayer.isMediaLoaded) {\n                this.onDurationListeners.forEach(listener => listener(this.castPlayer.duration));\n            }\n        });\n\n        this.castPlayerController.addEventListener(cast.framework.RemotePlayerEventType.MEDIA_INFO_CHANGED, () => {\n            if (this.castPlayer.isMediaLoaded && this.castPlayer.mediaInfo) {\n                const mediaSession = this.getCastMediaSession();\n                let audioTracks: TrackInfo[] = [];\n                let textTracks: TrackInfo[] = [];\n\n                if (this.castPlayer.mediaInfo.tracks && mediaSession) {\n                    audioTracks = this.getTracksByType('AUDIO');\n                    textTracks = this.getTracksByType('TEXT');\n                    this.onMediaTracksListeners.forEach(listener => listener(audioTracks, textTracks));\n                }\n            }\n        });\n    }\n\n    addOnConnectedListener(callback: (info: ChromecastConnectionInfo) => void) {\n        this.onConnectedListeners.push(callback);\n\n        if (this.lastConnectionInfo) {\n            this.dispatchConnectionInfo(this.lastConnectionInfo);\n        }\n    }\n\n    removeOnConnectedListener(callback: (info: ChromecastConnectionInfo) => void) {\n        const index = this.onConnectedListeners.indexOf(callback);\n        if (index >= 0) {\n            this.onConnectedListeners.splice(index, 1);\n        }\n    }\n\n    addOnPlayStateListener(callback: (state: chrome.cast.media.PlayerState, info: ChromecastPlayInfo) => void) {\n        this.onPlayStateListeners.push(callback);\n\n        if (this.lastPlayStateInfo !== null) {\n            this.dispatchPlayState(this.lastPlayStateInfo.state, this.lastPlayStateInfo.info);\n        }\n    }\n\n    removeOnPlayStateListener(callback: (state: chrome.cast.media.PlayerState, info: ChromecastPlayInfo) => void) {\n        const index = this.onPlayStateListeners.indexOf(callback);\n        if (index >= 0) {\n            this.onPlayStateListeners.splice(index, 1);\n        }\n    }\n\n    addOnCurrentTimeListener(callback: (currentTime: number) => void) {\n        if (this.onCurrentTimeListeners.length === 0) {\n            this.updateInterval = setInterval(() => {\n                const mediaSession = this.getCastMediaSession();\n                if (mediaSession) {\n                    this.onCurrentTimeListeners.forEach(listener => listener(mediaSession.getEstimatedTime()));\n                }\n            }, 500);\n        }\n        this.onCurrentTimeListeners.push(callback);\n    }\n\n    removeOnCurrentTimeListener(callback: (currentTime: number) => void) {\n        const index = this.onCurrentTimeListeners.indexOf(callback);\n        if (index >= 0) {\n            this.onCurrentTimeListeners.splice(index, 1);\n        }\n        if (this.onCurrentTimeListeners.length === 0) {\n            clearInterval(this.updateInterval);\n        }\n    }\n\n    addOnMediaTracksListener(callback: (audioTracks: TrackInfo[], textTracks: TrackInfo[]) => void) {\n        this.onMediaTracksListeners.push(callback);\n    }\n\n    removeOnMediaTracksListener(callback: (audioTracks: TrackInfo[], textTracks: TrackInfo[]) => void) {\n        const index = this.onMediaTracksListeners.indexOf(callback);\n        if (index >= 0) {\n            this.onMediaTracksListeners.splice(index, 1);\n        }\n    }\n\n    addOnDurationListener(callback: (duration: number) => void) {\n        this.onDurationListeners.push(callback);\n    }\n\n    removeOnDurationListener(callback: (duration: number) => void) {\n        const index = this.onDurationListeners.indexOf(callback);\n        if (index >= 0) {\n            this.onDurationListeners.splice(index, 1);\n        }\n    }\n\n    addOnApiErrorListener(callback: (error: {code: number; message: string}, playParams: PlayParams) => void) {\n        this.onApiErrorListeners.push(callback);\n    }\n\n    removeOnApiErrorListener(callback: (error: {code: number; message: string}, playParams: PlayParams) => void) {\n        const index = this.onApiErrorListeners.indexOf(callback);\n        if (index >= 0) {\n            this.onApiErrorListeners.splice(index, 1);\n        }\n    }\n\n    getSupportsHDR() {\n        return this.supportsHDR;\n    }\n\n    getPlayConfig() {\n        return this.playConfig;\n    }\n\n    getCastMediaInfo(articlePlayConfig: PlayConfig, article: Article) {\n        if (articlePlayConfig && articlePlayConfig.entitlements && articlePlayConfig.entitlements.length > 0) {\n            let contentType = null;\n            const supportedContentTypes = ['application/x-mpegURL', 'application/vnd.apple.mpegurl', 'video/mp4'];\n            const entitlement = articlePlayConfig.entitlements.find(item => {\n                if (supportedContentTypes.includes(item.type)) {\n                    contentType = item.type;\n                    return true;\n                } else {\n                    return false;\n                }\n            });\n\n            // the HLS manifest contains the tracks, but otherwise add them\n            const tracks: Array<chrome.cast.media.Track> =\n                contentType === 'application/vnd.apple.mpegurl'\n                    ? []\n                    : articlePlayConfig.subtitles.map((option, index) => {\n                          const trackId = index + 1;\n                          const castTrack = new chrome.cast.media.Track(trackId, chrome.cast.media.TrackType.TEXT);\n                          castTrack.trackContentId = option.src;\n                          castTrack.trackContentType = 'text/vtt';\n                          castTrack.subtype = chrome.cast.media.TextTrackType.SUBTITLES;\n                          castTrack.name = option.label;\n                          castTrack.language = option.srclang;\n                          castTrack.customData = null;\n                          return castTrack;\n                      });\n\n            if (entitlement) {\n                const mediaInfo = new chrome.cast.media.MediaInfo(entitlement.src, contentType);\n                mediaInfo.streamType = entitlement.isLive ? chrome.cast.media.StreamType.LIVE : chrome.cast.media.StreamType.BUFFERED;\n\n                this.addMediaInfoToMetaData(article, mediaInfo);\n\n                if (tracks.length > 0) {\n                    mediaInfo.tracks = tracks;\n                }\n\n                const audioLocaleParam = articlePlayConfig.audioLocale ? {preferredAudioLocale: articlePlayConfig.audioLocale} : {};\n                const textTrackParam = articlePlayConfig.subtitleLocale ? {preferredTextLocale: articlePlayConfig.subtitleLocale} : {};\n\n                mediaInfo.customData = {\n                    ...audioLocaleParam,\n                    ...textTrackParam,\n                    entitlements: articlePlayConfig.entitlements,\n                    pulseToken: articlePlayConfig.pulseToken,\n                    mediaProvider: entitlement.mediaProvider,\n                    articleId: articlePlayConfig.articleId,\n                    assetId: articlePlayConfig.assetId,\n                };\n\n                // @ts-ignore\n                mediaInfo.currentTime = articlePlayConfig.currentTime;\n\n                return mediaInfo;\n            }\n        }\n        return null;\n    }\n\n    getCastMediaInfoByParams(playParams: PlayParams) {\n        const mediaInfo = new chrome.cast.media.MediaInfo('contentIdPlaceHolder', 'application/vnd.cast-media');\n        // make sure the content id is unique, so the reciever will fire media info.\n        mediaInfo.contentId = 'asset-' + playParams.assetId + '-' + Math.random();\n\n        if (playParams.article) {\n            this.addMediaInfoToMetaData(playParams.article, mediaInfo);\n        }\n\n        // N.B. customData should not become too big to prevent a sender invalid_params error\n        mediaInfo.customData = {\n            articleId: playParams.articleId,\n            assetId: playParams.assetId,\n            token: playParams.token,\n            continueFromPreviousPosition: !!playParams.continueFromPreviousPosition,\n            continuePaused: !!playParams.continuePaused,\n        };\n\n        return mediaInfo;\n    }\n\n    getCastSession() {\n        if (this.castContext) {\n            return this.castContext.getCurrentSession();\n        }\n        return null;\n    }\n\n    getCastMediaSession() {\n        const castSession = this.getCastSession();\n        if (castSession) {\n            return castSession.getMediaSession();\n        }\n    }\n\n    castVideo(playConfig: PlayConfig, article: Article, continueFromPreviousPosition: boolean) {\n        if (this.isConnected()) {\n            const castSession = this.getCastSession();\n            const mediaInfo = this.getCastMediaInfo(playConfig, article);\n\n            if (mediaInfo) {\n                this.playConfig = null;\n                const request = new chrome.cast.media.LoadRequest(mediaInfo);\n                request.currentTime = continueFromPreviousPosition ? playConfig.currentTime : 0;\n                return castSession.loadMedia(request);\n            } else {\n                throw {message: 'Unexpected manifest format in articlePlayConfig ' + JSON.stringify(playConfig)};\n            }\n        }\n    }\n\n    castVideoByParams(playParams: PlayParams): Promise<void> {\n        return new Promise((resolve, reject) => {\n            if (this.isConnected()) {\n                const castSession = this.getCastSession();\n\n                const mediaInfo = this.getCastMediaInfoByParams(playParams);\n                if (mediaInfo) {\n                    this.playConfig = null;\n                    const request = new chrome.cast.media.LoadRequest(mediaInfo);\n                    castSession\n                        .loadMedia(request)\n                        .then(errorCode => {\n                            resolve();\n                        })\n                        .catch(ex => {\n                            reject(ex);\n                        });\n                } else {\n                    reject('Could not create media info request');\n                }\n            } else {\n                reject('castVideoByParams: Not connected!');\n            }\n        });\n    }\n\n    isConnected() {\n        return this.castPlayer && this.castPlayer.isConnected;\n    }\n\n    stopMedia(): Promise<void> {\n        return new Promise((resolve, reject) => {\n            if (this.castContext) {\n                const castSession = this.getCastSession();\n                if (castSession) {\n                    const mediaSession = castSession.getMediaSession();\n                    if (mediaSession) {\n                        mediaSession.stop(\n                            new chrome.cast.media.StopRequest(),\n                            () => {\n                                resolve();\n                            },\n                            () => {\n                                console.log('stopMedia: dit NOT stop media session');\n                                resolve();\n                            }\n                        );\n                        return;\n                    }\n                }\n            }\n            console.log('stopMedia: No session');\n            resolve();\n        });\n    }\n\n    endSession(stopCasting: boolean) {\n        if (this.castContext) {\n            const castSession = this.getCastSession();\n            if (castSession) {\n                castSession.endSession(stopCasting);\n            }\n        }\n    }\n\n    stopCasting() {\n        this.endSession(true);\n    }\n\n    getCastPlayer() {\n        return this.castPlayer;\n    }\n\n    getCastPlayerController() {\n        return this.castPlayerController;\n    }\n\n    addMediaInfoToMetaData(article: Article, mediaInfo: chrome.cast.media.MediaInfo) {\n        if (article) {\n            mediaInfo.metadata = new chrome.cast.media.GenericMediaMetadata();\n            mediaInfo.metadata.metadataType = chrome.cast.media.MetadataType.GENERIC;\n            mediaInfo.metadata.title = getArticleTitle(article);\n\n            const image = article.images && article.images.length ? article.images[0] : null;\n            // pick high available resolution\n            mediaInfo.metadata.images = image ? [new chrome.cast.Image(`${image.baseUrl}/1920x1080/${image.fileName}`)] : [];\n        }\n    }\n\n    getActiveTracksByType(type: string) {\n        return this.getTracksByType(type)\n            .filter(track => track.active)\n            .map(track => +track.id);\n    }\n\n    getTracksByType(type: string) {\n        const mediaSession = this.getCastMediaSession();\n        return this.castPlayer.mediaInfo.tracks\n            .filter(track => track.type === type && track.language)\n            .map(track => ({\n                id: track.trackId,\n                locale: track.language,\n                active: mediaSession && mediaSession.activeTrackIds && mediaSession.activeTrackIds.indexOf(track.trackId) !== -1,\n            }));\n    }\n\n    setActiveTracks(trackIds: number[], type: string) {\n        if (this.castPlayer && this.castPlayer.isConnected) {\n            const mediaSession = this.getCastMediaSession();\n            if (mediaSession) {\n                const tracksInfoRequest = new chrome.cast.media.EditTracksInfoRequest(trackIds);\n                mediaSession.editTracksInfo(\n                    tracksInfoRequest,\n                    () => {\n                        /* success */\n                    },\n                    (error: chrome.cast.Error) => console.error('ChromecastSender.setActiveTracks', trackIds, error)\n                );\n            } else {\n                console.error('setActiveTracks called but no media session');\n            }\n        }\n    }\n\n    setActiveTrackById(selectedTrackId: number, type: string) {\n        const newActiveTracks = this.getActiveTracksByType(type === 'AUDIO' ? 'TEXT' : 'AUDIO');\n        const activeTracksOfType = this.getActiveTracksByType(type);\n        const index = activeTracksOfType.indexOf(selectedTrackId);\n        if (type === 'AUDIO' || (type === 'TEXT' && index === -1)) {\n            newActiveTracks.push(selectedTrackId);\n        }\n        this.setActiveTracks(newActiveTracks, type);\n    }\n\n    private dispatchConnectionInfo(info: ChromecastConnectionInfo) {\n        this.lastConnectionInfo = info;\n        this.onConnectedListeners.forEach(listener => listener(info));\n    }\n\n    private dispatchPlayState(state: chrome.cast.media.PlayerState, info: ChromecastPlayInfo) {\n        this.lastPlayStateInfo = {state, info};\n        this.onPlayStateListeners.forEach(listener => listener(state, info));\n    }\n}\n","import {MimeTypeDash, MimeTypeHls, MimeTypeMp4, PlayConfig} from '../models/play-config';\nimport {supportsHLS, supportsNativeHLS} from '../utils/platform';\nimport {PlayerLoggerService} from '../logging/player-logger-service';\nimport {PlayerDeviceTypes} from '../models/player';\nimport {getEmeOptionsFromEntitlement} from '../utils/eme';\nimport {InitParams, PlayParams} from '../models/play-params';\nimport {createHotKeysFunction} from './hotkeys';\nimport {getISO2Locale} from '../utils/locale';\nimport {createSkipIntroPlugin} from './plugins/skip-intro';\nimport {createAudioTrackPlugin} from './plugins/audio-track-button';\nimport {createChromecastButtonPlugin} from './plugins/chromecast-button';\nimport {createCustomOverlaykPlugin} from './plugins/custom-overlay';\nimport {createOverlayPlugin} from './plugins/overlay';\nimport {createPlaybackRatePlugin} from './plugins/playback-rate-button';\nimport {createSubtitlesButtonPlugin} from './plugins/subtitles-button';\nimport {ApiService} from '../api/api-service';\nimport {createChromecastTechPlugin} from './plugins/chromecast-tech';\nimport {ChromecastSender} from '../chromecast/chromecast-sender';\nimport {ChromecastConnectionInfo, ChromecastPlayInfo} from '../models/cast-info';\n\nexport class VideoPlayer {\n    private player: any = null;\n    private apiService: ApiService = null;\n    private castSender: ChromecastSender = null;\n    private playerLoggerService: PlayerLoggerService;\n    private localPlayConfig: PlayConfig; // this contains the play config for a local playout, with CC it's a remote playout, and null.\n    private firstPlayingEvent: boolean;\n    private currentTextTrack: string;\n    private currentAudioTrack: string;\n    private metadataLoaded: boolean;\n    private currentTime: number;\n    private initParams: InitParams;\n    private stopped = false; // to make sure that if stop() was called, no async playout methods can continue play\n    private continueTimeout: any = null; // a timeout before continuing a play session when switching to or from chromecast\n\n    constructor(\n        private videojsInstance: any,\n        baseUrl: string = null,\n        projectId: number = 0,\n        chromecastReceiverAppId: string = null\n    ) {\n        if (baseUrl && typeof baseUrl === 'string' && projectId > 0) {\n            this.apiService = new ApiService(baseUrl.replace(/\\/*$/, ''), projectId);\n        }\n        this.playerLoggerService = new PlayerLoggerService(baseUrl, projectId);\n\n        createAudioTrackPlugin(videojsInstance);\n        createChromecastButtonPlugin(videojsInstance);\n        createCustomOverlaykPlugin(videojsInstance);\n        createOverlayPlugin(videojsInstance);\n        createPlaybackRatePlugin(videojsInstance);\n        createSkipIntroPlugin(videojsInstance);\n        createSubtitlesButtonPlugin(videojsInstance);\n\n        // if HLS is supported, it's either Safari or iOS, which to not support Chromecast\n        if (chromecastReceiverAppId && !supportsHLS(videojsInstance)) {\n            this.castSender = new ChromecastSender(chromecastReceiverAppId);\n            createChromecastTechPlugin(videojsInstance, this.castSender);\n        }\n    }\n\n    init(initParams: InitParams) {\n        this.destroy();\n\n        this.stopped = false;\n        this.localPlayConfig = null;\n        this.initParams = initParams;\n        const videoContainer = initParams.selector instanceof Element ? initParams.selector : document.querySelector(initParams.selector);\n\n        if (!videoContainer) {\n            throw Error('Invalid selector or element for player');\n        }\n\n        this.playerLoggerService.init();\n\n        const videoElement = document.createElement('video');\n        videoElement.setAttribute(\n            'class',\n            ['video-js', initParams.defaultSkinClass ? initParams.defaultSkinClass : 'vjs-default-skin'].join(' ')\n        );\n        videoElement.setAttribute('tabIndex', '0');\n        videoElement.setAttribute('width', '100%');\n        videoElement.setAttribute('height', '100%');\n        // this will hide the internal video element chromecast button. We want to keep Airplay, so only if native HLS is not supported\n        videoElement.disableRemotePlayback = !supportsNativeHLS(this.videojsInstance);\n\n        videoContainer.appendChild(videoElement);\n\n        const techOrder = this.castSender ? ['chromecast', 'html5'] : ['html5']; // chromecast first, to make it the `active tech`.\n\n        const playOptions = {\n            fluid: false,\n            fill: true,\n            responsive: true,\n            techOrder,\n            controls: true,\n            controlBar: {\n                pictureInPictureToggle: false,\n                skipButtons: initParams.skipButtons || false,\n                currentTimeDisplay: true,\n                durationDisplay: true,\n                timeDivider: false,\n                volumePanel: {\n                    inline: false,\n                },\n                chromecastButton: !!initParams.chromecastButton,\n                // order of elements:\n                children: [\n                    'skipBackward',\n                    'playToggle',\n                    'skipForward',\n                    'currentTimeDisplay',\n                    'progressControl',\n                    'durationDisplay',\n                    {name: 'spacer'},\n                    'customPlaybackRateMenuButton',\n                    'customSubtitlesButton',\n                    'customAudioTrackButton',\n                    'volumePanel',\n                    'chromecastButton',\n                    'fullscreenToggle',\n                ],\n            },\n            userActions: {\n                hotkeys: createHotKeysFunction(this.videojsInstance, {backward: -30, forward: 30}),\n            },\n            html5: {\n                vhs: {\n                    // do to use videojs-http-streaming if it's natively supported\n                    overrideNative: !supportsNativeHLS(this.videojsInstance),\n                    cacheEncryptionKeys: true,\n                },\n            },\n            ...initParams.options,\n        };\n\n        this.player = this.videojsInstance(videoElement, playOptions);\n        this.player.eme();\n        this.player.eme.initLegacyFairplay();\n\n        this.bindEvents();\n    }\n\n    // when chromecast is connected, set the src with playParams so the chromecast-tech will pick it up\n    // otherwise fetch the play config and set the src with it\n    playByParams(playParams: PlayParams): Promise<void> {\n        this.stopped = false;\n        if (this.castSender && this.castSender.isConnected()) {\n            this.localPlayConfig = null;\n            this.player.src({src: 'chromecast', type: 'application/vnd.chromecast', playParams});\n            return Promise.resolve();\n        } else {\n            if (this.apiService) {\n                this.player.addClass('vjs-waiting');\n                this.apiService.setToken(playParams.token ? playParams.token : null);\n\n                return this.apiService\n                    .getArticleAssetPlayConfig(playParams)\n                    .then(config => {\n                        // since fetching is async, the player may be stopped, and we do not want to start play\n                        if (!this.stopped) {\n                            this.player.src(this.getAndInitPlaySourcesFromConfig(config, playParams));\n                        } else {\n                            this.player.removeClass('vjs-waiting');\n                        }\n                    })\n                    .catch(ex => {\n                        this.player.removeClass('vjs-waiting');\n                        throw ex;\n                    });\n            } else {\n                return Promise.reject('No API service available');\n            }\n        }\n    }\n\n    play(playConfig: PlayConfig) {\n        this.stopped = false;\n        if (this.castSender && this.castSender.isConnected()) {\n            console.error('video-player: play() is not supported when chromecast is connected');\n        } else {\n            this.player.src(this.getAndInitPlaySourcesFromConfig(playConfig));\n\n            if (this.initParams.fullscreen) {\n                this.player.requestFullscreen();\n            }\n        }\n    }\n\n    setPoster(posterUrl: string) {\n        this.player.poster(posterUrl);\n    }\n\n    // update the HTML of the overlay plugin\n    updateOverlay(el: HTMLElement) {\n        if (this.player) {\n            const overlayComponent = this.player.overlay;\n            if (overlayComponent) {\n                overlayComponent.updateContent(el);\n            }\n        }\n    }\n\n    destroy() {\n        this.stop();\n        this.playerLoggerService.destroy();\n\n        if (this.castSender) {\n            this.castSender.removeOnConnectedListener(this.onConnectedListener);\n            this.castSender.removeOnPlayStateListener(this.onPlayStateListener);\n        }\n        if (this.player) {\n            this.player.dispose();\n        }\n        this.player = null;\n        this.currentAudioTrack = null;\n        this.currentTextTrack = null;\n        this.currentTime = -1;\n    }\n\n    getPlayer(): any {\n        return this.player;\n    }\n\n    // stop the player, end the session in case of chromecast\n    // if it's currently playing, pause it.\n    // reset the player to its initial state\n    stop() {\n        if (this.continueTimeout) {\n            clearTimeout(this.continueTimeout);\n            this.continueTimeout = null;\n        }\n        if (!this.stopped) {\n            this.stopped = true;\n            this.firstPlayingEvent = true;\n            if (this.player) {\n                if (this.player.isFullscreen()) {\n                    this.player.exitFullscreen();\n                }\n                if (false === this.player.ended()) {\n                    this.player.pause();\n                    // only if we have not already caught the 'ended' event\n                    // Be aware that the `stopped` emit also send along all kinds of info, so call _before_ disposing player\n                    if (this.localPlayConfig) {\n                        this.playerLoggerService.onStop();\n                    }\n                }\n                this.player.removeClass('vjs-waiting');\n                this.player.reset();\n            }\n        }\n    }\n\n    isStopped(): boolean {\n        return this.stopped;\n    }\n\n    private getAndInitPlaySourcesFromConfig(playConfig: PlayConfig, playParams: PlayParams = null) {\n        this.localPlayConfig = playConfig;\n        this.playerLoggerService.onStart(playConfig.pulseToken, PlayerDeviceTypes.default, playConfig.localTimeDelta, true);\n\n        // simple assumption: either support FPS or Widevine\n        const supportsFPS = supportsHLS(this.videojsInstance);\n        const supportsWidevine = !supportsFPS;\n        // usable HLS sources are supported without DRM (protectionInfo) or when FPS is supported\n        const hlsSources = playConfig.entitlements.filter(\n            entitlement => entitlement.type === MimeTypeHls && (supportsFPS || entitlement.protectionInfo === null)\n        );\n        // usable Dash sources are supported without DRM or when Widevine is supported\n        const dashSources = playConfig.entitlements.filter(\n            entitlement => entitlement.type === MimeTypeDash && (supportsWidevine || entitlement.protectionInfo === null)\n        );\n        const mp4Sources = playConfig.entitlements.filter(entitlement => entitlement.type === MimeTypeMp4);\n        // configure HLS only in case of `supportsHLS` or when no other sources available.\n        const configureHLSOnly =\n            (supportsHLS(this.videojsInstance) || (dashSources.length === 0 && mp4Sources.length === 0)) && hlsSources.length > 0;\n\n        const trackParam = configureHLSOnly\n            ? {}\n            : {\n                  textTracks: playConfig.subtitles.map(track => ({\n                      kind: track.kind,\n                      src: track.src,\n                      srclang: track.srclang,\n                      label: track.label,\n                      enabled: track.srclang === playConfig.subtitleLocale,\n                  })),\n              };\n\n        const playSources = playConfig.entitlements\n            .map(entitlement => {\n                const emeOptions = getEmeOptionsFromEntitlement(this.videojsInstance, entitlement);\n                return {\n                    src: entitlement.src,\n                    type: entitlement.type,\n                    playParams,\n                    ...emeOptions,\n                    ...trackParam,\n                };\n            })\n            .filter(playOption => {\n                return (playOption.type === MimeTypeHls && configureHLSOnly) || !configureHLSOnly;\n            });\n\n        return playSources;\n    }\n\n    private bindEvents() {\n        if (this.castSender) {\n            this.castSender.addOnConnectedListener(this.onConnectedListener);\n            this.castSender.addOnPlayStateListener(this.onPlayStateListener);\n        }\n        this.player.on('error', () => {\n            if (this.localPlayConfig) {\n                this.playerLoggerService.onError(JSON.stringify(this.player.error()));\n            }\n        });\n\n        this.player.on('playing', () => {\n            if (this.localPlayConfig) {\n                if (this.firstPlayingEvent) {\n                    this.firstPlayingEvent = false;\n                    if (this.localPlayConfig && this.localPlayConfig.currentTime > 0) {\n                        this.player.currentTime(this.localPlayConfig.currentTime);\n                    }\n                    if (this.localPlayConfig && this.localPlayConfig.continuePaused) {\n                        this.player.pause();\n                    }\n                }\n                this.checkSelectedTracks();\n                this.playerLoggerService.onPlaying();\n            }\n        });\n\n        this.player.on('pause', () => {\n            if (this.localPlayConfig) {\n                this.checkSelectedTracks();\n                if (this.player.paused() && !this.player.ended()) {\n                    if (this.localPlayConfig) {\n                        this.playerLoggerService.onPause();\n                    }\n                }\n            }\n        });\n\n        this.player.on('ended', () => {\n            if (this.localPlayConfig) {\n                this.checkSelectedTracks();\n                if (this.localPlayConfig) {\n                    this.playerLoggerService.onStop();\n                }\n            }\n        });\n\n        const skipIntroComponent = this.player.skipIntro;\n\n        this.player.on('timeupdate', () => {\n            const tempTime = Math.ceil(this.player.currentTime()) || 0;\n            if (this.currentTime !== tempTime) {\n                this.currentTime = tempTime;\n\n                if (this.localPlayConfig) {\n                    this.checkSelectedTracks();\n                    this.playerLoggerService.onCurrentTimeUpdated(this.currentTime);\n                }\n\n                const skipIntroConfig = this.getSkipIntroConfig();\n\n                if (skipIntroConfig && skipIntroComponent) {\n                    if (skipIntroConfig.start <= this.currentTime && skipIntroConfig.end >= this.currentTime) {\n                        skipIntroComponent.trigger('show');\n                    } else {\n                        skipIntroComponent.trigger('hide');\n                    }\n                }\n            }\n        });\n\n        if (skipIntroComponent) {\n            skipIntroComponent.on('skip', () => {\n                const skipIntroConfig = this.getSkipIntroConfig();\n                if (skipIntroConfig) {\n                    this.player.currentTime(skipIntroConfig.end);\n                }\n            });\n        }\n\n        this.player.on('durationchange', () => {\n            if (this.localPlayConfig) {\n                this.checkSelectedTracks();\n                this.playerLoggerService.onDurationUpdated(this.player.duration());\n            }\n        });\n\n        this.player.on('loadedmetadata', () => {\n            if (this.localPlayConfig) {\n                const selectedSource = this.player.currentSource();\n                const textTracks = selectedSource.textTracks || [];\n\n                textTracks.forEach((track: any) => {\n                    this.player.addRemoteTextTrack(track, false);\n                });\n\n                const audioTrackList = this.player.audioTracks();\n                if (audioTrackList && audioTrackList.length > 0) {\n                    // set default tracks when available\n                    this.setDefaultAudioTrack();\n                    this.setDefaultTextTrack();\n                    this.metadataLoaded = true;\n                } else {\n                    // unfortunately there is no reliable way to know when iOS native binding to text-tracks is done\n                    // (even after first play event, this is not true), so we resort to an old fashioned timeout\n                    setTimeout(() => {\n                        this.setDefaultAudioTrack();\n                        this.setDefaultTextTrack();\n                        this.metadataLoaded = true;\n                    }, 1000);\n                }\n            }\n        });\n    }\n\n    getCastSender() {\n        return this.castSender;\n    }\n\n    private checkSelectedTracks() {\n        if (!this.metadataLoaded) {\n            return false;\n        }\n\n        let selectedAudioTrack = '';\n        let selectedTextTrack = '';\n        let selectedResolution = null;\n\n        const videoWidth = this.player.videoWidth();\n        const videoHeight = this.player.videoHeight();\n\n        if (videoWidth > 0 && videoHeight > 0) {\n            selectedResolution = videoWidth + 'x' + videoHeight;\n        }\n\n        const tracks = this.player.textTracks() as any;\n        for (let i = 0; i < tracks.length; i++) {\n            if (tracks[i].mode === 'showing' && tracks[i].kind === 'subtitles') {\n                selectedTextTrack = tracks[i].language;\n            }\n        }\n\n        const audioTracks = this.player.audioTracks();\n        for (let i = 0; i < audioTracks.length; i++) {\n            if (audioTracks[i].enabled) {\n                selectedAudioTrack = audioTracks[i].language;\n                break;\n            }\n        }\n\n        if (this.localPlayConfig) {\n            this.playerLoggerService.updateProperties({\n                textTrack: selectedTextTrack,\n                audioTrack: selectedAudioTrack,\n                resolution: selectedResolution,\n            });\n        }\n\n        if (this.currentTextTrack !== null && this.currentTextTrack !== selectedTextTrack) {\n            if (this.localPlayConfig) {\n                this.playerLoggerService.onTextTrackChanged(selectedTextTrack);\n            }\n        }\n\n        this.currentTextTrack = selectedTextTrack;\n\n        if (this.currentAudioTrack !== null && this.currentAudioTrack !== selectedAudioTrack) {\n            if (this.localPlayConfig) {\n                this.playerLoggerService.onAudioTrackChanged(selectedAudioTrack);\n            }\n        }\n        this.currentAudioTrack = selectedAudioTrack;\n    }\n\n    private setDefaultTextTrack() {\n        if (this.localPlayConfig && this.localPlayConfig.subtitleLocale) {\n            const tracks = this.player.textTracks();\n            for (let i = 0; i < tracks.length; i++) {\n                // textTracks is not a real array so no iterators here\n                if (tracks[i].mode !== 'disabled') {\n                    tracks[i].mode = 'disabled';\n                }\n            }\n            // it must be split up in to two loops, because two 'showing' items will break\n            for (let i = 0; i < tracks.length; i++) {\n                const trackLocale = getISO2Locale(tracks[i].language);\n                if (trackLocale === this.localPlayConfig.subtitleLocale.toLowerCase() && tracks[i].kind === 'subtitles') {\n                    tracks[i].mode = 'showing';\n                    break;\n                }\n            }\n        }\n    }\n\n    private setDefaultAudioTrack() {\n        if (this.localPlayConfig && this.localPlayConfig.audioLocale) {\n            const audioTracks = this.player.audioTracks();\n            for (let i = 0; i < audioTracks.length; i++) {\n                const trackLocale = getISO2Locale(audioTracks[i].language);\n                if (\n                    (this.localPlayConfig.audioLocale && trackLocale === this.localPlayConfig.audioLocale.toLowerCase()) ||\n                    (this.localPlayConfig.audioLocale === '' && i === 0)\n                ) {\n                    audioTracks[i].enabled = true;\n                    break;\n                }\n            }\n        }\n    }\n\n    private onConnectedListener = (info: ChromecastConnectionInfo) => {\n        if (!this.player) {\n            return;\n        }\n\n        const fsButton = this.player.controlBar.getChild('fullscreenToggle');\n        if (info.connected) {\n            this.player.addClass('vjs-chromecast-connected');\n            if (fsButton) {\n                fsButton.hide();\n            }\n        } else {\n            this.player.removeClass('vjs-chromecast-connected');\n            if (fsButton) {\n                fsButton.show();\n            }\n        }\n\n        if (info.connected && this.player.currentType() !== 'application/vnd.chromecast') {\n            this.continueWithCurrentSources();\n        }\n    };\n\n    private onPlayStateListener = (state: chrome.cast.media.PlayerState, info: ChromecastPlayInfo) => {\n        if (state === null || state === chrome.cast.media.PlayerState.IDLE) {\n            this.player.removeClass('vjs-chromecast-has-media');\n\n            if (this.player.currentType() === 'application/vnd.chromecast') {\n                // chromecast could have become IDLE due to closed connection,\n                // so check if no longer connected to continue with current sources after a small timeout\n                setTimeout(() => {\n                    if (this.castSender && !this.castSender.isConnected()) {\n                        this.continueWithCurrentSources();\n                    }\n                }, 300);\n            }\n        } else {\n            this.player.addClass('vjs-chromecast-has-media');\n        }\n    };\n\n    private continueWithCurrentSources() {\n        const currentSources = this.player.currentSources();\n        const continuePaused = this.player.paused();\n\n        if (!this.stopped && currentSources && currentSources.length > 0 && currentSources[0].playParams && this.player.currentType()) {\n            this.stop();\n\n            this.player.addClass('vjs-waiting');\n            this.continueTimeout = setTimeout(() => {\n                this.continueTimeout = null;\n                this.playByParams({\n                    ...currentSources[0].playParams,\n                    continuePaused,\n                });\n            }, 3000);\n        }\n    }\n\n    private getSkipIntroConfig() {\n        if (this.localPlayConfig) {\n            return this.localPlayConfig.skipIntro;\n        } else if (this.castSender) {\n            const remoteConfig = this.castSender.getPlayConfig();\n            if (remoteConfig && remoteConfig.skipIntro) {\n                return remoteConfig.skipIntro;\n            }\n        }\n        return null;\n    }\n}\n","import {getNativeLanguage} from '../../utils/locale';\n\nexport function createAudioTrackPlugin(videojsInstance: any) {\n    const AudioTrackButton = videojsInstance.getComponent('audioTrackButton');\n    const AudioTrackMenuItem = videojsInstance.getComponent('audioTrackMenuItem');\n\n    // based on AudioTrackMenuItem\n    class CustomAudioTrackMenuItem extends AudioTrackMenuItem {\n        private track: any;\n\n        constructor(player: any, options: any) {\n            const track = options.track;\n            const tracks = player.audioTracks();\n\n            // AP: Modify options for parent MenuItem class's init.\n            options.label = getNativeLanguage(track.language || track.label) || 'Unknown';\n            options.selected = track.enabled;\n\n            super(player, options);\n            this.track = track;\n            this.addClass(`vjs-${track.kind}-menu-item`);\n            const changeHandler = (...args: any) => {\n                this.handleTracksChange.apply(this, args);\n            };\n            tracks.addEventListener('change', changeHandler);\n            this.on('dispose', () => {\n                tracks.removeEventListener('change', changeHandler);\n            });\n        }\n        createEl(type: any, props: any, attrs: any) {\n            const el = super.createEl(type, props, attrs);\n            const parentSpan = el.querySelector('.vjs-menu-item-text');\n            if (this.options_.track.kind === 'main-desc') {\n                parentSpan.appendChild(\n                    super.createEl(\n                        'span',\n                        {\n                            className: 'vjs-icon-placeholder',\n                        },\n                        {\n                            'aria-hidden': true,\n                        }\n                    )\n                );\n                parentSpan.appendChild(\n                    super.createEl('span', {\n                        className: 'vjs-control-text',\n                        textContent: ' ' + this.localize('Descriptions'),\n                    })\n                );\n            }\n            return el;\n        }\n\n        handleClick(event: any) {\n            super.handleClick(event);\n\n            // the audio track list will automatically toggle other tracks\n            // off for us.\n            this.track.enabled = true;\n\n            // when native audio tracks are used, we want to make sure that other tracks are turned off\n            if (this.player_.tech_.featuresNativeAudioTracks) {\n                const tracks = this.player_.audioTracks();\n                for (let i = 0; i < tracks.length; i++) {\n                    const track = tracks[i];\n\n                    // skip the current track since we enabled it above\n                    if (track === this.track) {\n                        continue;\n                    }\n                    track.enabled = track === this.track;\n                }\n            }\n        }\n\n        handleTracksChange(event: any) {\n            this.selected(this.track.enabled);\n        }\n    }\n\n    class CustomAudioTrackButton extends AudioTrackButton {\n        constructor(player: any, options: any) {\n            super(player);\n        }\n\n        createItems(items: any = []) {\n            // if there's only one audio track, there no point in showing it\n            this.hideThreshold_ = 1;\n            const tracks = this.player_.audioTracks();\n            for (let i = 0; i < tracks.length; i++) {\n                const track = tracks[i];\n                items.push(\n                    new CustomAudioTrackMenuItem(this.player_, {\n                        track,\n                        // MenuItem is selectable\n                        selectable: true,\n                        // MenuItem is NOT multiSelectable (i.e. only one can be marked \"selected\" at a time)\n                        multiSelectable: false,\n                    })\n                );\n            }\n            return items;\n        }\n    }\n\n    videojsInstance.registerComponent('customAudioTrackButton', CustomAudioTrackButton);\n}\n","export function createChromecastButtonPlugin(videojsInstance: any) {\n    const Component = videojsInstance.getComponent('component');\n\n    const singletonCastElement = (document as any).createElement('google-cast-launcher');\n    singletonCastElement.className = 'vjs-chromecast-button';\n\n    class ChromecastButton extends Component {\n        constructor(player: any, options: any) {\n            super(player, options);\n        }\n        createEl() {\n            const el = super.createEl();\n            el.appendChild(singletonCastElement);\n            return el;\n        }\n    }\n\n    videojsInstance.registerComponent('chromecastButton', ChromecastButton);\n}\n","export function createCustomOverlaykPlugin(videojsInstance: any) {\n    const Component = videojsInstance.getComponent('Component');\n\n    class CustomOverlay extends Component {\n        createEl() {\n            return this.options_.element;\n        }\n    }\n\n    videojsInstance.registerComponent('customOverlay', CustomOverlay);\n}\n","export function createOverlayPlugin(videojsInstance: any) {\n    const Component = videojsInstance.getComponent('Component');\n    const dom = videojsInstance.dom || videojsInstance;\n\n    class Overlay extends Component {\n        createEl() {\n            const el = dom.createEl('div', {\n                className: `vjs-overlay`,\n            });\n\n            if (this.options_.element) {\n                el.appendChild(this.options_.element);\n            }\n\n            return el;\n        }\n\n        updateContent(el: HTMLElement) {\n            this.el_.innerHTML = '';\n            this.el_.appendChild(el);\n        }\n    }\n\n    videojsInstance.registerComponent('overlay', Overlay);\n}\n","export function createPlaybackRatePlugin(videojsInstance: any) {\n    const PlaybackRateMenuButton = videojsInstance.getComponent('playbackRateMenuButton');\n\n    class CustomPlaybackRateMenuButton extends PlaybackRateMenuButton {\n        constructor(player: any, options: any) {\n            super(player);\n        }\n\n        createEl() {\n            const el = super.createEl();\n\n            el.innerHTML = `<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\" class=\"vjs-playback-rate-svg\">\n            <path d=\"M0 0h24v24H0z\" fill=\"none\"/>\n            <path class=\"vjs-custom-svg-color\" d=\"M20.38 8.57l-1.23 1.85a8 8 0 0 1-.22 7.58H5.07A8 8 0 0 1 15.58 6.85l1.85-1.23A10 10 0 0 0 3.35 19a2 2 0 0 0 1.72 1h13.85a2 2 0 0 0 1.74-1 10 10 0 0 0-.27-10.44zm-9.79 6.84a2 2 0 0 0 2.83 0l5.66-8.49-8.49 5.66a2 2 0 0 0 0 2.83z\"/></svg>`;\n\n            return el;\n        }\n    }\n\n    videojsInstance.registerComponent('customPlaybackRateMenuButton', CustomPlaybackRateMenuButton);\n}\n","export function createSkipIntroPlugin(videojsInstance: any) {\n    const ClickableComponent = videojsInstance.getComponent('ClickableComponent');\n    const dom = videojsInstance.dom || videojsInstance;\n\n    class SkipIntro extends ClickableComponent {\n        constructor(player: any, options: any) {\n            super(player, options);\n\n            let timeoutHandle = 0;\n            let insideIntro = false;\n            let userActive = false;\n            let showing = false;\n            let firstShowWithTimeout = false;\n\n            const show = () => {\n                if (!showing) {\n                    showing = true;\n                    this.removeClass('vjs-skip-intro-button--hidden');\n                }\n            };\n\n            const hide = () => {\n                if (showing) {\n                    showing = false;\n                    this.addClass('vjs-skip-intro-button--hidden');\n                }\n            };\n\n            const showWithTimeout = () => {\n                firstShowWithTimeout = true;\n                show();\n                clearTimeout(timeoutHandle);\n                // @ts-ignore timout handle\n                timeoutHandle = setTimeout(function () {\n                    hide();\n                    timeoutHandle = 0;\n                }, 10000);\n            };\n\n            const activeHandler = () => {\n                userActive = true;\n                if (insideIntro) {\n                    show();\n                }\n            };\n\n            const inactiveHandler = () => {\n                userActive = false;\n                if (timeoutHandle === 0) {\n                    hide();\n                }\n            };\n\n            const showHandler = () => {\n                insideIntro = true;\n\n                if (!firstShowWithTimeout) {\n                    showWithTimeout();\n                }\n            };\n\n            const hideHandler = () => {\n                insideIntro = false;\n                firstShowWithTimeout = false;\n                hide();\n            };\n\n            player.on('useractive', activeHandler);\n            player.on('userinactive', inactiveHandler);\n\n            this.on('show', showHandler);\n            this.on('hide', hideHandler);\n\n            this.on('dispose', function () {\n                this.off('show', showHandler);\n                this.off('hide', hideHandler);\n\n                player.off('useractive', activeHandler);\n                player.off('userinactive', inactiveHandler);\n            });\n        }\n\n        createEl() {\n            const el = super.createEl('div', {\n                className: 'vjs-skip-intro-button vjs-skip-intro-button--hidden',\n            });\n\n            // Create the text label\n            const text = document.createElement('span');\n            text.className = 'vjs-skip-intro-button-text';\n            text.innerText = this.options_.label || 'Skip';\n\n            el.appendChild(text);\n\n            return el;\n        }\n\n        handleClick(event: any) {\n            this.trigger('skip');\n        }\n    }\n\n    videojsInstance.registerComponent('skipIntro', SkipIntro);\n}\n","import {getNativeLanguage} from '../../utils/locale';\n\nexport function createSubtitlesButtonPlugin(videojsInstance: any) {\n    const SubtitlesButton = videojsInstance.getComponent('textTrackButton');\n    const MenuItem = videojsInstance.getComponent('menuItem');\n    const OffTextTrackMenuItem = videojsInstance.getComponent('offTextTrackMenuItem');\n\n    // based on TextTrackMenuItem\n    class CustomTextTrackMenuItem extends MenuItem {\n        constructor(player: any, options: any) {\n            const track = options.track;\n            const tracks = player.textTracks();\n\n            // Modify options for parent MenuItem class's init.\n            options.label = getNativeLanguage(track.language || track.label) || 'Unknown';\n            options.selected = track.mode === 'showing';\n            super(player, options);\n            this.track = track;\n            // Determine the relevant kind(s) of tracks for this component and filter\n            // out empty kinds.\n            this.kinds = (options.kinds || [options.kind || this.track.kind]).filter(Boolean);\n            const changeHandler = (...args: any) => {\n                this.handleTracksChange.apply(this, args);\n            };\n            const selectedLanguageChangeHandler = (...args: any) => {\n                this.handleSelectedLanguageChange.apply(this, args);\n            };\n            player.on(['loadstart', 'texttrackchange'], changeHandler);\n            tracks.addEventListener('change', changeHandler);\n            tracks.addEventListener('selectedlanguagechange', selectedLanguageChangeHandler);\n            this.on('dispose', function () {\n                player.off(['loadstart', 'texttrackchange'], changeHandler);\n                tracks.removeEventListener('change', changeHandler);\n                tracks.removeEventListener('selectedlanguagechange', selectedLanguageChangeHandler);\n            });\n\n            // iOS7 doesn't dispatch change events to TextTrackLists when an\n            // associated track's mode changes. Without something like\n            // Object.observe() (also not present on iOS7), it's not\n            // possible to detect changes to the mode attribute and polyfill\n            // the change event. As a poor substitute, we manually dispatch\n            // change events whenever the controls modify the mode.\n            if (tracks.onchange === undefined) {\n                let event: any;\n                this.on(['tap', 'click'], function () {\n                    if (typeof window.Event !== 'object') {\n                        // Android 2.3 throws an Illegal Constructor error for window.Event\n                        try {\n                            event = new window.Event('change');\n                        } catch (err) {\n                            // continue regardless of error\n                        }\n                    }\n                    if (!event) {\n                        event = document.createEvent('Event');\n                        event.initEvent('change', true, true);\n                    }\n                    tracks.dispatchEvent(event);\n                });\n            }\n\n            // set the default state based on current tracks\n            this.handleTracksChange();\n        }\n\n        handleClick(event: any) {\n            const referenceTrack = this.track;\n            const tracks = this.player_.textTracks();\n            super.handleClick(event);\n            if (!tracks) {\n                return;\n            }\n            for (let i = 0; i < tracks.length; i++) {\n                const track = tracks[i];\n\n                // If the track from the text tracks list is not of the right kind,\n                // skip it. We do not want to affect tracks of incompatible kind(s).\n                if (this.kinds.indexOf(track.kind) === -1) {\n                    continue;\n                }\n\n                // If this text track is the component's track and it is not showing,\n                // set it to showing.\n                if (track === referenceTrack) {\n                    if (track.mode !== 'showing') {\n                        track.mode = 'showing';\n                    }\n\n                    // If this text track is not the component's track and it is not\n                    // disabled, set it to disabled.\n                } else if (track.mode !== 'disabled') {\n                    track.mode = 'disabled';\n                }\n            }\n        }\n\n        handleTracksChange(event?: any) {\n            const shouldBeSelected = this.track.mode === 'showing';\n\n            // Prevent redundant selected() calls because they may cause\n            // screen readers to read the appended control text unnecessarily\n            if (shouldBeSelected !== this.isSelected_) {\n                this.selected(shouldBeSelected);\n            }\n        }\n\n        handleSelectedLanguageChange(event: any) {\n            if (this.track.mode === 'showing') {\n                const selectedLanguage = this.player_.cache_.selectedLanguage;\n\n                // Don't replace the kind of track across the same language\n                if (\n                    selectedLanguage &&\n                    selectedLanguage.enabled &&\n                    selectedLanguage.language === this.track.language &&\n                    selectedLanguage.kind !== this.track.kind\n                ) {\n                    return;\n                }\n                this.player_.cache_.selectedLanguage = {\n                    enabled: true,\n                    language: this.track.language,\n                    kind: this.track.kind,\n                };\n            }\n        }\n\n        dispose() {\n            // remove reference to track object on dispose\n            this.track = null;\n            super.dispose();\n        }\n    }\n\n    class CustomTextTrackButton extends SubtitlesButton {\n        constructor(player: any, options: any = {}) {\n            options.tracks = player.textTracks();\n            super(player, options);\n        }\n\n        createItems(items: any = [], TrackMenuItem = CustomTextTrackMenuItem) {\n            // Label is an override for the [track] off label\n            // USed to localise captions/subtitles\n            let label;\n            if (this.label_) {\n                label = `${this.label_} off`;\n            }\n            // Add an OFF menu item to turn all tracks off\n            items.push(\n                new OffTextTrackMenuItem(this.player_, {\n                    kinds: this.kinds_,\n                    kind: this.kind_,\n                    label,\n                })\n            );\n            this.hideThreshold_ += 1;\n            const tracks = this.player_.textTracks();\n            if (!Array.isArray(this.kinds_)) {\n                this.kinds_ = [this.kind_];\n            }\n            for (let i = 0; i < tracks.length; i++) {\n                const track = tracks[i];\n\n                // only add tracks that are of an appropriate kind and have a label\n                if (this.kinds_.indexOf(track.kind) > -1) {\n                    const item = new TrackMenuItem(this.player_, {\n                        track,\n                        kinds: this.kinds_,\n                        kind: this.kind_,\n                        // MenuItem is selectable\n                        selectable: true,\n                        // MenuItem is NOT multiSelectable (i.e. only one can be marked \"selected\" at a time)\n                        multiSelectable: false,\n                    });\n                    item.addClass(`vjs-${track.kind}-menu-item`);\n                    items.push(item);\n                }\n            }\n            return items;\n        }\n    }\n\n    class CustomSubtitlesButton extends CustomTextTrackButton {\n        constructor(player: any, options: any, ready: any) {\n            super(player, options);\n            this.setIcon('subtitles');\n        }\n\n        buildCSSClass() {\n            return `vjs-subtitles-button ${super.buildCSSClass()}`;\n        }\n\n        buildWrapperCSSClass() {\n            1;\n            return `vjs-subtitles-button ${super.buildWrapperCSSClass()}`;\n        }\n    }\n\n    CustomSubtitlesButton.prototype.kind_ = 'subtitles';\n\n    videojsInstance.registerComponent('customTextTrackButton', CustomTextTrackButton);\n    videojsInstance.registerComponent('customSubtitlesButton', CustomSubtitlesButton);\n}\n","import {ChromecastSender} from '../../chromecast/chromecast-sender';\nimport {getNativeLanguage} from '../../utils/locale';\nimport {ChromecastPlayInfo, TrackInfo} from '../../models/cast-info';\n\nexport function createChromecastTechPlugin(videojsInstance: any, castSender: ChromecastSender) {\n    const Tech = videojsInstance.getComponent('Tech');\n    const dom = videojsInstance.dom || videojsInstance;\n\n    class ChromecastTech extends Tech {\n        private myPlayerController: cast.framework.RemotePlayerController = null;\n        private myPlayer: cast.framework.RemotePlayer = null;\n        private lastCurrentTime = 0;\n        private didEnd = false;\n\n        public featuresVolumeControl = false;\n        public featuresMuteControl = false;\n        public featuresFullscreenResize = false;\n\n        constructor(options: any) {\n            super(options);\n\n            castSender.init().then(() => {\n                this.myPlayer = castSender.getCastPlayer();\n                this.myPlayerController = castSender.getCastPlayerController();\n\n                castSender.addOnPlayStateListener(this.onPlayStateListener);\n                castSender.addOnCurrentTimeListener(this.onCurrentTimeListener);\n                castSender.addOnDurationListener(this.onDurationListener);\n                castSender.addOnMediaTracksListener(this.onMediaTracksListener);\n\n                this.textTracks().addEventListener('change', () => this.handleTextTrackChange());\n                this.audioTracks().addEventListener('change', () => this.handleAudioTrackChange());\n\n                this.triggerReady();\n            });\n        }\n\n        static canPlaySource(x: any) {\n            return !!x && castSender && castSender.isConnected();\n        }\n\n        static isSupported() {\n            return true;\n        }\n\n        static canPlayType(type: string) {\n            return type === 'application/vnd.chromecast' ? 'probably' : '';\n        }\n\n        createEl(type: any, props: any, attrs: any) {\n            this.el_ = videojsInstance.dom.createEl('div', {\n                className: 'vjs-tech chromecast',\n            });\n            return this.el_;\n        }\n\n        play() {\n            if (this.myPlayerController && this.myPlayer && this.myPlayer.isConnected) {\n                if (this.ended()) {\n                    this.setCurrentTime(0);\n                    this.myPlayerController.playOrPause();\n                } else if (this.paused()) {\n                    this.myPlayerController.playOrPause();\n                }\n            }\n        }\n\n        pause() {\n            if (this.myPlayerController && this.myPlayer && this.myPlayer.isConnected) {\n                if (!this.paused() && this.myPlayer.canPause) {\n                    this.myPlayerController.playOrPause();\n                }\n            }\n        }\n\n        paused() {\n            const isPaused =\n                (this.myPlayer && this.myPlayer.isPaused) || this.ended() || (this.myPlayer && this.myPlayer.playerState === null);\n            return isPaused;\n        }\n\n        setSource(source: any) {\n            this.source = source;\n            this.didEnd = false;\n\n            if (!this.source) {\n                return;\n            }\n\n            if (this.source && this.source.src === 'restore') {\n                this.trigger('loadstart');\n            } else {\n                this.trigger('loadstart');\n                castSender\n                    .castVideoByParams(source.playParams)\n                    .then(() => {\n                        this.trigger('waiting');\n                    })\n                    .catch(err => console.log(err));\n            }\n        }\n\n        currentSrc() {\n            return this.source ? this.source.src || '' : '';\n        }\n\n        setCurrentTime(newTime: number) {\n            if (this.myPlayerController && this.myPlayer && this.myPlayer.isConnected && this.myPlayer.canSeek) {\n                const duration = this.duration();\n\n                if (newTime > duration) {\n                    return;\n                }\n                // Seeking to any place within (approximately) 1 second of the end of the item\n                // causes the Video.js player to get stuck in a BUFFERING state. To work around\n                // this, we only allow seeking to within 1 second of the end of an item.\n                this.myPlayer.currentTime = Math.min(duration - 1, Math.floor(newTime));\n                this.myPlayerController.seek();\n            } else {\n                console.log('Can not seek');\n            }\n        }\n\n        currentTime() {\n            return this.lastCurrentTime;\n        }\n\n        duration() {\n            if (!this.myPlayer) {\n                return NaN;\n            }\n            // console.log('duration', this.myPlayer.duration);\n            return this.myPlayer.duration === 0 ? NaN : this.myPlayer.duration;\n        }\n\n        ended() {\n            return this.didEnd;\n        }\n\n        buffered(): any {\n            return undefined;\n        }\n\n        seekable() {\n            const duration = this.duration();\n            if (duration > 0) {\n                return videojsInstance.time.createTimeRanges(0, duration);\n            }\n            return videojsInstance.time.createTimeRanges();\n        }\n\n        handleTextTrackChange() {\n            if (this.myPlayer && this.myPlayer.isConnected) {\n                const selected: any = Array.from(this.textTracks()).find((t: any) => t.mode === 'showing');\n                if (selected) {\n                    castSender.setActiveTrackById(selected.id, 'TEXT');\n                }\n            }\n        }\n\n        handleAudioTrackChange() {\n            if (this.myPlayer && this.myPlayer.isConnected) {\n                const selected: any = Array.from(this.audioTracks()).find((t: any) => t.enabled);\n                if (selected) {\n                    castSender.setActiveTrackById(selected.id, 'AUDIO');\n                }\n            }\n        }\n\n        /**\n         * Returns whether the native media controls should be shown (`true`) or hidden\n         */\n        controls() {\n            return false;\n        }\n\n        playsinline() {\n            return true;\n        }\n\n        supportsFullScreen() {\n            return false;\n        }\n\n        setAutoplay() {\n            // Not supported\n        }\n\n        playbackRate() {\n            return 1;\n        }\n\n        setPlaybackRate() {\n            // Not supported\n        }\n\n        preload() {\n            // Not supported\n        }\n\n        load() {\n            // Not supported\n        }\n\n        readyState() {\n            if (\n                !this.myPlayer ||\n                (this.myPlayer && this.myPlayer.playerState === null) ||\n                (this.myPlayer && this.myPlayer.playerState === chrome.cast.media.PlayerState.IDLE) ||\n                (this.myPlayer && this.myPlayer.playerState === chrome.cast.media.PlayerState.BUFFERING)\n            ) {\n                return 0;\n            }\n            return 4;\n        }\n\n        volume() {\n            return 1;\n        }\n\n        setVolume(volume: number) {\n            // Set volume\n        }\n\n        muted() {\n            return false;\n        }\n\n        setMuted(muted: boolean) {\n            // Mute/unmute\n        }\n\n        dispose() {\n            // Clean up anything your tech has created\n            castSender.removeOnPlayStateListener(this.onPlayStateListener);\n            castSender.removeOnCurrentTimeListener(this.onCurrentTimeListener);\n            castSender.removeOnDurationListener(this.onDurationListener);\n            castSender.removeOnMediaTracksListener(this.onMediaTracksListener);\n\n            this.textTracks().removeEventListener('change');\n            this.audioTracks().removeEventListener('change');\n\n            this.myPlayerController = null;\n            this.myPlayer = null;\n            this.source = null;\n            this.didEnd = false;\n            this.lastCurrentTime = 0;\n\n            super.dispose();\n        }\n\n        private onPlayStateListener = (state: chrome.cast.media.PlayerState, info: ChromecastPlayInfo) => {\n            if (!this.source) {\n                if (state === chrome.cast.media.PlayerState.IDLE || state === null) {\n                    return;\n                }\n                // @TODO do we also need a loadedmetadata in regular case\n                this.source = {src: 'restore', type: 'application/vnd.chromecast', playParams: {...info}};\n                this.didEnd = false;\n                this.triggerSourceset(this.source);\n                /// this.src({src: 'restore', type: 'application/vnd.chromecast'});\n                this.trigger('loadstart');\n\n                // regardless of play state, videojs always needs this for the 'first-play'\n                this.trigger('play');\n                this.trigger('playing');\n\n                if (this.myPlayer.playerState === null || this.myPlayer.playerState === chrome.cast.media.PlayerState.BUFFERING) {\n                    this.trigger('waiting');\n                } else if (this.myPlayer.playerState !== chrome.cast.media.PlayerState.PLAYING) {\n                    this.trigger('pause');\n                    // timeupdate needed when in paused state and restoring\n                    setTimeout(() => {\n                        this.trigger('timeupdate');\n                    }, 300);\n                }\n\n                this.trigger('timeupdate');\n            } else {\n                if (state === chrome.cast.media.PlayerState.PLAYING) {\n                    this.trigger('play');\n                    this.trigger('playing');\n                } else if (state === chrome.cast.media.PlayerState.PAUSED) {\n                    this.trigger('pause');\n                } else if (state === chrome.cast.media.PlayerState.BUFFERING) {\n                    this.trigger('waiting');\n                }\n            }\n        };\n        private onCurrentTimeListener = (currentTime: number) => {\n            this.lastCurrentTime = currentTime;\n            if (this.duration() > 0 && currentTime + 1 > this.duration() && !this.didEnd) {\n                this.didEnd = true;\n                this.trigger('ended');\n            }\n            this.trigger('timeupdate');\n        };\n\n        private onDurationListener = (duration: number) => {\n            this.trigger('durationchange');\n        };\n\n        private onMediaTracksListener = (audioTracks: TrackInfo[], textTracks: TrackInfo[]) => {\n            Array.from(this.audioTracks()).forEach((track: any) => this.audioTracks().removeTrack(track));\n            audioTracks.forEach(audioTrack => {\n                const track = new videojsInstance.AudioTrack({\n                    id: audioTrack.id,\n                    kind: 'main',\n                    label: getNativeLanguage(audioTrack.locale),\n                    language: audioTrack.locale,\n                    enabled: audioTrack.active,\n                });\n\n                this.audioTracks().addTrack(track);\n            });\n\n            Array.from(this.textTracks()).forEach((track: any) => this.textTracks().removeTrack(track));\n            textTracks.forEach(textTrack => {\n                const track = new videojsInstance.TextTrack({\n                    tech: this,\n                    id: textTrack.id,\n                    label: getNativeLanguage(textTrack.locale),\n                    kind: 'subtitles',\n                    language: textTrack.locale,\n                    mode: textTrack.active ? 'showing' : 'disabled',\n                });\n\n                this.textTracks().addTrack(track);\n            });\n        };\n    }\n\n    videojsInstance.registerTech('chromecast', ChromecastTech);\n}\n","import {PlayConfigProtection, PlayEntitlement, MimeTypeDash, MimeTypeHls} from '../models/play-config';\nimport {EmeOptions} from '../models/player-options';\n\nexport function getEmeOptionsFromEntitlement(videojs: any, entitlement: PlayEntitlement): EmeOptions {\n    let protectionInfo: PlayConfigProtection = null;\n    let emeOptions: EmeOptions = {};\n\n    if (entitlement.protectionInfo) {\n        switch (entitlement.type) {\n            case MimeTypeDash:\n                protectionInfo = entitlement.protectionInfo.find(p => p.type === 'Widevine');\n                if (protectionInfo) {\n                    emeOptions = {\n                        keySystems: {\n                            'com.widevine.alpha': protectionInfo.keyDeliveryUrl,\n                        },\n                        emeHeaders:\n                            protectionInfo.encryptionProvider === 'azl'\n                                ? {\n                                      Authorization: protectionInfo.authenticationToken,\n                                  }\n                                : {},\n                    };\n                }\n                break;\n            case MimeTypeHls:\n                protectionInfo = entitlement.protectionInfo.find(p => p.type === 'FairPlay');\n                if (protectionInfo) {\n                    if (protectionInfo.encryptionProvider === 'azl') {\n                        emeOptions = {\n                            keySystems: {\n                                'com.apple.fps.1_0': {\n                                    certificateUri: protectionInfo.certificateUrl,\n                                    getContentId: function () {\n                                        return getHostnameFromUri(protectionInfo.keyDeliveryUrl);\n                                    },\n                                    getLicense: function (emeArg: any, contentId: string, keyMessage: any, callback: any) {\n                                        const payload = 'spc=' + binaryToBase64(keyMessage) + '&assetId=' + encodeURIComponent(contentId);\n                                        videojs.xhr(\n                                            {\n                                                uri: protectionInfo.keyDeliveryUrl,\n                                                method: 'post',\n                                                headers: {\n                                                    'Content-type': 'application/x-www-form-urlencoded',\n                                                    Authorization: protectionInfo.authenticationToken,\n                                                },\n                                                body: payload,\n                                                responseType: 'arraybuffer',\n                                            },\n                                            videojs.xhr.httpHandler(function (err: any, response: ArrayBuffer) {\n                                                callback(null, parseLicenseResponse(response));\n                                            }, true)\n                                        );\n                                    },\n                                },\n                            },\n                        };\n                    } else {\n                        emeOptions = {\n                            keySystems: {\n                                'com.apple.fps.1_0': {\n                                    certificateUri: protectionInfo.certificateUrl,\n                                    getContentId: function () {\n                                        return protectionInfo.contentKeyId.replace('skd://', '').replace(';', '');\n                                    },\n                                    getLicense: function (emeArg: any, contentId: string, keyMessage: any, callback: any) {\n                                        const payload = keyMessage;\n                                        videojs.xhr(\n                                            {\n                                                uri: protectionInfo.keyDeliveryUrl,\n                                                method: 'post',\n                                                headers: {\n                                                    'Content-type': 'application/octet-stream',\n                                                },\n                                                body: payload,\n                                                responseType: 'arraybuffer',\n                                            },\n                                            videojs.xhr.httpHandler(function (err: any, response: ArrayBuffer) {\n                                                console.log('err', err, response);\n                                                callback(null, response);\n                                            }, true)\n                                        );\n                                    },\n                                },\n                            },\n                            emeHeaders: {},\n                        };\n                    }\n                }\n                break;\n        }\n    }\n    return emeOptions;\n}\n\nexport function binaryToBase64(a: Uint8Array) {\n    let b = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=',\n        c = [];\n    for (let d = 0; d < a.byteLength; ) {\n        let e = a[d++];\n        (c.push(b.charAt(e >> 2)),\n            (e = (3 & e) << 4),\n            d < a.byteLength\n                ? (c.push(b.charAt(e | (a[d] >> 4))),\n                  (e = (15 & a[d++]) << 2),\n                  d < a.byteLength\n                      ? (c.push(b.charAt(e | (a[d] >> 6))), c.push(b.charAt(63 & a[d++])))\n                      : (c.push(b.charAt(e)), c.push('=')))\n                : (c.push(b.charAt(e)), c.push('==')));\n    }\n    return c.join('');\n}\n\nexport function base64ToBinary(a: string) {\n    let b = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=',\n        c = new Uint8Array(new ArrayBuffer((3 * a.length) / 4 + 4)),\n        e = 0;\n    for (let d = 0; d < a.length; ) {\n        let f = b.indexOf(a.charAt(d)),\n            g = b.indexOf(a.charAt(d + 1));\n        if (((c[e++] = (f << 2) | (g >> 4)), '=' !== a.charAt(d + 2))) {\n            let h = b.indexOf(a.charAt(d + 2));\n            if (((c[e++] = (g << 4) | (h >> 2)), '=' !== a.charAt(d + 3))) {\n                let i = b.indexOf(a.charAt(d + 3));\n                c[e++] = (h << 6) | i;\n            }\n        }\n        d += 4;\n    }\n    return new Uint8Array(c.buffer, 0, e);\n}\n\nexport function parseLicenseResponse(response: ArrayBuffer) {\n    const responseBody = String.fromCharCode.apply(null, new Uint8Array(response));\n\n    let b = responseBody.trim(),\n        c = b.indexOf('<ckc>'),\n        d = b.indexOf('</ckc>');\n    if (-1 === c || -1 === d) {\n        throw Error('License data format not as expected, missing or misplaced <ckc> tag');\n    }\n    c += 5;\n    b = b.substr(c, d - c);\n\n    return base64ToBinary(b);\n}\n\nexport function getHostnameFromUri(uri: string) {\n    let link = document.createElement('a');\n    link.href = uri;\n    return link.hostname;\n}\n","import {VideoPlayer} from './video-player/video-player';\nimport {ChromecastSender} from './chromecast/chromecast-sender';\nimport {ApiService} from './api/api-service';\nimport {PlayConfig} from './models/play-config';\nimport {InitParams, PlayParams} from './models/play-params';\nimport {getArticleBackgroundImage, getResizedUrl, toPlayConfigError} from './api/converters';\n\nexport class EmbedPlayer {\n    private projectId: number;\n    private apiBaseUrl: string;\n    private videoPlayer: VideoPlayer;\n    private castSender: ChromecastSender;\n    private apiService: ApiService;\n\n    constructor(videojsInstance: any, properties: {projectId: number; apiBaseUrl: string; chromecastReceiverAppId: string}) {\n        this.projectId = properties.projectId;\n        this.apiBaseUrl = properties.apiBaseUrl.replace(/\\/*$/, '');\n        this.apiService = new ApiService(this.apiBaseUrl, this.projectId);\n        this.videoPlayer = new VideoPlayer(videojsInstance, this.apiBaseUrl, this.projectId, properties.chromecastReceiverAppId);\n        this.castSender = this.videoPlayer.getCastSender();\n    }\n\n    initVideoPlayer(initParams: InitParams) {\n        this.videoPlayer.init(initParams);\n    }\n\n    setVideoPlayerPoster(posterUrl: string) {\n        this.videoPlayer.setPoster(posterUrl);\n    }\n\n    setVideoPlayerPosterFromArticle(articleId: number, posterSize: {width: number; height: number}) {\n        return this.apiService.getArticle(articleId).then(article => {\n            this.videoPlayer.setPoster(getResizedUrl(getArticleBackgroundImage(article), posterSize));\n        });\n    }\n\n    play(playParams: PlayParams) {\n        if (!playParams.articleId) {\n            return Promise.reject('articleId property is missing');\n        }\n        if (!playParams.assetId) {\n            return Promise.reject('assetId property is missing');\n        }\n        return this.videoPlayer.playByParams(playParams);\n    }\n\n    destroy() {\n        this.videoPlayer.destroy();\n    }\n\n    playVideo(config: PlayConfig) {\n        this.videoPlayer.play(config);\n    }\n\n    getVideoPlayer() {\n        return this.videoPlayer.getPlayer();\n    }\n\n    appendChromecastButton(selector: string | Element) {\n        const castButtonContaner = selector instanceof Element ? selector : document.querySelector(selector);\n        const castButton = document.createElement('google-cast-launcher');\n        castButtonContaner.appendChild(castButton);\n    }\n\n    castVideo(playParams: PlayParams) {\n        if (!playParams.articleId) {\n            return Promise.reject('articleId property is missing');\n        }\n        if (!playParams.assetId) {\n            return Promise.reject('assetId property is missing');\n        }\n\n        this.apiService.setToken(playParams.token);\n\n        return this.apiService.getArticle(playParams.articleId).then(article => {\n            playParams.article = article;\n            return this.castSender.castVideoByParams(playParams);\n        });\n    }\n\n    getCastSender() {\n        return this.castSender;\n    }\n\n    getCastPlayer() {\n        return this.castSender.getCastPlayer();\n    }\n\n    getCastPlayerController() {\n        return this.castSender.getCastPlayerController();\n    }\n\n    isConnected() {\n        return this.castSender.isConnected();\n    }\n\n    endSession(stopCasting: boolean) {\n        this.castSender.endSession(stopCasting);\n    }\n}\n//*** Example of usage ***//\n\n// const player = new EmbeddablePlayer();\n//\n// player\n//     .play({\n//         selector: '.video-wrapper',\n//         apiBaseUrl: '',\n//         projectId: '',\n//         articleId: '',\n//         assetId: '',\n//         token: '',\n//         posterImageUrl: '',\n//         fullScreen: false\n//         continueFromPreviousPosition: true\n//     })\n//     .then(config => {\n//         console.log('Config', config);\n//     })\n//     .catch(error => {\n//         console.log('Error', error);\n//     });\n\n//*** Example of usage with chromecast ***//\n\n// const player = new EmbeddablePlayer();\n// player.setupChromecast(\"#cast-wrapper\", CHROMECAST_RECEIVER_APP_ID);\n//\n// player\n//     .castVideo({\n//         apiBaseUrl: '',\n//         projectId: '',\n//         articleId: '',\n//         assetId: '',\n//         token: '',\n//         continueFromPreviousPosition: true\n//     })\n//     .then(config => {\n//         console.log('Config', config);\n//     })\n//     .catch(error => {\n//         console.log('Error', error);\n//     });\n","import {getNativeLanguage} from '../utils/locale';\nimport {TrackInfo} from '../models/cast-info';\nimport {ChromecastSender} from './chromecast-sender';\n\nexport class ChromecastControls {\n    private castSender: ChromecastSender;\n    private currentStatus: chrome.cast.media.PlayerState;\n    private playerController: cast.framework.RemotePlayerController;\n    private player: cast.framework.RemotePlayer;\n    private rootElement: HTMLElement;\n    private totalDuration: number;\n    private currentTime: number;\n\n    constructor(castSender: ChromecastSender, selector?: string | HTMLElement) {\n        this.castSender = castSender;\n        this.player = this.castSender.getCastPlayer();\n        this.playerController = this.castSender.getCastPlayerController();\n        this.totalDuration = this.player.duration || 0;\n        this.currentTime = this.player.currentTime || 0;\n        this.currentStatus = this.player.playerState;\n        this.createChromecastControlsTemplate(selector);\n        this.bindEvents();\n        this.setPlayButtonClass();\n        this.bindEventsToControls();\n        this.setProgressBarValues();\n    }\n\n    bindEvents() {\n        this.castSender.addOnMediaTracksListener((audioTracks: TrackInfo[], textTracks: TrackInfo[]) => {\n            if (this.rootElement && this.player.mediaInfo) {\n                this.renderTracks(audioTracks, textTracks);\n            }\n        });\n\n        this.castSender.addOnCurrentTimeListener(e => {\n            if (this.rootElement) {\n                this.currentTime = e;\n                this.totalDuration = this.player.duration;\n                this.setProgressBarValues();\n            }\n        });\n\n        this.castSender.addOnPlayStateListener(e => {\n            if (this.rootElement) {\n                this.currentStatus = e;\n                this.checkChromecastContainerVisibility();\n                this.setPlayButtonClass();\n                this.setProgressBarValues();\n            }\n        });\n\n        this.checkChromecastContainerVisibility();\n    }\n\n    createChromecastControlsTemplate(selector?: string | HTMLElement) {\n        const chromecastControlsTemplateString = `\n        <div class=\"chromecast-controls video-js vjs-workinghover\">\n            <div class=\"vjs-control-bar\">\n\n                <button class=\"play-pause-button vjs-play-control vjs-control vjs-button vjs-paused\" type=\"button\" title=\"Play\" aria-disabled=\"false\">\n                    <span class=\"vjs-icon-placeholder\" aria-hidden=\"true\"></span><span class=\"vjs-control-text\" aria-live=\"polite\">Play</span>\n                </button>\n\n               <div class=\"chromecast-controls__progress-bar\">\n                 <div class=\"chromecast-controls__progress-bar__current vjs-time-control\"></div>\n                 <div class=\"chromecast-controls__progress-bar-slider-container\">\n                    <input type=\"range\"\n                        value=\"0\"\n                        class=\"chromecast-controls__progress-bar__slider\"\n                        min=\"0\"\n                        max=\"100\"/>\n                    <div class=\"chromecast-controls__progress-bar__slider-left\"></div>\n                </div>\n                 <div class=\"chromecast-controls__progress-bar__total vjs-time-control\"></div>\n               </div>\n\n                <div class=\"vjs-subtitles-button vjs-menu-button vjs-menu-button-popup vjs-control vjs-button\">\n                    <button class=\"vjs-subtitles-button vjs-menu-button vjs-menu-button-popup vjs-button\" type=\"button\" aria-disabled=\"false\" aria-haspopup=\"true\" aria-expanded=\"false\">\n                        <span class=\"vjs-icon-placeholder\" aria-hidden=\"true\"></span>\n                        <span class=\"vjs-control-text\" aria-live=\"polite\"></span>\n                    </button>\n                    <div class=\"vjs-menu\"></div>\n                </div>\n\n                <div class=\"vjs-audio-button vjs-menu-button vjs-menu-button-popup vjs-control vjs-button\">\n                    <button class=\"vjs-audio-button vjs-menu-button vjs-menu-button-popup vjs-button\" type=\"button\" aria-disabled=\"false\" title=\"Audio Track\" aria-haspopup=\"true\" aria-expanded=\"false\">\n                        <span class=\"vjs-icon-placeholder\" aria-hidden=\"true\"></span>\n                        <span class=\"vjs-control-text\" aria-live=\"polite\">Audio Track</span>\n                    </button>\n                    <div class=\"vjs-menu\"></div>\n                </div>\n\n                <div class=\"vjs-control vjs-button vjs-chromecast-button\">\n                    <google-cast-launcher></google-cast-launcher>\n                </div>\n           </div>\n        </div>\n        `;\n\n        const element = !!selector ? (selector instanceof HTMLElement ? selector : document.querySelector(selector)) : document.body;\n        element.insertAdjacentHTML('beforeend', chromecastControlsTemplateString);\n\n        this.rootElement = element.querySelector('.chromecast-controls');\n    }\n\n    setPlayButtonClass() {\n        const playAndPauseButton = this.getElement('.play-pause-button');\n        if (this.currentStatus === chrome.cast.media.PlayerState.PAUSED) {\n            playAndPauseButton.classList.replace('vjs-playing', 'vjs-paused');\n        } else {\n            playAndPauseButton.classList.replace('vjs-paused', 'vjs-playing');\n        }\n    }\n\n    bindEventsToControls() {\n        const playAndPauseButton = this.getElement('.play-pause-button');\n        playAndPauseButton.addEventListener('click', () => this.playPause());\n\n        this.bindEventsToMenu('.vjs-subtitles-button');\n        this.bindEventsToMenu('.vjs-audio-button');\n\n        this.getElement('.chromecast-controls__progress-bar__slider').addEventListener('input', event => {\n            this.seek((event.target as HTMLProgressElement).value);\n        });\n    }\n\n    bindEventsToMenu(buttonSelector: string) {\n        const containerEl = this.getElement(`div${buttonSelector}`);\n        const buttonEl = this.getElement(`button${buttonSelector}`);\n        const menuEl = this.getElement(`${buttonSelector} .vjs-menu`);\n        buttonEl.addEventListener('click', event => {\n            if (!event.defaultPrevented) {\n                this.toggleMenu(menuEl, containerEl);\n            }\n        });\n        buttonEl.addEventListener('mouseenter', () => {\n            containerEl.classList.add('vjs-hover');\n        });\n        containerEl.addEventListener('mouseleave', () => {\n            containerEl.classList.remove('vjs-hover');\n        });\n        menuEl.addEventListener('blur', () => {\n            this.toggleMenu(menuEl, containerEl);\n        });\n    }\n\n    renderTracks(audioTracks: TrackInfo[], textTracks: TrackInfo[]) {\n        const sessionMediaInfo = cast.framework.CastContext.getInstance().getCurrentSession().getMediaSession();\n\n        if (sessionMediaInfo && sessionMediaInfo.media) {\n            if (sessionMediaInfo.media.streamType === chrome.cast.media.StreamType.LIVE) {\n                this.rootElement.classList.add('vjs-live');\n            } else {\n                this.rootElement.classList.remove('vjs-live');\n            }\n        }\n\n        const trackButton = this.getElement('.vjs-subtitles-button.vjs-menu-button-popup');\n        if (textTracks.length > 0) {\n            trackButton.classList.remove('vjs-hidden');\n        } else {\n            trackButton.classList.add('vjs-hidden');\n        }\n\n        const audioButton = this.getElement('.vjs-audio-button.vjs-menu-button-popup');\n        if (audioTracks.length > 0) {\n            audioButton.classList.remove('vjs-hidden');\n        } else {\n            audioButton.classList.add('vjs-hidden');\n        }\n\n        const audioTracksContainerElement = this.getElement('.vjs-audio-button .vjs-menu');\n        const textTracksContainerElement = this.getElement('.vjs-subtitles-button .vjs-menu');\n\n        audioTracksContainerElement.innerHTML = '';\n        if (audioTracks.length > 0) {\n            audioTracksContainerElement.appendChild(this.getTracksList(audioTracks, 'AUDIO'));\n        }\n\n        textTracksContainerElement.innerHTML = '';\n        if (textTracks.length > 0) {\n            textTracksContainerElement.appendChild(this.getTracksList(textTracks, 'TEXT'));\n        }\n    }\n\n    getTracksList(tracks: TrackInfo[], type: string) {\n        const tracksListElement = document.createElement('ul');\n        tracksListElement.classList.add('vjs-menu-content');\n        tracksListElement.addEventListener('click', event => this.setActiveTrack(event, type === 'AUDIO' ? 'AUDIO' : 'TEXT'));\n        tracks.forEach(track => {\n            const listItemElement = document.createElement('li');\n            listItemElement.classList.add('vjs-menu-item');\n            if (track.active) {\n                listItemElement.classList.add('vjs-selected');\n            } else {\n                listItemElement.classList.remove('vjs-selected');\n            }\n            listItemElement.innerText = getNativeLanguage(track.locale);\n            listItemElement.value = track.id;\n            tracksListElement.appendChild(listItemElement);\n        });\n        return tracksListElement;\n    }\n\n    getTransformedDurationValue(value: number) {\n        const hours = Math.floor(value / 3600);\n        const minutes = Math.floor((value - hours * 3600) / 60);\n        const seconds = Math.round(value - hours * 3600 - minutes * 60);\n        let result = '';\n        if (!value && value === 0) {\n            return '-';\n        }\n        if (hours > 0) {\n            result = hours + ':';\n            if (minutes < 10) {\n                result += '0';\n            }\n        }\n        result += minutes + ':';\n        if (seconds < 10) {\n            result += '0';\n        }\n        return result + seconds;\n    }\n\n    setProgressBarValues() {\n        if (this.rootElement) {\n            const currentTimeElement = this.getElement('.chromecast-controls__progress-bar__current') as HTMLElement;\n            const totalTimeElement = this.getElement('.chromecast-controls__progress-bar__total') as HTMLElement;\n            const progressBarElement = this.getElement('.chromecast-controls__progress-bar__slider') as HTMLProgressElement;\n            const progressLeftEl = this.getElement('.chromecast-controls__progress-bar__slider-left') as HTMLElement;\n\n            currentTimeElement.innerText = this.getTransformedDurationValue(this.currentTime);\n            totalTimeElement.innerText = this.getTransformedDurationValue(this.totalDuration);\n            progressBarElement.max = this.totalDuration;\n            progressBarElement.value = this.currentTime;\n\n            progressLeftEl.style.width = (progressBarElement.offsetWidth * this.currentTime) / this.totalDuration + 'px';\n        }\n    }\n\n    checkChromecastContainerVisibility() {\n        if (this.currentStatus === chrome.cast.media.PlayerState.IDLE) {\n            this.rootElement.classList.add('chromecast-controls--idle');\n        } else {\n            this.rootElement.classList.remove('chromecast-controls--idle');\n        }\n    }\n\n    playPause() {\n        if (this.player && this.player.isConnected) {\n            this.playerController.playOrPause();\n        }\n    }\n\n    seek(newTime: number) {\n        if (this.player && this.player.isConnected) {\n            this.player.currentTime = newTime;\n            this.playerController.seek();\n        }\n    }\n\n    stop() {\n        if (this.player && this.player.isConnected) {\n            this.playerController.stop();\n        }\n    }\n\n    setActiveTrack(event: MouseEvent, type: string) {\n        if (event.target instanceof HTMLLIElement && event.target.nodeName === 'LI') {\n            event.preventDefault();\n            event.stopPropagation();\n            const selectedTrackId = +event.target.value;\n\n            const newActiveTracks = this.castSender.getActiveTracksByType(type === 'AUDIO' ? 'TEXT' : 'AUDIO');\n            const activeTracksOfType = this.castSender.getActiveTracksByType(type);\n            const index = activeTracksOfType.indexOf(selectedTrackId);\n            if (type === 'AUDIO' || (type === 'TEXT' && index === -1)) {\n                newActiveTracks.push(selectedTrackId);\n            }\n            this.castSender.setActiveTracks(newActiveTracks, type);\n        }\n    }\n\n    toggleMenu(menuEl: HTMLElement, containerEl: HTMLElement) {\n        if (menuEl.classList.contains('vjs-lock-showing') || containerEl.classList.contains('vjs-hover')) {\n            menuEl.classList.remove('vjs-lock-showing');\n            menuEl.removeAttribute('tabindex');\n            containerEl.classList.remove('vjs-hover');\n        } else {\n            menuEl.classList.add('vjs-lock-showing');\n            menuEl.setAttribute('tabindex', '-1');\n            menuEl.focus();\n        }\n    }\n\n    getElement(selector: string) {\n        return this.rootElement.querySelector(selector) as HTMLElement;\n    }\n}\n"],"names":["ArticlePlayErrors","__webpack_require__","exports","definition","key","o","Object","defineProperty","enumerable","get","obj","prop","prototype","hasOwnProperty","call","MimeTypeHls","MimeTypeDash","MimeTypeMp4","supportsNativeHLS","videojs","browser","IS_ANY_SAFARI","IS_IOS","IS_SAFARI","supportsHLS","PlayingState","PlayerEventTypes","PlayerDeviceTypes","PlayerEventTypePayloads","PulseMode","PlayerLogProcessor","constructor","baseUrl","projectId","playLogs","apiCallInProgress","intervalHandle","this","apiUrl","replace","init","setInterval","processFirstPlayLog","destroy","clearInterval","processPlaySession","playSession","timeStamp","eventStack","length","eventStackPayload","i","sumDelta","lastEventWasProcessed","currentEvent","isEventTypeWithoutTimeDelta","eventType","push","convertEventToEventPayload","previousEvent","state","createDeltaEventPayload","lastEvent","lastLogEvent","splice","MAX_EVENTS","event_type","error","event_payload","playLogPayload","getPlayerLogPayloadWithPulseToken","pulseToken","event_stack","pulse_token","pulse_mode","isLive","live","offline","device_type","deviceType","forEach","e","processPlayLog","currentLog","removePlayLog","logToSend","eventStackIndex","isStopCutOff","stop","fetch","method","headers","Accept","body","JSON","stringify","then","catch","status","response","archive","find","log","logPayload","index","findIndex","textTrackChanged","audioTrackChanged","playStart","indexOf","createBaseEventPayload","playerEvent","timestamp","appa","playPosition","appr","Math","min","mediaDuration","resolution_tag","resolution","play","convertEventTypeToEventTypePayload","baseEvent","audio_locale","audioTrack","subtitle_locale","textTrack","timeDelta","getEventTypePayloadFromEventState","time_delta","playing","paused","buffering","loading","idle","configure","PlayerLoggerService","playerLogProcessor","reset","onStart","localTimeDelta","onStopCallback","onCurrentTimeUpdated","currentTime","playerProperties","logEvent","timeupdate","onDurationUpdated","duration","onPlaying","startInterval","onPause","pause","onError","onStop","stopped","stopInterval","onTextTrackChanged","onAudioTrackChanged","updateProperties","getTimeStamp","Date","now","createHotKeysFunction","videojesInstance","options","PlayToggle","getComponent","skip","component","skipTime","currentVideoTime","liveTracker","seekableEnd","newTime","event","handleClick","backward","forward","getISO2Locale","countryCode","countryISOMapping","AFG","ALA","ALB","DZA","ASM","AND","AGO","AIA","ATA","ATG","ARG","ARM","ABW","AUS","AUT","AZE","BHS","BHR","BGD","BRB","BLR","BEL","BLZ","BEN","BMU","BTN","BOL","BES","BIH","BWA","BVT","BRA","VGB","IOT","BRN","BGR","BFA","BDI","KHM","CMR","CAN","CPV","CYM","CAF","TCD","CHL","CHN","HKG","MAC","CXR","CCK","COL","COM","COG","COD","COK","CRI","CIV","HRV","CUB","CUW","CYP","CZE","DNK","DJI","DMA","DOM","ECU","EGY","SLV","GNQ","ERI","EST","ETH","FLK","FRO","FJI","FIN","FRA","GUF","PYF","ATF","GAB","GMB","GEO","DEU","GHA","GIB","GRC","GRL","GRD","GLP","GUM","GTM","GGY","GIN","GNB","GUY","HTI","HMD","VAT","HND","HUN","ISL","IND","IDN","IRN","IRQ","IRL","IMN","ISR","ITA","JAM","JPN","JEY","JOR","KAZ","KEN","KIR","PRK","KOR","KWT","KGZ","LAO","LVA","LBN","LSO","LBR","LBY","LIE","LTU","LUX","MKD","MDG","MWI","MYS","MDV","MLI","MLT","MHL","MTQ","MRT","MUS","MYT","MEX","FSM","MDA","MCO","MNG","MNE","MSR","MAR","MOZ","MMR","NAM","NRU","NPL","NLD","ANT","NCL","NZL","NIC","NER","NGA","NIU","NFK","MNP","NOR","OMN","PAK","PLW","PSE","PAN","PNG","PRY","PER","PHL","PCN","POL","PRT","PRI","QAT","REU","ROU","RUS","RWA","BLM","SHN","KNA","LCA","MAF","SPM","VCT","WSM","SMR","STP","SAU","SEN","SRB","SYC","SLE","SGP","SXM","SVK","SVN","SLB","SOM","ZAF","SGS","SSD","ESP","LKA","SDN","SUR","SJM","SWZ","SWE","CHE","SYR","TWN","TJK","TZA","THA","TLS","TGO","TKL","TON","TTO","TUN","TUR","TKM","TCA","TUV","UGA","UKR","ARE","GBR","USA","UMI","URY","UZB","VUT","VEN","VNM","VIR","WLF","ESH","YEM","ZMB","ZWE","XKX","toUpperCase","toLowerCase","substr","getNativeLanguage","lang","locale","isoLocales","ab","aa","af","ak","sq","am","ar","an","hy","as","av","ae","ay","az","bm","ba","eu","be","bn","bh","bi","bs","br","bg","my","ca","ch","ce","ny","zh","cv","kw","co","cr","hr","cs","da","dv","nl","en","eo","et","ee","fo","fj","fi","fr","ff","gl","ka","de","el","gn","gu","ht","ha","he","hz","hi","ho","hu","ia","id","ie","ga","ig","ik","io","is","it","iu","ja","jv","kl","kn","kr","ks","kk","km","ki","rw","ky","kv","kg","ko","ku","kj","la","lb","lg","li","ln","lo","lt","lu","lv","gv","mk","mg","ms","ml","mt","mi","mr","mh","mn","na","nv","nb","nd","ne","ng","nn","no","ii","nr","oc","oj","cu","om","or","os","pa","pi","fa","pl","ps","pt","qu","rm","rn","ro","ru","sa","sc","sd","se","sm","sg","sr","gd","sn","si","sk","sl","so","st","es","su","sw","ss","sv","ta","te","tg","th","ti","bo","tk","tl","tn","to","tr","ts","tt","tw","ty","ug","uk","ur","uz","ve","vi","vo","wa","cy","wo","fy","xh","yi","yo","za","mis","mul","und","zxx","graphRequest","apiFetchUrl","query","variables","token","Authorization","json","toFile","file","type","url","base_url","fileName","file_name","toMimeType","mimeType","console","warn","ApiService","setToken","getArticle","articleId","data","errors","message","code","name","article","Article","metas","reduce","metaObj","item","value","posters","map","images","getArticleAssetPlayConfig","playParams","deviceModelContext","supportsDRM","assetId","protocols","device_model_context","config","parse","issued_at","entitlements","entitlement","encryption_type","filter","entitlementConfig","src","manifest","mime_type","is_live","protectionInfo","mediaProvider","media_provider","protocol","authenticationToken","encryption_provider","keyDeliveryUrl","key_delivery_url","encryptionProvider","certificateUrl","fairplay_certificate_url","contentKeyId","hls_key_uri","subtitles","srclang","kind","label","locale_label","continueFromPreviousPosition","time_marker_end","skipIntro","time_marker_intro_end","time_marker_intro_start","start","end","continuePaused","article_id","asset_id","subtitleLocale","user_subtitle_locale","audioLocale","user_audio_locale","isNaN","aspectRatio","aspect_ratio","toPlayConfig","ArticleAssetPlay","ChromecastSender","chromecastReceiverAppId","castContext","castPlayer","castPlayerController","lastConnectionInfo","lastPlayStateInfo","updateInterval","supportsHDR","playConfig","onConnectedListeners","onPlayStateListeners","onCurrentTimeListeners","onMediaTracksListeners","onDurationListeners","onApiErrorListeners","initPromise","Error","Promise","resolve","reject","window","isAvailable","cast","framework","chrome","initializeCastApi","dispatchConnectionInfo","available","connected","friendlyName","scriptElement","document","createElement","async","head","appendChild","CastContext","getInstance","setOptions","receiverApplicationId","autoJoinPolicy","AutoJoinPolicy","TAB_AND_ORIGIN_SCOPED","RemotePlayer","RemotePlayerController","addEventListener","RemotePlayerEventType","IS_CONNECTED_CHANGED","isConnected","castSession","getCastSession","addMessageListener","namespace","messageObject","is_hdr_supported","listener","device","getCastDevice","dispatchPlayState","PLAYER_STATE_CHANGED","playerState","info","isMediaLoaded","mediaInfo","media","PlayerState","IDLE","customData","extraInfo","parsedInfo","DURATION_CHANGED","MEDIA_INFO_CHANGED","mediaSession","getCastMediaSession","audioTracks","textTracks","tracks","getTracksByType","addOnConnectedListener","callback","removeOnConnectedListener","addOnPlayStateListener","removeOnPlayStateListener","addOnCurrentTimeListener","getEstimatedTime","removeOnCurrentTimeListener","addOnMediaTracksListener","removeOnMediaTracksListener","addOnDurationListener","removeOnDurationListener","addOnApiErrorListener","removeOnApiErrorListener","getSupportsHDR","getPlayConfig","getCastMediaInfo","articlePlayConfig","contentType","supportedContentTypes","includes","option","trackId","castTrack","Track","TrackType","TEXT","trackContentId","trackContentType","subtype","TextTrackType","SUBTITLES","language","MediaInfo","streamType","StreamType","LIVE","BUFFERED","addMediaInfoToMetaData","audioLocaleParam","preferredAudioLocale","textTrackParam","preferredTextLocale","getCastMediaInfoByParams","contentId","random","getCurrentSession","getMediaSession","castVideo","request","LoadRequest","loadMedia","castVideoByParams","errorCode","ex","stopMedia","StopRequest","endSession","stopCasting","getCastPlayer","getCastPlayerController","metadata","GenericMediaMetadata","metadataType","MetadataType","GENERIC","title","getArticleTitle","image","Image","getActiveTracksByType","track","active","activeTrackIds","setActiveTracks","trackIds","tracksInfoRequest","EditTracksInfoRequest","editTracksInfo","setActiveTrackById","selectedTrackId","newActiveTracks","VideoPlayer","videojsInstance","player","apiService","castSender","continueTimeout","onConnectedListener","fsButton","controlBar","getChild","addClass","hide","removeClass","show","currentType","continueWithCurrentSources","onPlayStateListener","setTimeout","playerLoggerService","AudioTrackButton","AudioTrackMenuItem","CustomAudioTrackMenuItem","selected","enabled","super","changeHandler","args","handleTracksChange","apply","on","removeEventListener","createEl","props","attrs","parentSpan","querySelector","options_","className","textContent","localize","player_","tech_","featuresNativeAudioTracks","registerComponent","createItems","items","hideThreshold_","selectable","multiSelectable","createAudioTrackPlugin","Component","singletonCastElement","createChromecastButtonPlugin","element","createCustomOverlaykPlugin","dom","updateContent","el_","innerHTML","createOverlayPlugin","PlaybackRateMenuButton","createPlaybackRatePlugin","ClickableComponent","timeoutHandle","insideIntro","userActive","showing","firstShowWithTimeout","activeHandler","inactiveHandler","showHandler","clearTimeout","hideHandler","off","text","innerText","trigger","createSkipIntroPlugin","SubtitlesButton","MenuItem","OffTextTrackMenuItem","CustomTextTrackMenuItem","mode","kinds","Boolean","selectedLanguageChangeHandler","handleSelectedLanguageChange","undefined","onchange","Event","err","createEvent","initEvent","dispatchEvent","referenceTrack","shouldBeSelected","isSelected_","selectedLanguage","cache_","dispose","CustomTextTrackButton","TrackMenuItem","label_","kinds_","kind_","Array","isArray","CustomSubtitlesButton","ready","setIcon","buildCSSClass","buildWrapperCSSClass","createSubtitlesButtonPlugin","Tech","registerTech","myPlayerController","myPlayer","lastCurrentTime","didEnd","featuresVolumeControl","featuresMuteControl","featuresFullscreenResize","source","PLAYING","PAUSED","BUFFERING","triggerSourceset","onCurrentTimeListener","onDurationListener","onMediaTracksListener","from","removeTrack","AudioTrack","addTrack","TextTrack","tech","handleTextTrackChange","handleAudioTrackChange","triggerReady","canPlaySource","x","isSupported","canPlayType","ended","setCurrentTime","playOrPause","canPause","isPaused","setSource","currentSrc","canSeek","floor","seek","NaN","buffered","seekable","time","createTimeRanges","t","controls","playsinline","supportsFullScreen","setAutoplay","playbackRate","setPlaybackRate","preload","load","readyState","volume","setVolume","muted","setMuted","createChromecastTechPlugin","initParams","localPlayConfig","videoContainer","selector","Element","videoElement","setAttribute","defaultSkinClass","join","disableRemotePlayback","playOptions","fluid","fill","responsive","techOrder","pictureInPictureToggle","skipButtons","currentTimeDisplay","durationDisplay","timeDivider","volumePanel","inline","chromecastButton","children","userActions","hotkeys","html5","vhs","overrideNative","cacheEncryptionKeys","eme","initLegacyFairplay","bindEvents","playByParams","getAndInitPlaySourcesFromConfig","fullscreen","requestFullscreen","setPoster","posterUrl","poster","updateOverlay","overlayComponent","overlay","currentAudioTrack","currentTextTrack","getPlayer","firstPlayingEvent","isFullscreen","exitFullscreen","isStopped","default","supportsFPS","supportsWidevine","hlsSources","dashSources","mp4Sources","configureHLSOnly","trackParam","emeOptions","p","keySystems","emeHeaders","certificateUri","getContentId","uri","link","href","hostname","getHostnameFromUri","getLicense","emeArg","keyMessage","payload","a","b","c","d","byteLength","charAt","binaryToBase64","encodeURIComponent","xhr","responseType","httpHandler","String","fromCharCode","Uint8Array","trim","ArrayBuffer","f","g","h","buffer","base64ToBinary","parseLicenseResponse","getEmeOptionsFromEntitlement","playOption","checkSelectedTracks","skipIntroComponent","tempTime","ceil","skipIntroConfig","getSkipIntroConfig","currentSource","addRemoteTextTrack","audioTrackList","setDefaultAudioTrack","setDefaultTextTrack","metadataLoaded","getCastSender","selectedAudioTrack","selectedTextTrack","selectedResolution","videoWidth","videoHeight","trackLocale","currentSources","remoteConfig","EmbedPlayer","properties","apiBaseUrl","videoPlayer","initVideoPlayer","setVideoPlayerPoster","setVideoPlayerPosterFromArticle","posterSize","fileData","size","width","height","getResizedUrl","getArticleBackgroundImage","playVideo","getVideoPlayer","appendChromecastButton","castButtonContaner","castButton","ChromecastControls","playerController","totalDuration","currentStatus","createChromecastControlsTemplate","setPlayButtonClass","bindEventsToControls","setProgressBarValues","rootElement","renderTracks","checkChromecastContainerVisibility","HTMLElement","insertAdjacentHTML","playAndPauseButton","getElement","classList","playPause","bindEventsToMenu","target","buttonSelector","containerEl","buttonEl","menuEl","defaultPrevented","toggleMenu","add","remove","sessionMediaInfo","trackButton","audioButton","audioTracksContainerElement","textTracksContainerElement","getTracksList","tracksListElement","setActiveTrack","listItemElement","getTransformedDurationValue","hours","minutes","seconds","round","result","currentTimeElement","totalTimeElement","progressBarElement","progressLeftEl","max","style","offsetWidth","HTMLLIElement","nodeName","preventDefault","stopPropagation","contains","removeAttribute","focus"],"sourceRoot":""}