{"version":3,"file":"bundle.js","mappings":"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K,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,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","sources":["webpack://audienceplayer-embed-player/webpack/bootstrap","webpack://audienceplayer-embed-player/./src/models/player.ts","webpack://audienceplayer-embed-player/webpack/runtime/define property getters","webpack://audienceplayer-embed-player/webpack/runtime/hasOwnProperty shorthand","webpack://audienceplayer-embed-player/./src/logging/player-log-processor.ts","webpack://audienceplayer-embed-player/./src/logging/player-logger-service.ts","webpack://audienceplayer-embed-player/./src/video-player/plugins/playback-rate-button.ts","webpack://audienceplayer-embed-player/./src/video-player/plugins/audio-track-button.ts","webpack://audienceplayer-embed-player/./src/utils/locale.ts","webpack://audienceplayer-embed-player/./src/video-player/video-player.ts","webpack://audienceplayer-embed-player/./src/utils/platform.ts","webpack://audienceplayer-embed-player/./src/utils/eme.ts","webpack://audienceplayer-embed-player/./src/models/play-config.ts","webpack://audienceplayer-embed-player/./src/api/converters.ts","webpack://audienceplayer-embed-player/./src/chromecast/chromecast-sender.ts","webpack://audienceplayer-embed-player/./src/api/graph-request.ts","webpack://audienceplayer-embed-player/./src/api/api-service.ts","webpack://audienceplayer-embed-player/./src/api/queries.ts","webpack://audienceplayer-embed-player/./src/embed-player.ts","webpack://audienceplayer-embed-player/./src/chromecast/chromecast-controls.ts"],"sourcesContent":["// The require scope\nvar __webpack_require__ = {};\n\n","export var PlayingState;\n(function (PlayingState) {\n    PlayingState[PlayingState[\"loading\"] = 0] = \"loading\";\n    PlayingState[PlayingState[\"playing\"] = 1] = \"playing\";\n    PlayingState[PlayingState[\"paused\"] = 2] = \"paused\";\n    PlayingState[PlayingState[\"idle\"] = 3] = \"idle\";\n    PlayingState[PlayingState[\"buffering\"] = 4] = \"buffering\";\n    PlayingState[PlayingState[\"error\"] = 5] = \"error\";\n})(PlayingState || (PlayingState = {}));\nexport class PlayerLogPayload {\n}\n// generic abstraction of player events that are taken from the video player, Chromecast and mobile implementations\nexport var PlayerEventTypes;\n(function (PlayerEventTypes) {\n    PlayerEventTypes[\"playStart\"] = \"playStart\";\n    PlayerEventTypes[\"playing\"] = \"playing\";\n    PlayerEventTypes[\"pause\"] = \"pause\";\n    PlayerEventTypes[\"error\"] = \"error\";\n    PlayerEventTypes[\"stopped\"] = \"stopped\";\n    PlayerEventTypes[\"timeupdate\"] = \"timeupdate\";\n    PlayerEventTypes[\"textTrackChanged\"] = \"textTrackChanged\";\n    PlayerEventTypes[\"audioTrackChanged\"] = \"audioTrackChanged\";\n})(PlayerEventTypes || (PlayerEventTypes = {}));\nexport var PlayerDeviceTypes;\n(function (PlayerDeviceTypes) {\n    PlayerDeviceTypes[\"chromecast\"] = \"chromecast\";\n    PlayerDeviceTypes[\"default\"] = \"\";\n})(PlayerDeviceTypes || (PlayerDeviceTypes = {}));\nexport var PlayerEventTypePayloads;\n(function (PlayerEventTypePayloads) {\n    PlayerEventTypePayloads[\"play\"] = \"play\";\n    PlayerEventTypePayloads[\"playing\"] = \"playing\";\n    PlayerEventTypePayloads[\"paused\"] = \"paused\";\n    PlayerEventTypePayloads[\"stop\"] = \"stop\";\n    PlayerEventTypePayloads[\"error\"] = \"error\";\n    PlayerEventTypePayloads[\"configure\"] = \"configure\";\n})(PlayerEventTypePayloads || (PlayerEventTypePayloads = {}));\nexport var PulseMode;\n(function (PulseMode) {\n    PulseMode[\"live\"] = \"live\";\n    PulseMode[\"archive\"] = \"archive\";\n    PulseMode[\"offline\"] = \"offline\";\n})(PulseMode || (PulseMode = {}));\n","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","import { PlayerEventTypePayloads, PlayerEventTypes, PlayingState, PulseMode, } from '../models/player';\nconst MAX_EVENTS = 30;\nexport class PlayerLogProcessor {\n    constructor(baseUrl, projectId) {\n        this.playLogs = [];\n        this.apiCallInProgress = false;\n        this.intervalHandle = null;\n        this.apiUrl = `${baseUrl}/service/${projectId}/analytics/stream/pulse/log`.replace(/\\/*$/, '');\n    }\n    init() {\n        if (this.intervalHandle === null) {\n            this.intervalHandle = setInterval(() => {\n                this.processFirstPlayLog();\n            }, 3000);\n        }\n    }\n    destroy() {\n        if (this.intervalHandle) {\n            clearInterval(this.intervalHandle);\n        }\n    }\n    processPlaySession(playSession, timeStamp) {\n        if (!playSession) {\n            return;\n        }\n        const eventStack = playSession.eventStack;\n        if (eventStack.length === 0) {\n            return;\n        }\n        const eventStackPayload = [];\n        let i = 0, sumDelta = 0, lastEventWasProcessed = false;\n        while (i < eventStack.length) {\n            const currentEvent = eventStack[i];\n            if (this.isEventTypeWithoutTimeDelta(currentEvent.eventType)) {\n                // directly process these events. they have no sumDelta and do not affect the play state\n                eventStackPayload.push(this.convertEventToEventPayload(currentEvent));\n                lastEventWasProcessed = true;\n            }\n            else {\n                lastEventWasProcessed = false;\n                if (i - 1 >= 0) {\n                    const previousEvent = eventStack[i - 1];\n                    sumDelta += currentEvent.timeStamp - previousEvent.timeStamp;\n                    if (currentEvent.state !== previousEvent.state) {\n                        eventStackPayload.push(this.createDeltaEventPayload(previousEvent, previousEvent.timeStamp, sumDelta));\n                        sumDelta = 0;\n                    }\n                }\n            }\n            i++;\n        }\n        const lastEvent = eventStack[eventStack.length - 1];\n        if (sumDelta > 0 || !lastEventWasProcessed) {\n            eventStackPayload.push(this.createDeltaEventPayload(lastEvent, timeStamp, sumDelta));\n        }\n        if (eventStackPayload.length > 0) {\n            if (eventStackPayload.length > MAX_EVENTS) {\n                // if event stack too big, add error with runaway info and slice nr of items\n                const lastLogEvent = eventStackPayload[eventStackPayload.length - 1];\n                eventStackPayload.splice(MAX_EVENTS - 1);\n                lastLogEvent.event_type = PlayerEventTypePayloads.error;\n                lastLogEvent.event_payload = '{code: 429, message: \"Too many events\"}'; // runaway\n                eventStackPayload.push(lastLogEvent);\n            }\n            // check if there is already a log for this session\n            let playLogPayload = this.getPlayerLogPayloadWithPulseToken(playSession.pulseToken);\n            if (!playLogPayload) {\n                playLogPayload = {\n                    event_stack: [],\n                    pulse_token: playSession.pulseToken,\n                    pulse_mode: playSession.isLive ? PulseMode.live : PulseMode.offline,\n                    device_type: playSession.deviceType,\n                };\n                this.playLogs.push(playLogPayload);\n            }\n            // keep the event_stack pointer in tact by using push\n            eventStackPayload.forEach(e => playLogPayload.event_stack.push(e));\n            this.processPlayLog(playLogPayload, playSession);\n        }\n    }\n    processFirstPlayLog() {\n        if (this.playLogs.length > 0) {\n            this.processPlayLog(this.playLogs[0], null);\n        }\n    }\n    processPlayLog(currentLog, playSession) {\n        if (!currentLog || this.apiCallInProgress) {\n            return;\n        }\n        if (currentLog.event_stack.length === 0) {\n            this.removePlayLog(currentLog);\n            return;\n        }\n        const logToSend = {\n            ...currentLog,\n            event_stack: [],\n        };\n        let eventStackIndex = 0, isStopCutOff = false;\n        while (eventStackIndex < currentLog.event_stack.length && logToSend.event_stack.length < MAX_EVENTS && !isStopCutOff) {\n            const currentEvent = currentLog.event_stack[eventStackIndex];\n            eventStackIndex++;\n            logToSend.event_stack.push(currentEvent);\n            if (currentEvent.event_type === PlayerEventTypePayloads.stop) {\n                isStopCutOff = true;\n            }\n        }\n        // for offline logging, always accumulate until MAX_EVENTS before sending unless it's a stop cut off.\n        if (logToSend.pulse_mode === PulseMode.offline && logToSend.event_stack.length < MAX_EVENTS && !isStopCutOff) {\n            return;\n        }\n        // transaction start\n        this.apiCallInProgress = true;\n        return fetch(this.apiUrl, {\n            method: 'POST',\n            headers: {\n                'Content-Type': 'application/json',\n                Accept: 'application/json',\n            },\n            body: JSON.stringify(logToSend),\n        })\n            .then(() => {\n            return true;\n        })\n            .catch(error => {\n            return error.status !== 0;\n        })\n            .then(response => {\n            if (response) {\n                currentLog.event_stack.splice(0, eventStackIndex);\n                if (currentLog.event_stack.length === 0) {\n                    this.removePlayLog(currentLog);\n                }\n            }\n            else {\n                currentLog.pulse_mode = PulseMode.archive;\n            }\n            this.apiCallInProgress = false;\n        });\n    }\n    getPlayerLogPayloadWithPulseToken(pulseToken) {\n        return this.playLogs.find(log => log.pulse_token === pulseToken);\n    }\n    removePlayLog(logPayload) {\n        const index = this.playLogs.findIndex(log => log.pulse_token === logPayload.pulse_token);\n        if (index >= 0) {\n            this.playLogs.splice(index, 1);\n        }\n    }\n    isEventTypeWithoutTimeDelta(eventType) {\n        return [PlayerEventTypes.textTrackChanged, PlayerEventTypes.audioTrackChanged, PlayerEventTypes.playStart].indexOf(eventType) >= 0;\n    }\n    createBaseEventPayload(playerEvent, eventType) {\n        return {\n            timestamp: playerEvent.timeStamp,\n            event_type: eventType,\n            appa: playerEvent.playPosition,\n            appr: Math.min(playerEvent.playPosition / playerEvent.mediaDuration, 1),\n        };\n    }\n    convertEventToEventPayload(playerEvent) {\n        if (playerEvent.eventType === PlayerEventTypes.playStart) {\n            return {\n                timestamp: playerEvent.timeStamp,\n                event_type: PlayerEventTypePayloads.play,\n            };\n        }\n        const eventType = this.convertEventTypeToEventTypePayload(playerEvent);\n        const baseEvent = this.createBaseEventPayload(playerEvent, eventType);\n        switch (playerEvent.eventType) {\n            case PlayerEventTypes.audioTrackChanged:\n                return {\n                    ...baseEvent,\n                    audio_locale: playerEvent.audioTrack,\n                };\n            case PlayerEventTypes.textTrackChanged:\n                return {\n                    ...baseEvent,\n                    subtitle_locale: playerEvent.textTrack,\n                };\n            default:\n                return baseEvent;\n        }\n    }\n    createDeltaEventPayload(playerEvent, timestamp, timeDelta) {\n        const eventType = this.getEventTypePayloadFromEventState(playerEvent);\n        const baseEvent = this.createBaseEventPayload(playerEvent, eventType);\n        const errorPart = playerEvent.state === PlayingState.error ? { event_payload: playerEvent.error } : {};\n        return {\n            ...baseEvent,\n            ...errorPart,\n            timestamp,\n            time_delta: timeDelta / 1000,\n        };\n    }\n    getEventTypePayloadFromEventState(playerEvent) {\n        switch (playerEvent.state) {\n            case PlayingState.playing:\n                return PlayerEventTypePayloads.playing;\n            case PlayingState.paused:\n                return PlayerEventTypePayloads.paused;\n            case PlayingState.error:\n                return PlayerEventTypePayloads.error;\n            case PlayingState.buffering:\n            case PlayingState.loading:\n                return PlayerEventTypePayloads.paused; // buffering and loading converted to paused for API\n            case PlayingState.idle:\n                return PlayerEventTypePayloads.stop;\n        }\n    }\n    convertEventTypeToEventTypePayload(playerEvent) {\n        switch (playerEvent.eventType) {\n            case PlayerEventTypes.playStart:\n                return PlayerEventTypePayloads.play;\n            case PlayerEventTypes.audioTrackChanged:\n            case PlayerEventTypes.textTrackChanged:\n                return PlayerEventTypePayloads.configure;\n            // because e.g. `timeupdate` events can happen while paused / playing, base the rest on state.\n            default: {\n                this.getEventTypePayloadFromEventState(playerEvent);\n            }\n        }\n    }\n}\n","import { PlayerLogProcessor } from './player-log-processor';\nimport { PlayerEventTypes, PlayingState } from '../models/player';\nexport class PlayerLoggerService {\n    constructor(baseUrl, projectId) {\n        this.intervalHandle = 0;\n        this.playerLogProcessor = new PlayerLogProcessor(baseUrl, projectId);\n        this.reset();\n    }\n    init() {\n        this.playerLogProcessor.init();\n    }\n    destroy() {\n        this.playerLogProcessor.destroy();\n    }\n    onStart(pulseToken, deviceType, localTimeDelta, isLive, onStopCallback) {\n        this.reset();\n        this.playSession = {\n            pulseToken,\n            deviceType,\n            eventStack: [],\n            localTimeDelta,\n            isLive,\n            onStopCallback,\n        };\n    }\n    onCurrentTimeUpdated(currentTime) {\n        this.playerProperties.playPosition = currentTime;\n        if (this.playerProperties.mediaDuration > 0 && this.playerProperties.state !== PlayingState.idle) {\n            this.logEvent(PlayerEventTypes.timeupdate);\n        }\n    }\n    onDurationUpdated(duration) {\n        this.playerProperties.mediaDuration = duration;\n    }\n    onPlaying() {\n        if (this.playerProperties.state !== PlayingState.playing) {\n            if (this.playerProperties.state === PlayingState.idle) {\n                this.playerProperties.state = PlayingState.playing;\n                this.logEvent(PlayerEventTypes.playStart);\n                this.processPlaySession();\n                this.startInterval();\n            }\n            else {\n                this.playerProperties.state = PlayingState.playing;\n                this.logEvent(PlayerEventTypes.playing);\n            }\n        }\n    }\n    onPause() {\n        if (this.playerProperties.state !== PlayingState.paused) {\n            this.playerProperties.state = PlayingState.paused;\n            this.logEvent(PlayerEventTypes.pause);\n        }\n    }\n    onError(error) {\n        if (this.playerProperties.state !== PlayingState.error) {\n            this.playerProperties.state = PlayingState.error;\n            this.playerProperties.error = error;\n            this.logEvent(PlayerEventTypes.error);\n        }\n    }\n    onStop() {\n        if (this.playerProperties.state !== PlayingState.idle) {\n            this.playerProperties.state = PlayingState.idle;\n            this.logEvent(PlayerEventTypes.stopped);\n            this.stopInterval();\n            this.processPlaySession();\n        }\n    }\n    onTextTrackChanged(textTrack) {\n        if (this.playerProperties.state === PlayingState.idle) {\n            return;\n        }\n        this.playerProperties.textTrack = textTrack;\n        this.logEvent(PlayerEventTypes.textTrackChanged);\n    }\n    onAudioTrackChanged(audioTrack) {\n        if (this.playerProperties.state === PlayingState.idle) {\n            return;\n        }\n        this.playerProperties.audioTrack = audioTrack;\n        this.logEvent(PlayerEventTypes.audioTrackChanged);\n    }\n    updateProperties(playerProperties) {\n        this.playerProperties = {\n            ...this.playerProperties,\n            ...playerProperties,\n        };\n    }\n    startInterval() {\n        this.stopInterval();\n        // @ts-ignore\n        this.intervalHandle = setInterval(() => {\n            this.processPlaySession();\n        }, 30000);\n    }\n    stopInterval() {\n        if (this.intervalHandle) {\n            clearInterval(this.intervalHandle);\n        }\n    }\n    processPlaySession() {\n        this.playerLogProcessor.processPlaySession({ ...this.playSession }, this.getTimeStamp());\n        this.playSession.eventStack = [];\n    }\n    logEvent(eventType) {\n        if (this.playSession) {\n            this.playSession.eventStack.push({\n                ...this.playerProperties,\n                eventType,\n                timeStamp: this.getTimeStamp(),\n            });\n        }\n    }\n    reset() {\n        this.playSession = null;\n        this.playerProperties = {\n            state: PlayingState.idle,\n            error: null,\n            mediaDuration: 0,\n            playPosition: 0,\n            audioTrack: null,\n            textTrack: null,\n        };\n    }\n    getTimeStamp() {\n        return Date.now() - (this.playSession ? this.playSession.localTimeDelta : 0);\n    }\n}\n","const PlaybackRateMenuButton = videojs.getComponent('playbackRateMenuButton');\nexport class CustomPlaybackRateMenuButton extends PlaybackRateMenuButton {\n    constructor(player, options) {\n        super(player);\n    }\n    createEl() {\n        const el = super.createEl();\n        el.innerHTML = `<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\" class=\"vjs-playback-rate-svg\">\n            <path d=\"M0 0h24v24H0z\" fill=\"none\"/>\n            <path class=\"vjs-custom-svg-color\" d=\"M20.38 8.57l-1.23 1.85a8 8 0 0 1-.22 7.58H5.07A8 8 0 0 1 15.58 6.85l1.85-1.23A10 10 0 0 0 3.35 19a2 2 0 0 0 1.72 1h13.85a2 2 0 0 0 1.74-1 10 10 0 0 0-.27-10.44zm-9.79 6.84a2 2 0 0 0 2.83 0l5.66-8.49-8.49 5.66a2 2 0 0 0 0 2.83z\"/></svg>`;\n        return el;\n    }\n}\n","import { getNativeLanguage } from '../../utils/locale';\nconst AudioTrackButton = videojs.getComponent('audioTrackButton');\nconst MenuItem = videojs.getComponent('menuItem');\n// based on AudioTrackMenuItem\nclass CustomAudioTrackMenuItem extends MenuItem {\n    constructor(player, options) {\n        const track = options.track;\n        const tracks = player.audioTracks();\n        // Modify options for parent MenuItem class's init.\n        options.label = getNativeLanguage(track.language || track.label) || 'Unknown';\n        options.selected = track.enabled;\n        super(player, options);\n        this.track = track;\n        this.addClass(`vjs-${track.kind}-menu-item`);\n        const changeHandler = (...args) => {\n            this.handleTracksChange.apply(this, args);\n        };\n        tracks.addEventListener('change', changeHandler);\n        this.on('dispose', () => {\n            tracks.removeEventListener('change', changeHandler);\n        });\n    }\n    createEl(type, props, attrs) {\n        const el = super.createEl(type, props, attrs);\n        const parentSpan = el.querySelector('.vjs-menu-item-text');\n        if (this.options_.track.kind === 'main-desc') {\n            parentSpan.appendChild(super.createEl('span', {\n                className: 'vjs-icon-placeholder',\n            }, {\n                'aria-hidden': true,\n            }));\n            parentSpan.appendChild(super.createEl('span', {\n                className: 'vjs-control-text',\n                textContent: ' ' + this.localize('Descriptions'),\n            }));\n        }\n        return el;\n    }\n    handleClick(event) {\n        super.handleClick(event);\n        // the audio track list will automatically toggle other tracks\n        // off for us.\n        this.track.enabled = true;\n        // when native audio tracks are used, we want to make sure that other tracks are turned off\n        if (this.player_.tech_.featuresNativeAudioTracks) {\n            const tracks = this.player_.audioTracks();\n            for (let i = 0; i < tracks.length; i++) {\n                const track = tracks[i];\n                // skip the current track since we enabled it above\n                if (track === this.track) {\n                    continue;\n                }\n                track.enabled = track === this.track;\n            }\n        }\n    }\n    handleTracksChange(event) {\n        this.selected(this.track.enabled);\n    }\n}\nexport class CustomAudioTrackButton extends AudioTrackButton {\n    constructor(player, options) {\n        super(player);\n    }\n    createItems(items = []) {\n        // if there's only one audio track, there no point in showing it\n        this.hideThreshold_ = 1;\n        const tracks = this.player_.audioTracks();\n        for (let i = 0; i < tracks.length; i++) {\n            const track = tracks[i];\n            items.push(new CustomAudioTrackMenuItem(this.player_, {\n                track,\n                // MenuItem is selectable\n                selectable: true,\n                // MenuItem is NOT multiSelectable (i.e. only one can be marked \"selected\" at a time)\n                multiSelectable: false,\n            }));\n        }\n        return items;\n    }\n}\n","// https://raw.githubusercontent.com/vtex/country-iso-3-to-2/master/index.js\nexport function getLocaleFromLanguage(countryCode) {\n    const countryISOMapping = {\n        AFG: 'AF',\n        ALA: 'AX',\n        ALB: 'AL',\n        DZA: 'DZ',\n        ASM: 'AS',\n        AND: 'AD',\n        AGO: 'AO',\n        AIA: 'AI',\n        ATA: 'AQ',\n        ATG: 'AG',\n        ARG: 'AR',\n        ARM: 'AM',\n        ABW: 'AW',\n        AUS: 'AU',\n        AUT: 'AT',\n        AZE: 'AZ',\n        BHS: 'BS',\n        BHR: 'BH',\n        BGD: 'BD',\n        BRB: 'BB',\n        BLR: 'BY',\n        BEL: 'BE',\n        BLZ: 'BZ',\n        BEN: 'BJ',\n        BMU: 'BM',\n        BTN: 'BT',\n        BOL: 'BO',\n        BES: 'BQ',\n        BIH: 'BA',\n        BWA: 'BW',\n        BVT: 'BV',\n        BRA: 'BR',\n        VGB: 'VG',\n        IOT: 'IO',\n        BRN: 'BN',\n        BGR: 'BG',\n        BFA: 'BF',\n        BDI: 'BI',\n        KHM: 'KH',\n        CMR: 'CM',\n        CAN: 'CA',\n        CPV: 'CV',\n        CYM: 'KY',\n        CAF: 'CF',\n        TCD: 'TD',\n        CHL: 'CL',\n        CHN: 'CN',\n        HKG: 'HK',\n        MAC: 'MO',\n        CXR: 'CX',\n        CCK: 'CC',\n        COL: 'CO',\n        COM: 'KM',\n        COG: 'CG',\n        COD: 'CD',\n        COK: 'CK',\n        CRI: 'CR',\n        CIV: 'CI',\n        HRV: 'HR',\n        CUB: 'CU',\n        CUW: 'CW',\n        CYP: 'CY',\n        CZE: 'CZ',\n        DNK: 'DK',\n        DJI: 'DJ',\n        DMA: 'DM',\n        DOM: 'DO',\n        ECU: 'EC',\n        EGY: 'EG',\n        SLV: 'SV',\n        GNQ: 'GQ',\n        ERI: 'ER',\n        EST: 'EE',\n        ETH: 'ET',\n        FLK: 'FK',\n        FRO: 'FO',\n        FJI: 'FJ',\n        FIN: 'FI',\n        FRA: 'FR',\n        GUF: 'GF',\n        PYF: 'PF',\n        ATF: 'TF',\n        GAB: 'GA',\n        GMB: 'GM',\n        GEO: 'GE',\n        DEU: 'DE',\n        GHA: 'GH',\n        GIB: 'GI',\n        GRC: 'GR',\n        GRL: 'GL',\n        GRD: 'GD',\n        GLP: 'GP',\n        GUM: 'GU',\n        GTM: 'GT',\n        GGY: 'GG',\n        GIN: 'GN',\n        GNB: 'GW',\n        GUY: 'GY',\n        HTI: 'HT',\n        HMD: 'HM',\n        VAT: 'VA',\n        HND: 'HN',\n        HUN: 'HU',\n        ISL: 'IS',\n        IND: 'IN',\n        IDN: 'ID',\n        IRN: 'IR',\n        IRQ: 'IQ',\n        IRL: 'IE',\n        IMN: 'IM',\n        ISR: 'IL',\n        ITA: 'IT',\n        JAM: 'JM',\n        JPN: 'JP',\n        JEY: 'JE',\n        JOR: 'JO',\n        KAZ: 'KZ',\n        KEN: 'KE',\n        KIR: 'KI',\n        PRK: 'KP',\n        KOR: 'KR',\n        KWT: 'KW',\n        KGZ: 'KG',\n        LAO: 'LA',\n        LVA: 'LV',\n        LBN: 'LB',\n        LSO: 'LS',\n        LBR: 'LR',\n        LBY: 'LY',\n        LIE: 'LI',\n        LTU: 'LT',\n        LUX: 'LU',\n        MKD: 'MK',\n        MDG: 'MG',\n        MWI: 'MW',\n        MYS: 'MY',\n        MDV: 'MV',\n        MLI: 'ML',\n        MLT: 'MT',\n        MHL: 'MH',\n        MTQ: 'MQ',\n        MRT: 'MR',\n        MUS: 'MU',\n        MYT: 'YT',\n        MEX: 'MX',\n        FSM: 'FM',\n        MDA: 'MD',\n        MCO: 'MC',\n        MNG: 'MN',\n        MNE: 'ME',\n        MSR: 'MS',\n        MAR: 'MA',\n        MOZ: 'MZ',\n        MMR: 'MM',\n        NAM: 'NA',\n        NRU: 'NR',\n        NPL: 'NP',\n        NLD: 'NL',\n        ANT: 'AN',\n        NCL: 'NC',\n        NZL: 'NZ',\n        NIC: 'NI',\n        NER: 'NE',\n        NGA: 'NG',\n        NIU: 'NU',\n        NFK: 'NF',\n        MNP: 'MP',\n        NOR: 'NO',\n        OMN: 'OM',\n        PAK: 'PK',\n        PLW: 'PW',\n        PSE: 'PS',\n        PAN: 'PA',\n        PNG: 'PG',\n        PRY: 'PY',\n        PER: 'PE',\n        PHL: 'PH',\n        PCN: 'PN',\n        POL: 'PL',\n        PRT: 'PT',\n        PRI: 'PR',\n        QAT: 'QA',\n        REU: 'RE',\n        ROU: 'RO',\n        RUS: 'RU',\n        RWA: 'RW',\n        BLM: 'BL',\n        SHN: 'SH',\n        KNA: 'KN',\n        LCA: 'LC',\n        MAF: 'MF',\n        SPM: 'PM',\n        VCT: 'VC',\n        WSM: 'WS',\n        SMR: 'SM',\n        STP: 'ST',\n        SAU: 'SA',\n        SEN: 'SN',\n        SRB: 'RS',\n        SYC: 'SC',\n        SLE: 'SL',\n        SGP: 'SG',\n        SXM: 'SX',\n        SVK: 'SK',\n        SVN: 'SI',\n        SLB: 'SB',\n        SOM: 'SO',\n        ZAF: 'ZA',\n        SGS: 'GS',\n        SSD: 'SS',\n        ESP: 'ES',\n        LKA: 'LK',\n        SDN: 'SD',\n        SUR: 'SR',\n        SJM: 'SJ',\n        SWZ: 'SZ',\n        SWE: 'SE',\n        CHE: 'CH',\n        SYR: 'SY',\n        TWN: 'TW',\n        TJK: 'TJ',\n        TZA: 'TZ',\n        THA: 'TH',\n        TLS: 'TL',\n        TGO: 'TG',\n        TKL: 'TK',\n        TON: 'TO',\n        TTO: 'TT',\n        TUN: 'TN',\n        TUR: 'TR',\n        TKM: 'TM',\n        TCA: 'TC',\n        TUV: 'TV',\n        UGA: 'UG',\n        UKR: 'UA',\n        ARE: 'AE',\n        GBR: 'GB',\n        USA: 'US',\n        UMI: 'UM',\n        URY: 'UY',\n        UZB: 'UZ',\n        VUT: 'VU',\n        VEN: 'VE',\n        VNM: 'VN',\n        VIR: 'VI',\n        WLF: 'WF',\n        ESH: 'EH',\n        YEM: 'YE',\n        ZMB: 'ZM',\n        ZWE: 'ZW',\n        XKX: 'XK',\n    };\n    if (countryCode && countryCode.length === 3) {\n        countryCode = countryCode.toUpperCase();\n        if (countryISOMapping[countryCode]) {\n            return countryISOMapping[countryCode].toLowerCase();\n        }\n        return countryCode.substr(0, 2).toLowerCase();\n    }\n    return ('' + countryCode).toLowerCase();\n}\nexport function getNativeLanguage(lang) {\n    const locale = lang && lang.length === 3 ? getLocaleFromLanguage(lang) : lang;\n    const isoLocales = {\n        ab: {\n            name: 'Abkhaz',\n            nativeName: '',\n        },\n        aa: {\n            name: 'Afar',\n            nativeName: 'Afaraf',\n        },\n        af: {\n            name: 'Afrikaans',\n            nativeName: 'Afrikaans',\n        },\n        ak: {\n            name: 'Akan',\n            nativeName: 'Akan',\n        },\n        sq: {\n            name: 'Albanian',\n            nativeName: 'Shqip',\n        },\n        am: {\n            name: 'Amharic',\n            nativeName: '',\n        },\n        ar: {\n            name: 'Arabic',\n            nativeName: '',\n        },\n        an: {\n            name: 'Aragonese',\n            nativeName: 'Aragons',\n        },\n        hy: {\n            name: 'Armenian',\n            nativeName: '',\n        },\n        as: {\n            name: 'Assamese',\n            nativeName: '',\n        },\n        av: {\n            name: 'Avaric',\n            nativeName: ' ,  ',\n        },\n        ae: {\n            name: 'Avestan',\n            nativeName: 'avesta',\n        },\n        ay: {\n            name: 'Aymara',\n            nativeName: 'aymar aru',\n        },\n        az: {\n            name: 'Azerbaijani',\n            nativeName: 'azrbaycan dili',\n        },\n        bm: {\n            name: 'Bambara',\n            nativeName: 'bamanankan',\n        },\n        ba: {\n            name: 'Bashkir',\n            nativeName: ' ',\n        },\n        eu: {\n            name: 'Basque',\n            nativeName: 'euskara, euskera',\n        },\n        be: {\n            name: 'Belarusian',\n            nativeName: '',\n        },\n        bn: {\n            name: 'Bangla',\n            nativeName: '',\n        },\n        bh: {\n            name: 'Bihari',\n            nativeName: '',\n        },\n        bi: {\n            name: 'Bislama',\n            nativeName: 'Bislama',\n        },\n        bs: {\n            name: 'Bosnian',\n            nativeName: 'bosanski jezik',\n        },\n        br: {\n            name: 'Breton',\n            nativeName: 'brezhoneg',\n        },\n        bg: {\n            name: 'Bulgarian',\n            nativeName: ' ',\n        },\n        my: {\n            name: 'Burmese',\n            nativeName: '',\n        },\n        ca: {\n            name: 'Catalan; Valencian',\n            nativeName: 'Catal',\n        },\n        ch: {\n            name: 'Chamorro',\n            nativeName: 'Chamoru',\n        },\n        ce: {\n            name: 'Chechen',\n            nativeName: ' ',\n        },\n        ny: {\n            name: 'Chichewa; Chewa; Nyanja',\n            nativeName: 'chiChea, chinyanja',\n        },\n        zh: {\n            name: 'Chinese',\n            nativeName: ' (Zhngwn), , ',\n        },\n        cv: {\n            name: 'Chuvash',\n            nativeName: ' ',\n        },\n        kw: {\n            name: 'Cornish',\n            nativeName: 'Kernewek',\n        },\n        co: {\n            name: 'Corsican',\n            nativeName: 'corsu, lingua corsa',\n        },\n        cr: {\n            name: 'Cree',\n            nativeName: '',\n        },\n        hr: {\n            name: 'Croatian',\n            nativeName: 'hrvatski',\n        },\n        cs: {\n            name: 'Czech',\n            nativeName: 'etina',\n        },\n        da: {\n            name: 'Danish',\n            nativeName: 'dansk',\n        },\n        dv: {\n            name: 'Divehi; Dhivehi; Maldivian;',\n            nativeName: '',\n        },\n        nl: {\n            name: 'Dutch',\n            nativeName: 'Nederlands',\n        },\n        en: {\n            name: 'English',\n            nativeName: 'English',\n        },\n        eo: {\n            name: 'Esperanto',\n            nativeName: 'Esperanto',\n        },\n        et: {\n            name: 'Estonian',\n            nativeName: 'eesti',\n        },\n        ee: {\n            name: 'Ewe',\n            nativeName: 'Eegbe',\n        },\n        fo: {\n            name: 'Faroese',\n            nativeName: 'froyskt',\n        },\n        fj: {\n            name: 'Fijian',\n            nativeName: 'vosa Vakaviti',\n        },\n        fi: {\n            name: 'Finnish',\n            nativeName: 'suomi',\n        },\n        fr: {\n            name: 'French',\n            nativeName: 'franais',\n        },\n        ff: {\n            name: 'Fula; Fulah; Pulaar; Pular',\n            nativeName: 'Fulfulde, Pulaar, Pular',\n        },\n        gl: {\n            name: 'Galician',\n            nativeName: 'Galego',\n        },\n        ka: {\n            name: 'Georgian',\n            nativeName: '',\n        },\n        de: {\n            name: 'German',\n            nativeName: 'Deutsch',\n        },\n        el: {\n            name: 'Greek, Modern',\n            nativeName: '',\n        },\n        gn: {\n            name: 'Guaran',\n            nativeName: 'Avae',\n        },\n        gu: {\n            name: 'Gujarati',\n            nativeName: '',\n        },\n        ht: {\n            name: 'Haitian; Haitian Creole',\n            nativeName: 'Kreyl ayisyen',\n        },\n        ha: {\n            name: 'Hausa',\n            nativeName: 'Hausa, ',\n        },\n        he: {\n            name: 'Hebrew (modern)',\n            nativeName: '',\n        },\n        hz: {\n            name: 'Herero',\n            nativeName: 'Otjiherero',\n        },\n        hi: {\n            name: 'Hindi',\n            nativeName: ', ',\n        },\n        ho: {\n            name: 'Hiri Motu',\n            nativeName: 'Hiri Motu',\n        },\n        hu: {\n            name: 'Hungarian',\n            nativeName: 'Magyar',\n        },\n        ia: {\n            name: 'Interlingua',\n            nativeName: 'Interlingua',\n        },\n        id: {\n            name: 'Indonesian',\n            nativeName: 'Bahasa Indonesia',\n        },\n        ie: {\n            name: 'Interlingue',\n            nativeName: 'Interlingue',\n        },\n        ga: {\n            name: 'Irish',\n            nativeName: 'Gaeilge',\n        },\n        ig: {\n            name: 'Igbo',\n            nativeName: 'Ass Igbo',\n        },\n        ik: {\n            name: 'Inupiaq',\n            nativeName: 'Iupiaq',\n        },\n        io: {\n            name: 'Ido',\n            nativeName: 'Ido',\n        },\n        is: {\n            name: 'Icelandic',\n            nativeName: 'slenska',\n        },\n        it: {\n            name: 'Italian',\n            nativeName: 'Italiano',\n        },\n        iu: {\n            name: 'Inuktitut',\n            nativeName: '',\n        },\n        ja: {\n            name: 'Japanese',\n            nativeName: '',\n        },\n        jv: {\n            name: 'Javanese',\n            nativeName: 'basa Jawa',\n        },\n        kl: {\n            name: 'Kalaallisut, Greenlandic',\n            nativeName: 'kalaallisut, kalaallit oqaasii',\n        },\n        kn: {\n            name: 'Kannada',\n            nativeName: '',\n        },\n        kr: {\n            name: 'Kanuri',\n            nativeName: 'Kanuri',\n        },\n        ks: {\n            name: 'Kashmiri',\n            nativeName: ', ',\n        },\n        kk: {\n            name: 'Kazakh',\n            nativeName: ' ',\n        },\n        km: {\n            name: 'Khmer',\n            nativeName: '',\n        },\n        ki: {\n            name: 'Kikuyu, Gikuyu',\n            nativeName: 'Gky',\n        },\n        rw: {\n            name: 'Kinyarwanda',\n            nativeName: 'Ikinyarwanda',\n        },\n        ky: {\n            name: 'Kirghiz, Kyrgyz',\n            nativeName: ' ',\n        },\n        kv: {\n            name: 'Komi',\n            nativeName: ' ',\n        },\n        kg: {\n            name: 'Kongo',\n            nativeName: 'KiKongo',\n        },\n        ko: {\n            name: 'Korean',\n            nativeName: ' (),  ()',\n        },\n        ku: {\n            name: 'Kurdish',\n            nativeName: '',\n        },\n        kj: {\n            name: 'Kwanyama, Kuanyama',\n            nativeName: 'Kuanyama',\n        },\n        la: {\n            name: 'Latin',\n            nativeName: 'latine',\n        },\n        lb: {\n            name: 'Luxembourgish, Letzeburgesch',\n            nativeName: 'Ltzebuergesch',\n        },\n        lg: {\n            name: 'Luganda',\n            nativeName: 'Luganda',\n        },\n        li: {\n            name: 'Limburgish, Limburgan, Limburger',\n            nativeName: 'Limburgs',\n        },\n        ln: {\n            name: 'Lingala',\n            nativeName: 'Lingla',\n        },\n        lo: {\n            name: 'Lao',\n            nativeName: '',\n        },\n        lt: {\n            name: 'Lithuanian',\n            nativeName: 'lietuvi kalba',\n        },\n        lu: {\n            name: 'Luba-Katanga',\n            nativeName: 'Luba-Katanga',\n        },\n        lv: {\n            name: 'Latvian',\n            nativeName: 'latvieu valoda',\n        },\n        gv: {\n            name: 'Manx',\n            nativeName: 'Gaelg, Gailck',\n        },\n        mk: {\n            name: 'Macedonian',\n            nativeName: ' ',\n        },\n        mg: {\n            name: 'Malagasy',\n            nativeName: 'Malagasy fiteny',\n        },\n        ms: {\n            name: 'Malay',\n            nativeName: 'bahasa Melayu,  ',\n        },\n        ml: {\n            name: 'Malayalam',\n            nativeName: '',\n        },\n        mt: {\n            name: 'Maltese',\n            nativeName: 'Malti',\n        },\n        mi: {\n            name: 'Mori',\n            nativeName: 'te reo Mori',\n        },\n        mr: {\n            name: 'Marathi (Marh)',\n            nativeName: '',\n        },\n        mh: {\n            name: 'Marshallese',\n            nativeName: 'Kajin Maje',\n        },\n        mn: {\n            name: 'Mongolian',\n            nativeName: '',\n        },\n        na: {\n            name: 'Nauru',\n            nativeName: 'Ekakair Naoero',\n        },\n        nv: {\n            name: 'Navajo, Navaho',\n            nativeName: 'Din bizaad, Dinkeh',\n        },\n        nb: {\n            name: 'Norwegian Bokml',\n            nativeName: 'Norsk bokml',\n        },\n        nd: {\n            name: 'North Ndebele',\n            nativeName: 'isiNdebele',\n        },\n        ne: {\n            name: 'Nepali',\n            nativeName: '',\n        },\n        ng: {\n            name: 'Ndonga',\n            nativeName: 'Owambo',\n        },\n        nn: {\n            name: 'Norwegian Nynorsk',\n            nativeName: 'Norsk nynorsk',\n        },\n        no: {\n            name: 'Norwegian',\n            nativeName: 'Norsk',\n        },\n        ii: {\n            name: 'Nuosu',\n            nativeName: ' Nuosuhxop',\n        },\n        nr: {\n            name: 'South Ndebele',\n            nativeName: 'isiNdebele',\n        },\n        oc: {\n            name: 'Occitan',\n            nativeName: 'Occitan',\n        },\n        oj: {\n            name: 'Ojibwe, Ojibwa',\n            nativeName: '',\n        },\n        cu: {\n            name: 'Old Church Slavonic, Church Slavic, Church Slavonic, Old Bulgarian, Old Slavonic',\n            nativeName: ' ',\n        },\n        om: {\n            name: 'Oromo',\n            nativeName: 'Afaan Oromoo',\n        },\n        or: {\n            name: 'Odia',\n            nativeName: '',\n        },\n        os: {\n            name: 'Ossetian, Ossetic',\n            nativeName: ' ',\n        },\n        pa: {\n            name: 'Panjabi, Punjabi',\n            nativeName: ', ',\n        },\n        pi: {\n            name: 'Pli',\n            nativeName: '',\n        },\n        fa: {\n            name: 'Persian',\n            nativeName: '',\n        },\n        pl: {\n            name: 'Polish',\n            nativeName: 'polski',\n        },\n        ps: {\n            name: 'Pashto, Pushto',\n            nativeName: '',\n        },\n        pt: {\n            name: 'Portuguese',\n            nativeName: 'Portugus',\n        },\n        qu: {\n            name: 'Quechua',\n            nativeName: 'Runa Simi, Kichwa',\n        },\n        rm: {\n            name: 'Romansh',\n            nativeName: 'rumantsch grischun',\n        },\n        rn: {\n            name: 'Kirundi',\n            nativeName: 'kiRundi',\n        },\n        ro: {\n            name: 'Romanian, Moldovans, Moldovan',\n            nativeName: 'romn',\n        },\n        ru: {\n            name: 'Russian',\n            nativeName: '',\n        },\n        sa: {\n            name: 'Sanskrit (Saskta)',\n            nativeName: '',\n        },\n        sc: {\n            name: 'Sardinian',\n            nativeName: 'sardu',\n        },\n        sd: {\n            name: 'Sindhi',\n            nativeName: ',  ',\n        },\n        se: {\n            name: 'Northern Sami',\n            nativeName: 'Davvismegiella',\n        },\n        sm: {\n            name: 'Samoan',\n            nativeName: 'gagana faa Samoa',\n        },\n        sg: {\n            name: 'Sango',\n            nativeName: 'yng t sng',\n        },\n        sr: {\n            name: 'Serbian',\n            nativeName: ' ',\n        },\n        gd: {\n            name: 'Scottish Gaelic; Gaelic',\n            nativeName: 'Gidhlig',\n        },\n        sn: {\n            name: 'Shona',\n            nativeName: 'chiShona',\n        },\n        si: {\n            name: 'Sinhala, Sinhalese',\n            nativeName: '',\n        },\n        sk: {\n            name: 'Slovak',\n            nativeName: 'slovenina',\n        },\n        sl: {\n            name: 'Slovene',\n            nativeName: 'slovenina',\n        },\n        so: {\n            name: 'Somali',\n            nativeName: 'Soomaaliga, af Soomaali',\n        },\n        st: {\n            name: 'Southern Sotho',\n            nativeName: 'Sesotho',\n        },\n        es: {\n            name: 'Spanish',\n            nativeName: 'espaol',\n        },\n        su: {\n            name: 'Sundanese',\n            nativeName: 'Basa Sunda',\n        },\n        sw: {\n            name: 'Swahili',\n            nativeName: 'Kiswahili',\n        },\n        ss: {\n            name: 'Swati',\n            nativeName: 'SiSwati',\n        },\n        sv: {\n            name: 'Swedish',\n            nativeName: 'svenska',\n        },\n        ta: {\n            name: 'Tamil',\n            nativeName: '',\n        },\n        te: {\n            name: 'Telugu',\n            nativeName: '',\n        },\n        tg: {\n            name: 'Tajik',\n            nativeName: '',\n        },\n        th: {\n            name: 'Thai',\n            nativeName: '',\n        },\n        ti: {\n            name: 'Tigrinya',\n            nativeName: '',\n        },\n        bo: {\n            name: 'Tibetan Standard, Tibetan, Central',\n            nativeName: '',\n        },\n        tk: {\n            name: 'Turkmen',\n            nativeName: 'Trkmen',\n        },\n        tl: {\n            name: 'Tagalog',\n            nativeName: 'Wikang Tagalog',\n        },\n        tn: {\n            name: 'Tswana',\n            nativeName: 'Setswana',\n        },\n        to: {\n            name: 'Tonga (Tonga Islands)',\n            nativeName: 'faka Tonga',\n        },\n        tr: {\n            name: 'Turkish',\n            nativeName: 'Trke',\n        },\n        ts: {\n            name: 'Tsonga',\n            nativeName: 'Xitsonga',\n        },\n        tt: {\n            name: 'Tatar',\n            nativeName: '',\n        },\n        tw: {\n            name: 'Twi',\n            nativeName: 'Twi',\n        },\n        ty: {\n            name: 'Tahitian',\n            nativeName: 'Reo Tahiti',\n        },\n        ug: {\n            name: 'Uighur, Uyghur',\n            nativeName: '',\n        },\n        uk: {\n            name: 'Ukrainian',\n            nativeName: '',\n        },\n        ur: {\n            name: 'Urdu',\n            nativeName: '',\n        },\n        uz: {\n            name: 'Uzbek',\n            nativeName: 'zbek, , ',\n        },\n        ve: {\n            name: 'Venda',\n            nativeName: 'Tshivena',\n        },\n        vi: {\n            name: 'Vietnamese',\n            nativeName: 'Ting Vit',\n        },\n        vo: {\n            name: 'Volapk',\n            nativeName: 'Volapk',\n        },\n        wa: {\n            name: 'Walloon',\n            nativeName: 'Walon',\n        },\n        cy: {\n            name: 'Welsh',\n            nativeName: 'Cymraeg',\n        },\n        wo: {\n            name: 'Wolof',\n            nativeName: 'Wollof',\n        },\n        fy: {\n            name: 'Western Frisian',\n            nativeName: 'Frysk',\n        },\n        xh: {\n            name: 'Xhosa',\n            nativeName: 'isiXhosa',\n        },\n        yi: {\n            name: 'Yiddish',\n            nativeName: '',\n        },\n        yo: {\n            name: 'Yoruba',\n            nativeName: 'Yorb',\n        },\n        za: {\n            name: 'Zhuang, Chuang',\n            nativeName: 'Sa cue, Saw cuengh',\n        },\n        mis: {\n            name: 'uncoded languages',\n            nativeName: 'uncoded languages',\n        },\n        mul: {\n            name: 'multiple languages',\n            nativeName: 'multiple languages',\n        },\n        und: {\n            name: 'undetermined',\n            nativeName: 'undetermined',\n        },\n        zxx: {\n            name: 'no linguistic content/not applicable',\n            nativeName: 'no linguistic content/not applicable',\n        },\n    };\n    if (locale && isoLocales[locale]) {\n        return isoLocales[locale].nativeName;\n    }\n    return locale;\n}\n","import { supportsHLS } from '../utils/platform';\nimport { PlayerLoggerService } from '../logging/player-logger-service';\nimport { PlayerDeviceTypes } from '../models/player';\nimport { getEmeOptionsFromEntitlement } from '../utils/eme';\nimport { CustomPlaybackRateMenuButton } from './plugins/playback-rate-button';\nimport { CustomAudioTrackButton } from './plugins/audio-track-button';\nexport class VideoPlayer {\n    constructor(baseUrl, projectId) {\n        this.player = null;\n        this.playerLoggerService = new PlayerLoggerService(baseUrl, projectId);\n        videojs.registerComponent('customAudioTrackButton', CustomAudioTrackButton);\n        videojs.registerComponent('customPlaybackRateMenuButton', CustomPlaybackRateMenuButton);\n    }\n    init(initParams) {\n        this.destroy();\n        const videoContainer = initParams.selector instanceof Element ? initParams.selector : document.querySelector(initParams.selector);\n        if (!videoContainer) {\n            throw Error('Invalid selector or element for player');\n        }\n        this.playerLoggerService.init();\n        const videoElement = document.createElement('video');\n        videoElement.setAttribute('class', ['video-js', 'vjs-default-skin'].join(' '));\n        videoElement.setAttribute('tabIndex', '0');\n        videoElement.setAttribute('width', '100%');\n        videoElement.setAttribute('height', '100%');\n        videoContainer.appendChild(videoElement);\n        const playOptions = {\n            fluid: true,\n            responsive: true,\n            controls: true,\n            controlBar: {\n                pictureInPictureToggle: false,\n                currentTimeDisplay: true,\n                durationDisplay: true,\n                timeDivider: false,\n                skipButtons: {\n                    forward: 5,\n                },\n                volumePanel: {\n                    inline: false,\n                },\n                // order of elements:\n                children: [\n                    'playToggle',\n                    'currentTimeDisplay',\n                    //\"timeDivider\",\n                    'progressControl',\n                    'durationDisplay',\n                    'liveDisplay',\n                    //\"remainingTimeDisplay\",\n                    'customControlSpacer',\n                    'customPlaybackRateMenuButton',\n                    'chaptersButton',\n                    'descriptionsButton',\n                    'subtitlesButton',\n                    'captionsButton',\n                    'customAudioTrackButton',\n                    'volumePanel',\n                    'fullscreenToggle',\n                ],\n            },\n            aspectRatio: '16:9',\n            html5: {\n                vhs: {\n                    // do to use videojs-http-streaming\n                    overrideNative: false,\n                },\n            },\n            ...initParams.options,\n        };\n        this.player = videojs(videoElement, playOptions);\n        this.player.eme();\n        this.bindEvents();\n    }\n    play(playConfig, playParams) {\n        this.firstPlayingEvent = true;\n        if (!this.player || (this.player && this.player.currentSrc())) {\n            this.destroy();\n            this.init(playParams);\n        }\n        this.articlePlayConfig = playConfig;\n        this.playerLoggerService.onStart(playConfig.pulseToken, PlayerDeviceTypes.default, playConfig.localTimeDelta, true);\n        const hlsSources = playConfig.entitlements.filter(entitlement => entitlement.type === 'application/vnd.apple.mpegurl');\n        const configureHLSOnly = supportsHLS() && hlsSources.length > 0; // make sure there is actually HLS\n        const playSources = playConfig.entitlements\n            .map(entitlement => {\n            const emeOptions = getEmeOptionsFromEntitlement(entitlement);\n            return {\n                src: entitlement.src,\n                type: entitlement.type,\n                ...emeOptions,\n            };\n        })\n            .filter(playOption => {\n            return ((playOption.type === 'application/vnd.apple.mpegurl' && configureHLSOnly) ||\n                (playOption.type !== 'application/vnd.apple.mpegurl' && !configureHLSOnly));\n        });\n        this.player.aspectRatio(playConfig.aspectRatio);\n        this.player.src(playSources);\n        if (playParams.fullscreen) {\n            this.player.requestFullscreen();\n        }\n        if (!configureHLSOnly) {\n            // non HLS only needs the text tracks\n            playConfig.subtitles.forEach(track => {\n                this.player.addRemoteTextTrack({\n                    kind: track.kind,\n                    src: track.src,\n                    language: track.srclang,\n                    label: track.label,\n                    enabled: track.srclang === playConfig.subtitleLocale,\n                });\n            });\n        }\n    }\n    setPoster(posterUrl) {\n        this.player.poster(posterUrl);\n    }\n    destroy() {\n        if (this.player) {\n            if (false === this.player.ended()) {\n                this.player.pause();\n                // only if we have not already caught the 'ended' event\n                // Be aware that the `stopped` emit also send along all kinds of info, so call _before_ disposing player\n                this.playerLoggerService.onStop();\n            }\n            this.player.dispose();\n        }\n        this.playerLoggerService.destroy();\n        this.player = null;\n    }\n    getPlayer() {\n        return this.player;\n    }\n    bindEvents() {\n        this.player.on('error', () => {\n            this.playerLoggerService.onError(JSON.stringify(this.player.error()));\n        });\n        this.player.on('playing', () => {\n            if (this.firstPlayingEvent) {\n                this.firstPlayingEvent = false;\n                if (this.articlePlayConfig.currentTime > 0) {\n                    this.player.currentTime(this.articlePlayConfig.currentTime);\n                }\n            }\n            this.checkSelectedTracks();\n            this.playerLoggerService.onPlaying();\n        });\n        this.player.on('pause', () => {\n            this.checkSelectedTracks();\n            if (this.player.paused() && !this.player.ended()) {\n                this.playerLoggerService.onPause();\n            }\n        });\n        this.player.on('ended', () => {\n            this.checkSelectedTracks();\n            this.playerLoggerService.onStop();\n        });\n        this.player.on('timeupdate', () => {\n            this.checkSelectedTracks();\n            this.playerLoggerService.onCurrentTimeUpdated(this.player.currentTime() || 0);\n        });\n        this.player.on('durationchange', () => {\n            this.checkSelectedTracks();\n            this.playerLoggerService.onDurationUpdated(this.player.duration());\n        });\n        this.player.on('loadedmetadata', () => {\n            const audioTrackList = this.player.audioTracks();\n            if (audioTrackList && audioTrackList.length > 0) {\n                // set default tracks when available\n                this.setDefaultAudioTrack();\n                this.setDefaultTextTrack();\n                this.metadataLoaded = true;\n            }\n            else {\n                // unfortunately there is no reliable way to know when iOS native binding to text-tracks is done\n                // (even after first play event, this is not true), so we resort to an old fashioned timeout\n                setTimeout(() => {\n                    this.setDefaultAudioTrack();\n                    this.setDefaultTextTrack();\n                    this.metadataLoaded = true;\n                }, 1000);\n            }\n        });\n    }\n    checkSelectedTracks() {\n        if (!this.metadataLoaded) {\n            return false;\n        }\n        let selectedAudioTrack = '';\n        let selectedTextTrack = '';\n        const tracks = this.player.textTracks();\n        for (let i = 0; i < tracks.length; i++) {\n            if (tracks[i].mode === 'showing' && tracks[i].kind === 'subtitles') {\n                selectedTextTrack = tracks[i].language;\n            }\n        }\n        const audioTracks = this.player.audioTracks();\n        for (let i = 0; i < audioTracks.length; i++) {\n            if (audioTracks[i].enabled) {\n                selectedAudioTrack = audioTracks[i].language;\n                break;\n            }\n        }\n        this.playerLoggerService.updateProperties({\n            textTrack: selectedTextTrack,\n            audioTrack: selectedAudioTrack,\n        });\n        if (this.currentTextTrack !== null && this.currentTextTrack !== selectedTextTrack) {\n            this.playerLoggerService.onTextTrackChanged(selectedTextTrack);\n        }\n        this.currentTextTrack = selectedTextTrack;\n        if (this.currentAudioTrack !== null && this.currentAudioTrack !== selectedAudioTrack) {\n            this.playerLoggerService.onAudioTrackChanged(selectedAudioTrack);\n        }\n        this.currentAudioTrack = selectedAudioTrack;\n    }\n    setDefaultTextTrack() {\n        if (this.articlePlayConfig.subtitleLocale) {\n            const tracks = this.player.textTracks();\n            for (let i = 0; i < tracks.length; i++) {\n                // textTracks is not a real array so no iterators here\n                if (tracks[i].mode !== 'disabled') {\n                    tracks[i].mode = 'disabled';\n                }\n            }\n            // it must be split up in to two loops, because two 'showing' items will break\n            for (let i = 0; i < tracks.length; i++) {\n                if (tracks[i].language === this.articlePlayConfig.subtitleLocale.toLowerCase() && tracks[i].kind === 'subtitles') {\n                    tracks[i].mode = 'showing';\n                    break;\n                }\n            }\n        }\n    }\n    setDefaultAudioTrack() {\n        if (this.articlePlayConfig.audioLocale) {\n            const audioTracks = this.player.audioTracks();\n            for (let i = 0; i < audioTracks.length; i++) {\n                if ((this.articlePlayConfig.audioLocale && audioTracks[i].language === this.articlePlayConfig.audioLocale.toLowerCase()) ||\n                    (this.articlePlayConfig.audioLocale === '' && i === 0)) {\n                    audioTracks[i].enabled = true;\n                    break;\n                }\n            }\n        }\n    }\n}\n","export function supportsHLS() {\n    return videojs.browser.IS_SAFARI || videojs.browser.IS_IOS;\n}\n","export function getEmeOptionsFromEntitlement(entitlement) {\n    let protectionInfo = null;\n    let emeOptions = {};\n    if (entitlement.protectionInfo) {\n        switch (entitlement.type) {\n            case 'application/dash+xml':\n                protectionInfo = entitlement.protectionInfo.find(p => p.type === 'Widevine');\n                if (protectionInfo) {\n                    emeOptions = {\n                        keySystems: {\n                            'com.widevine.alpha': protectionInfo.keyDeliveryUrl,\n                        },\n                        emeHeaders: {\n                            Authorization: protectionInfo.authenticationToken,\n                        },\n                    };\n                }\n                break;\n            case 'application/vnd.ms-sstr+xml':\n                protectionInfo = entitlement.protectionInfo.find(p => p.type === 'PlayReady');\n                if (protectionInfo) {\n                    emeOptions = {\n                        keySystems: {\n                            'com.microsoft.playready': protectionInfo.keyDeliveryUrl,\n                        },\n                        emeHeaders: {\n                            Authorization: protectionInfo.authenticationToken,\n                        },\n                    };\n                }\n                break;\n            case 'application/vnd.apple.mpegurl':\n                protectionInfo = entitlement.protectionInfo.find(p => p.type === 'FairPlay');\n                if (protectionInfo) {\n                    emeOptions = {\n                        keySystems: {\n                            'com.apple.fps.1_0': {\n                                certificateUri: protectionInfo.certificateUrl,\n                                getContentId: function () {\n                                    return getHostnameFromUri(protectionInfo.keyDeliveryUrl);\n                                },\n                                getLicense: function (emeOptions, contentId, keyMessage, callback) {\n                                    const payload = 'spc=' + binaryToBase64(keyMessage) + '&assetId=' + encodeURIComponent(contentId);\n                                    videojs.xhr({\n                                        uri: protectionInfo.keyDeliveryUrl,\n                                        method: 'post',\n                                        headers: {\n                                            'Content-type': 'application/x-www-form-urlencoded',\n                                            Authorization: protectionInfo.authenticationToken,\n                                        },\n                                        body: payload,\n                                        responseType: 'arraybuffer',\n                                    }, videojs.xhr.httpHandler(function (err, response) {\n                                        callback(null, parseLicenseResponse(response));\n                                    }, true));\n                                },\n                            },\n                        },\n                    };\n                }\n                break;\n        }\n    }\n    return emeOptions;\n}\nexport function binaryToBase64(a) {\n    let b = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=', c = [];\n    for (let d = 0; d < a.byteLength;) {\n        let e = a[d++];\n        c.push(b.charAt(e >> 2)),\n            (e = (3 & e) << 4),\n            d < a.byteLength\n                ? (c.push(b.charAt(e | (a[d] >> 4))),\n                    (e = (15 & a[d++]) << 2),\n                    d < a.byteLength\n                        ? (c.push(b.charAt(e | (a[d] >> 6))), c.push(b.charAt(63 & a[d++])))\n                        : (c.push(b.charAt(e)), c.push('=')))\n                : (c.push(b.charAt(e)), c.push('=='));\n    }\n    return c.join('');\n}\nexport function base64ToBinary(a) {\n    let b = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=', c = new Uint8Array(new ArrayBuffer((3 * a.length) / 4 + 4)), e = 0;\n    for (let d = 0; d < a.length;) {\n        let f = b.indexOf(a.charAt(d)), g = b.indexOf(a.charAt(d + 1));\n        if (((c[e++] = (f << 2) | (g >> 4)), '=' !== a.charAt(d + 2))) {\n            let h = b.indexOf(a.charAt(d + 2));\n            if (((c[e++] = (g << 4) | (h >> 2)), '=' !== a.charAt(d + 3))) {\n                let i = b.indexOf(a.charAt(d + 3));\n                c[e++] = (h << 6) | i;\n            }\n        }\n        d += 4;\n    }\n    return new Uint8Array(c.buffer, 0, e);\n}\nexport function parseLicenseResponse(response) {\n    const responseBody = String.fromCharCode.apply(null, new Uint8Array(response));\n    let b = responseBody.trim(), c = b.indexOf('<ckc>'), d = b.indexOf('</ckc>');\n    if (-1 === c || -1 === d) {\n        throw Error('License data format not as expected, missing or misplaced <ckc> tag');\n    }\n    c += 5;\n    b = b.substr(c, d - c);\n    return base64ToBinary(b);\n}\nexport function getHostnameFromUri(uri) {\n    let link = document.createElement('a');\n    link.href = uri;\n    return link.hostname;\n}\n","export var ArticlePlayErrors;\n(function (ArticlePlayErrors) {\n    ArticlePlayErrors[\"noPlayableAsset\"] = \"noPlayableAsset\";\n    ArticlePlayErrors[\"notAuthenticated\"] = \"notAuthenticated\";\n    ArticlePlayErrors[\"needEntitlement\"] = \"needEntitlement\";\n    ArticlePlayErrors[\"serverError\"] = \"serverError\";\n    ArticlePlayErrors[\"offlineError\"] = \"offlineError\";\n    ArticlePlayErrors[\"maxConcurrentStreamNumberError\"] = \"maxConcurrentStreamNumberError\";\n})(ArticlePlayErrors || (ArticlePlayErrors = {}));\n","import { ArticlePlayErrors } from '../models/play-config';\nexport function toPlayConfig(config, continueFromPreviousPosition) {\n    const timeStamp = Date.parse(config.issued_at);\n    const entitlements = [];\n    // check if the entitlements contain FPS in order to know when to filter out aes\n    const filterAES = !!config.entitlements.find((entitlement) => entitlement.encryption_type === 'fps');\n    const configEntitlements = filterAES\n        ? config.entitlements.filter((entitlement) => {\n            return entitlement.encryption_type !== 'aes';\n        })\n        : config.entitlements;\n    const dashWidevine = configEntitlements.find((entitlement) => !!entitlement.token && entitlement.encryption_type === 'cenc' && entitlement.protocol.indexOf('dash') === 0);\n    const mssPlayReady = configEntitlements.find((entitlement) => !!entitlement.token && entitlement.encryption_type === 'cenc' && entitlement.protocol.indexOf('mss') === 0);\n    configEntitlements.forEach((configEntitlement) => {\n        const entitlement = {\n            src: configEntitlement.manifest,\n            type: configEntitlement.mime_type,\n            protectionInfo: null,\n        };\n        if (configEntitlement.token) {\n            entitlement.protectionInfo = [];\n            if (configEntitlement.encryption_type === 'cenc') {\n                if (!!dashWidevine) {\n                    entitlement.protectionInfo.push({\n                        type: 'Widevine',\n                        authenticationToken: 'Bearer ' + dashWidevine.token,\n                        keyDeliveryUrl: dashWidevine.key_delivery_url,\n                    });\n                }\n                if (!!mssPlayReady) {\n                    entitlement.protectionInfo.push({\n                        type: 'PlayReady',\n                        authenticationToken: 'Bearer=' + mssPlayReady.token,\n                        keyDeliveryUrl: mssPlayReady.key_delivery_url,\n                    });\n                }\n            }\n            else if (configEntitlement.encryption_type === 'fps') {\n                entitlement.protectionInfo = [\n                    {\n                        type: 'FairPlay',\n                        authenticationToken: 'Bearer ' + configEntitlement.token,\n                        certificateUrl: config.fairplay_certificate_url,\n                        keyDeliveryUrl: configEntitlement.key_delivery_url,\n                    },\n                ];\n            }\n        }\n        entitlements.push(entitlement);\n    });\n    const subtitles = config.subtitles.map((item) => ({\n        src: item.url,\n        srclang: item.locale,\n        kind: 'subtitles',\n        label: item.locale_label,\n    }));\n    return {\n        entitlements: entitlements,\n        subtitles: subtitles,\n        pulseToken: config.pulse_token,\n        currentTime: continueFromPreviousPosition ? config.appa : 0,\n        subtitleLocale: config.user_subtitle_locale,\n        audioLocale: config.user_audio_locale,\n        localTimeDelta: isNaN(timeStamp) ? 0 : Date.now() - timeStamp,\n        aspectRatio: config.aspect_ratio.replace('x', ':'),\n    };\n}\nexport function toArticle(article) {\n    return {\n        name: article.name,\n        metas: article.metas,\n        posters: article.posters.map(toFile),\n        images: article.images.map(toFile),\n    };\n}\nexport function toFile(file) {\n    return {\n        type: file.type,\n        url: file.url,\n        baseUrl: file.base_url,\n        fileName: file.file_name,\n    };\n}\nexport function getMetaValue(metas, key) {\n    const meta = metas.find((m) => m.key === key);\n    return meta ? meta.value : '';\n}\nexport function getResizedUrl(fileData, size) {\n    if (fileData) {\n        const { width, height } = size;\n        return `${fileData.baseUrl}/${width}x${height}/${fileData.fileName}`;\n    }\n    return '';\n}\nexport function getArticleTitle(article) {\n    return getMetaValue(article.metas, 'title') || article.name;\n}\nexport function getArticleBackgroundImage(article) {\n    if (article.posters.length > 0) {\n        return article.posters[0];\n    }\n    if (this.article.length > 0) {\n        return article.images[0];\n    }\n    return null;\n}\nexport function toPlayConfigError(code) {\n    switch (code) {\n        case 0:\n            return ArticlePlayErrors.offlineError;\n        case 401:\n            return ArticlePlayErrors.notAuthenticated;\n        case 402:\n            return ArticlePlayErrors.needEntitlement;\n        case 403:\n            return ArticlePlayErrors.notAuthenticated;\n        case 404:\n            return ArticlePlayErrors.noPlayableAsset;\n        case 429:\n            return ArticlePlayErrors.maxConcurrentStreamNumberError;\n        default:\n            return ArticlePlayErrors.serverError;\n    }\n}\n","/// <reference path=\"../../node_modules/@types/chromecast-caf-sender/index.d.ts\" />\nimport { getArticleTitle } from '../api/converters';\nexport class ChromecastSender {\n    constructor() {\n        this.castContext = null;\n        this.castPlayer = null;\n        this.castPlayerController = null;\n    }\n    init(chromecastReceiverAppId) {\n        return new Promise((resolve, reject) => {\n            if (chromecastReceiverAppId) {\n                window['__onGCastApiAvailable'] = (isAvailable) => {\n                    if (isAvailable && cast && cast.framework) {\n                        this.initializeCastApi(chromecastReceiverAppId);\n                        //Some Chromecast configurations are taking some time to initialize\n                        setTimeout(() => {\n                            resolve();\n                        }, 1000);\n                    }\n                };\n                const scriptElement = document.createElement('script');\n                scriptElement.src = 'https://www.gstatic.com/cv/js/sender/v1/cast_sender.js?loadCastFramework=1';\n                document.head.appendChild(scriptElement);\n            }\n            else {\n                reject('Chromecast Receiver Application Id is missing');\n            }\n        });\n    }\n    initializeCastApi(chromecastReceiverAppId) {\n        cast.framework.CastContext.getInstance().setOptions({\n            receiverApplicationId: chromecastReceiverAppId,\n            autoJoinPolicy: chrome.cast.AutoJoinPolicy.ORIGIN_SCOPED,\n        });\n        this.castContext = cast.framework.CastContext.getInstance();\n        this.castPlayer = new cast.framework.RemotePlayer();\n        this.castPlayerController = new cast.framework.RemotePlayerController(this.castPlayer);\n    }\n    getCastMediaInfo(articlePlayConfig, article) {\n        if (articlePlayConfig && articlePlayConfig.entitlements && articlePlayConfig.entitlements.length > 0) {\n            const tracks = articlePlayConfig.subtitles.map((option, index) => {\n                const trackId = index + 1;\n                const castTrack = new chrome.cast.media.Track(trackId, chrome.cast.media.TrackType.TEXT);\n                castTrack.trackContentId = option.src;\n                castTrack.trackContentType = 'text/vtt';\n                castTrack.subtype = chrome.cast.media.TextTrackType.SUBTITLES;\n                castTrack.name = option.label;\n                castTrack.language = option.srclang;\n                castTrack.customData = null;\n                return castTrack;\n            });\n            let contentType = null;\n            const supportedContentTypes = ['application/vnd.ms-sstr+xml', 'video/mp4'];\n            const entitlement = articlePlayConfig.entitlements.find(item => {\n                if (supportedContentTypes.includes(item.type)) {\n                    contentType = item.type;\n                    return true;\n                }\n                else {\n                    return false;\n                }\n            });\n            let protectionConfig = null;\n            if (entitlement) {\n                if (entitlement.protectionInfo) {\n                    protectionConfig = entitlement.protectionInfo.find(protection => {\n                        return protection.type === 'PlayReady';\n                    });\n                }\n                const token = protectionConfig ? protectionConfig.authenticationToken : null;\n                const mediaInfo = new chrome.cast.media.MediaInfo(entitlement.src, contentType);\n                mediaInfo.streamType = chrome.cast.media.StreamType.BUFFERED;\n                mediaInfo.metadata = new chrome.cast.media.GenericMediaMetadata();\n                mediaInfo.metadata.metadataType = chrome.cast.media.MetadataType.GENERIC;\n                mediaInfo.metadata.title = getArticleTitle(article);\n                mediaInfo.tracks = tracks;\n                const licenceUrlParam = token\n                    ? {\n                        ...this.getLicenseUrlFromSrc(protectionConfig.keyDeliveryUrl, token),\n                    }\n                    : {};\n                const audieLocalePram = articlePlayConfig.audioLocale ? { preferredAudioLocale: articlePlayConfig.audioLocale } : {};\n                mediaInfo.customData = {\n                    ...licenceUrlParam,\n                    ...audieLocalePram,\n                    pulseToken: articlePlayConfig.pulseToken,\n                };\n                // @TODO\n                // mediaInfo.currentTime = articlePlayConfig.currentTime;\n                // mediaInfo.autoplay = true;\n                return mediaInfo;\n            }\n        }\n        return null;\n    }\n    getLicenseUrlFromSrc(src, token) {\n        if (token) {\n            const rootSrc = src.includes('?') ? `${src}&token=` : `${src}?token=`;\n            const licenseUrl = rootSrc + encodeURIComponent(token);\n            return {\n                licenseUrl,\n                token,\n            };\n        }\n        return {};\n    }\n    castVideo(playConfig, article, continueFromPreviousPosition) {\n        if (this.isConnected()) {\n            const castSession = this.castContext.getCurrentSession();\n            const mediaInfo = this.getCastMediaInfo(playConfig, article);\n            if (mediaInfo) {\n                const request = new chrome.cast.media.LoadRequest(mediaInfo);\n                request.currentTime = continueFromPreviousPosition ? playConfig.currentTime : 0;\n                if (playConfig.subtitleLocale) {\n                    // can NOT use .filter on tracks because the cast library has patched the Array.\n                    const textTrack = mediaInfo.tracks.find((track) => track.language === playConfig.subtitleLocale);\n                    if (textTrack) {\n                        request.activeTrackIds = [textTrack.trackId];\n                    }\n                }\n                return castSession.loadMedia(request);\n            }\n            else {\n                throw { message: 'Unexpected manifest format in articlePlayConfig' };\n            }\n        }\n    }\n    isConnected() {\n        return this.castPlayer && this.castPlayer.isConnected;\n    }\n    stopCasting() {\n        const castSession = cast.framework.CastContext.getInstance().getCurrentSession();\n        if (castSession) {\n            castSession.endSession(true);\n        }\n    }\n    getCastPlayer() {\n        return this.castPlayer;\n    }\n    getCastPlayerController() {\n        return this.castPlayerController;\n    }\n}\n","export function graphRequest(apiFetchUrl, query, variables, token) {\n    const authHeader = token ? { Authorization: 'Bearer ' + token } : {};\n    return fetch(apiFetchUrl, {\n        method: 'POST',\n        headers: {\n            'Content-Type': 'application/json',\n            Accept: 'application/json',\n            ...authHeader,\n        },\n        body: JSON.stringify({\n            query,\n            variables,\n        }),\n    }).then(response => response.json());\n}\n","import { graphRequest } from './graph-request';\nimport { articleAssetPlayMutation, articleQuery } from './queries';\nimport { toArticle, toPlayConfig } from './converters';\nexport class ApiService {\n    constructor(baseUrl, projectId) {\n        this.apiFetchUrl = `${baseUrl}/graphql/${projectId}`;\n        this.token = null;\n    }\n    setToken(token) {\n        this.token = token;\n    }\n    getArticleAssetPlayConfig(articleId, assetId, continueFromPreviousPosition) {\n        return graphRequest(this.apiFetchUrl, articleAssetPlayMutation, { articleId, assetId, protocols: ['dash', 'mss', 'hls'] }, this.token).then((response) => {\n            if (!response || !response.data || response.errors) {\n                const { message, code } = response.errors[0];\n                throw { message, code }; // @TODO to play config error\n            }\n            return toPlayConfig(response.data.ArticleAssetPlay, continueFromPreviousPosition);\n        });\n    }\n    getArticle(articleId) {\n        return graphRequest(this.apiFetchUrl, articleQuery, { articleId }, this.token).then((response) => {\n            if (!response || !response.data || response.errors) {\n                const { message, code } = response.errors[0];\n                throw { message, code };\n            }\n            return toArticle(response.data.Article);\n        });\n    }\n}\n","export const articleAssetPlayMutation = `\n    mutation ArticleAssetPlay($articleId: Int, $assetId: Int, $protocols: [ArticlePlayProtocolEnum]) {\n        ArticleAssetPlay(article_id: $articleId, asset_id: $assetId, protocols: $protocols) {\n            article_id\n            asset_id\n            entitlements {\n                mime_type\n                protocol\n                manifest\n                token\n                encryption_type\n                key_delivery_url\n            }\n            subtitles {\n                url\n                locale\n                locale_label\n            }\n            pulse_token\n            appa\n            appr\n            fairplay_certificate_url\n            user_subtitle_locale\n            user_audio_locale\n            aspect_ratio\n            issued_at\n        }\n    }\n`;\nexport const articleQuery = `\n    query Article($articleId: Int!) {\n        Article(id: $articleId) {\n            id\n            name\n            metas {\n                key\n                value\n            }\n            assets {\n                id\n                duration\n                linked_type\n                accessibility\n            }\n            posters {\n                type\n                url\n                title\n                base_url\n                file_name\n            }\n            images {\n                type\n                url\n                title\n                base_url\n                file_name\n            }\n        }\n    }\n`;\n","import { VideoPlayer } from './video-player/video-player';\nimport { ChromecastSender } from './chromecast/chromecast-sender';\nimport { ApiService } from './api/api-service';\nimport { getArticleBackgroundImage, getResizedUrl, toPlayConfigError } from './api/converters';\nexport class EmbedPlayer {\n    constructor(properties) {\n        this.projectId = properties.projectId;\n        this.apiBaseUrl = properties.apiBaseUrl.replace(/\\/*$/, '');\n        this.chromecastReceiverAppId = properties.chromecastReceiverAppId ? properties.chromecastReceiverAppId : null;\n        this.apiService = new ApiService(this.apiBaseUrl, this.projectId);\n        this.videoPlayer = new VideoPlayer(this.apiBaseUrl, this.projectId);\n        this.castSender = new ChromecastSender();\n    }\n    initVideoPlayer(initParams) {\n        this.videoPlayer.init(initParams);\n    }\n    setVideoPlayerPoster(posterUrl) {\n        this.videoPlayer.setPoster(posterUrl);\n    }\n    setVideoPlayerPosterFromArticle(articleId, posterSize) {\n        return this.apiService.getArticle(articleId).then(article => {\n            this.videoPlayer.setPoster(getResizedUrl(getArticleBackgroundImage(article), posterSize));\n        });\n    }\n    play(playParams) {\n        if (!playParams.articleId) {\n            return Promise.reject('articleId property is missing');\n        }\n        if (!playParams.assetId) {\n            return Promise.reject('assetId property is missing');\n        }\n        this.apiService.setToken(playParams.token ? playParams.token : null);\n        return this.apiService\n            .getArticleAssetPlayConfig(playParams.articleId, playParams.assetId, playParams.continueFromPreviousPosition)\n            .then(config => {\n            this.playVideo(config, playParams);\n            return config;\n        })\n            .catch(error => {\n            console.log(toPlayConfigError(error.code));\n            throw error;\n        });\n    }\n    destroy() {\n        this.videoPlayer.destroy();\n    }\n    playVideo(config, playParams) {\n        this.videoPlayer.play(config, playParams);\n    }\n    getVideoPlayer() {\n        this.videoPlayer.getPlayer();\n    }\n    initChromecast() {\n        if (!this.chromecastReceiverAppId) {\n            return Promise.reject('No Chromecast receiver app id');\n        }\n        return this.castSender.init(this.chromecastReceiverAppId);\n    }\n    appendChromecastButton(selector) {\n        const castButtonContaner = selector instanceof Element ? selector : document.querySelector(selector);\n        const castButton = document.createElement('google-cast-launcher');\n        castButtonContaner.appendChild(castButton);\n    }\n    castVideo({ articleId, assetId, token, continueFromPreviousPosition }) {\n        if (!articleId) {\n            return Promise.reject('articleId property is missing');\n        }\n        if (!assetId) {\n            return Promise.reject('assetId property is missing');\n        }\n        this.apiService.setToken(token);\n        return Promise.all([\n            this.apiService.getArticleAssetPlayConfig(articleId, assetId, continueFromPreviousPosition),\n            this.apiService.getArticle(articleId),\n        ])\n            .then(([config, article]) => {\n            this.castSender.castVideo(config, article, continueFromPreviousPosition);\n            return config;\n        })\n            .catch(error => {\n            console.log(toPlayConfigError(error.code));\n            throw error;\n        });\n    }\n    getCastPlayer() {\n        return this.castSender.getCastPlayer();\n    }\n    getCastPlayerController() {\n        return this.castSender.getCastPlayerController();\n    }\n    isConnected() {\n        return this.castSender.isConnected();\n    }\n    stopCasting() {\n        this.castSender.stopCasting();\n    }\n}\n//*** Example of usage ***//\n// const player = new EmbeddablePlayer();\n//\n// player\n//     .play({\n//         selector: '.video-wrapper',\n//         apiBaseUrl: '',\n//         projectId: '',\n//         articleId: '',\n//         assetId: '',\n//         token: '',\n//         posterImageUrl: '',\n//         fullScreen: false\n//         continueFromPreviousPosition: true\n//     })\n//     .then(config => {\n//         console.log('Config', config);\n//     })\n//     .catch(error => {\n//         console.log('Error', error);\n//     });\n//*** Example of usage with chromecast ***//\n// const player = new EmbeddablePlayer();\n// player.setupChromecast(\"#cast-wrapper\", CHROMECAST_RECEIVER_APP_ID);\n//\n// player\n//     .castVideo({\n//         apiBaseUrl: '',\n//         projectId: '',\n//         articleId: '',\n//         assetId: '',\n//         token: '',\n//         continueFromPreviousPosition: true\n//     })\n//     .then(config => {\n//         console.log('Config', config);\n//     })\n//     .catch(error => {\n//         console.log('Error', error);\n//     });\n","/// <reference path=\"../../node_modules/@types/chromecast-caf-sender/index.d.ts\" />\nexport class ChromecastControls {\n    constructor(player, controller, selector) {\n        this.player = player;\n        this.playerController = controller;\n        this.controlInitialized = false;\n        this.totalDuration = player.duration || 0;\n        this.currentTime = player.currentTime || 0;\n        this.currentStatus = player.playerState;\n        this.createChromecastControlsTemplate(selector);\n        this.bindEvents();\n        this.setPlayButtonClass();\n        this.bindEventsToControls();\n        this.setProgressBarValues();\n        this.setTitle();\n    }\n    bindEvents() {\n        this.playerController.addEventListener(cast.framework.RemotePlayerEventType.MEDIA_INFO_CHANGED, () => {\n            if (this.rootElement && this.player.mediaInfo) {\n                this.renderTracks();\n                this.renderTracksButton();\n                this.setTitle();\n            }\n        });\n        this.playerController.addEventListener(cast.framework.RemotePlayerEventType.CURRENT_TIME_CHANGED, e => {\n            if (this.rootElement) {\n                this.currentTime = e.value;\n                this.totalDuration = this.player.duration;\n                this.setProgressBarValues();\n            }\n        });\n        this.playerController.addEventListener(cast.framework.RemotePlayerEventType.PLAYER_STATE_CHANGED, e => {\n            if (this.rootElement) {\n                this.currentStatus = e.value;\n                this.checkChromecastContainerVisibility();\n                this.setPlayButtonClass();\n                this.setProgressBarValues();\n            }\n        });\n        this.checkChromecastContainerVisibility();\n    }\n    createChromecastControlsTemplate(selector) {\n        const chromecastControlsTemplateString = `\n            <div class=\"chromecast-controls\">\n               <div class=\"chromecast-controls__title\"></div>\n               <div class=\"chromecast-controls__progress-bar\">\n                 <div class=\"chromecast-controls__progress-bar__current\"></div>\n                 <input type=\"range\"\n                        value=\"0\"\n                        class=\"chromecast-controls__progress-bar__slider\" \n                        min=\"0\"\n                        max=\"100\"/>\n                 <div class=\"chromecast-controls__progress-bar__total\"></div>\n               </div>\n              <div class=\"chromecast-controls__buttons\">\n                <button class=\"control-button button__play play-pause-button\" type=\"button\"></button>\n                <button class=\"control-button button__stop\" type=\"button\"></button>\n                <div class=\"buttons-container tracks-button-container\" style=\"display: none\">\n                  <button class=\"control-button button__audio-tracks\" type=\"button\"></button>\n                  <div class=\"chromecast-controls__subtitles\" style=\"display: none\">\n                      <div class=\"chromecast-controls__subtitles__close-icon\">&#215;</div>\n                      <div class=\"container-wrapper container-wrapper_audio-tracks\">\n                        <div class=\"list-title\">Audio tracks</div>\n                      </div>\n                      <div class=\"container-wrapper container-wrapper_text-tracks\">\n                        <div class=\"list-title\">Text tracks</div>\n                      </div>\n                  </div>\n                </div>\n               </div>\n            </div>\n        `;\n        const element = !!selector ? document.querySelector(selector) : document.body;\n        element.insertAdjacentHTML('beforeend', chromecastControlsTemplateString);\n        this.rootElement = element.querySelector('.chromecast-controls');\n        this.rootElement.querySelector('.button__audio-tracks').addEventListener('click', () => this.toggleTracksDialogue());\n        this.rootElement\n            .querySelector('.chromecast-controls__subtitles__close-icon')\n            .addEventListener('click', () => this.toggleTracksDialogue());\n        this.rootElement.querySelector('.chromecast-controls__progress-bar__slider').addEventListener('input', event => {\n            this.seek(event.target.value);\n        });\n    }\n    setPlayButtonClass() {\n        const playAndPauseButton = this.getElement('.play-pause-button');\n        if (this.currentStatus === chrome.cast.media.PlayerState.PAUSED) {\n            playAndPauseButton.classList.replace('button__pause', 'button__play');\n        }\n        else {\n            playAndPauseButton.classList.replace('button__play', 'button__pause');\n        }\n    }\n    bindEventsToControls() {\n        const playAndPauseButton = this.getElement('.play-pause-button');\n        const stopButton = this.getElement('.button__stop');\n        if (!this.controlInitialized) {\n            playAndPauseButton.addEventListener('click', () => this.playPause());\n            stopButton.addEventListener('click', () => this.stop());\n            this.controlInitialized = true;\n        }\n    }\n    renderTracksButton() {\n        const tracksButtonContainerElement = this.getElement('.tracks-button-container');\n        const sessionMediaInfo = cast.framework.CastContext.getInstance()\n            .getCurrentSession()\n            .getMediaSession();\n        let audioTracks = [];\n        let textTracks = [];\n        if (this.player.mediaInfo && this.player.mediaInfo.tracks && sessionMediaInfo) {\n            audioTracks = this.getTracksByType('AUDIO');\n            textTracks = this.getTracksByType('TEXT');\n        }\n        if (audioTracks.length || textTracks.length) {\n            tracksButtonContainerElement.style.display = 'unset';\n        }\n        else {\n            tracksButtonContainerElement.style.display = 'none';\n        }\n    }\n    renderTracks() {\n        this.removeTracks();\n        const audioTracksContainerElement = this.getElement('.container-wrapper_audio-tracks');\n        const textTracksContainerElement = this.getElement('.container-wrapper_text-tracks');\n        const sessionMediaInfo = cast.framework.CastContext.getInstance()\n            .getCurrentSession()\n            .getMediaSession();\n        let audioTracks = [];\n        let textTracks = [];\n        if (this.player.mediaInfo && this.player.mediaInfo.tracks && sessionMediaInfo) {\n            audioTracks = this.getTracksByType('AUDIO');\n            textTracks = this.getTracksByType('TEXT');\n        }\n        if (audioTracks.length) {\n            audioTracksContainerElement.appendChild(this.getTracksList(audioTracks, 'AUDIO'));\n        }\n        if (textTracks.length) {\n            textTracksContainerElement.appendChild(this.getTracksList(textTracks, 'TEXT'));\n        }\n    }\n    removeTracks() {\n        const tracksListElements = this.rootElement.getElementsByClassName('list-container');\n        if (tracksListElements.length) {\n            Array.from(tracksListElements).forEach(element => {\n                element.remove();\n            });\n        }\n    }\n    toggleTracksDialogue() {\n        const tracksContainer = this.getElement('.chromecast-controls__subtitles');\n        if (tracksContainer.style.display === 'none') {\n            this.renderTracks();\n            tracksContainer.style.display = 'unset';\n        }\n        else {\n            tracksContainer.style.display = 'none';\n            this.removeTracks();\n        }\n    }\n    getTracksList(tracks, type) {\n        const tracksListElement = document.createElement('ul');\n        tracksListElement.classList.add('list-container');\n        tracksListElement.addEventListener('click', event => this.setActiveTrack(event, type === 'AUDIO' ? 'AUDIO' : 'TEXT'));\n        tracks.forEach(track => {\n            const listItemElement = document.createElement('li');\n            listItemElement.classList.add('list-item');\n            if (track.active) {\n                listItemElement.classList.add('active');\n            }\n            else {\n                listItemElement.classList.remove('active');\n            }\n            listItemElement.innerText = track.locale;\n            listItemElement.value = track.id;\n            tracksListElement.appendChild(listItemElement);\n        });\n        return tracksListElement;\n    }\n    getActiveTracksByType(type) {\n        return this.getTracksByType(type)\n            .filter(track => track.active)\n            .map(track => track.id);\n    }\n    getTracksByType(type) {\n        const sessionMediaInfo = cast.framework.CastContext.getInstance()\n            .getCurrentSession()\n            .getMediaSession();\n        return this.player.mediaInfo.tracks\n            .filter(track => track.type === type)\n            .map(track => ({\n            id: track.trackId,\n            locale: track.language,\n            active: sessionMediaInfo.activeTrackIds && sessionMediaInfo.activeTrackIds.indexOf(track.trackId) !== -1,\n        }));\n    }\n    setTitle() {\n        if (this.player.mediaInfo) {\n            const titleElement = this.getElement('.chromecast-controls__title');\n            titleElement.innerText = this.player.mediaInfo.metadata.title;\n        }\n    }\n    getTransformedDurationValue(value) {\n        const hours = Math.floor(value / 3600);\n        const minutes = Math.floor((value - hours * 3600) / 60);\n        const seconds = Math.round(value - hours * 3600 - minutes * 60);\n        let result = '';\n        if (!value && value === 0) {\n            return '-';\n        }\n        if (hours > 0) {\n            result = hours + ':';\n            if (minutes < 10) {\n                result += '0';\n            }\n        }\n        result += minutes + ':';\n        if (seconds < 10) {\n            result += '0';\n        }\n        return result + seconds;\n    }\n    setProgressBarValues() {\n        if (this.rootElement) {\n            const currentTimeElement = this.getElement('.chromecast-controls__progress-bar__current');\n            const totalTimeElement = this.getElement('.chromecast-controls__progress-bar__total');\n            const progressBarElement = this.getElement('.chromecast-controls__progress-bar__slider');\n            currentTimeElement.innerText = this.getTransformedDurationValue(this.currentTime);\n            totalTimeElement.innerText = this.getTransformedDurationValue(this.totalDuration);\n            progressBarElement.max = this.totalDuration;\n            progressBarElement.value = this.currentTime;\n        }\n    }\n    checkChromecastContainerVisibility() {\n        if (this.currentStatus === chrome.cast.media.PlayerState.IDLE) {\n            this.rootElement.style.display = 'none';\n        }\n        else {\n            this.rootElement.style.display = 'block';\n        }\n    }\n    playPause() {\n        if (this.player && this.player.isConnected) {\n            this.playerController.playOrPause();\n        }\n    }\n    seek(newTime) {\n        if (this.player && this.player.isConnected) {\n            this.player.currentTime = newTime;\n            this.playerController.seek();\n        }\n    }\n    stop() {\n        if (this.player && this.player.isConnected) {\n            this.playerController.stop();\n        }\n    }\n    setActiveTrack(event, type) {\n        if (event.target instanceof HTMLLIElement && event.target.nodeName === 'LI') {\n            event.stopPropagation();\n            const selectedTrackId = event.target.value;\n            const activeTracks = this.getActiveTracksByType(type === 'AUDIO' ? 'TEXT' : 'AUDIO');\n            if (selectedTrackId > 0 && activeTracks.indexOf(selectedTrackId) === -1) {\n                activeTracks.push(selectedTrackId);\n            }\n            this.setActiveTracks(activeTracks);\n        }\n    }\n    setActiveTracks(trackIds) {\n        if (this.player && this.player.isConnected) {\n            const media = cast.framework.CastContext.getInstance()\n                .getCurrentSession()\n                .getMediaSession();\n            const tracksInfoRequest = new chrome.cast.media.EditTracksInfoRequest(trackIds);\n            media.editTracksInfo(tracksInfoRequest, () => {\n                this.toggleTracksDialogue();\n            }, (error) => console.error('ChromeCast', error));\n        }\n    }\n    getElement(selector) {\n        return this.rootElement.querySelector(selector);\n    }\n}\n"],"names":["PlayingState","PlayerEventTypes","PlayerDeviceTypes","PlayerEventTypePayloads","PulseMode","__webpack_require__","exports","definition","key","o","Object","defineProperty","enumerable","get","obj","prop","prototype","hasOwnProperty","call","PlayerLogProcessor","constructor","baseUrl","projectId","this","playLogs","apiCallInProgress","intervalHandle","apiUrl","replace","init","setInterval","processFirstPlayLog","destroy","clearInterval","processPlaySession","playSession","timeStamp","eventStack","length","eventStackPayload","i","sumDelta","lastEventWasProcessed","currentEvent","isEventTypeWithoutTimeDelta","eventType","push","convertEventToEventPayload","previousEvent","state","createDeltaEventPayload","lastEvent","lastLogEvent","splice","MAX_EVENTS","event_type","error","event_payload","playLogPayload","getPlayerLogPayloadWithPulseToken","pulseToken","event_stack","pulse_token","pulse_mode","isLive","live","offline","device_type","deviceType","forEach","e","processPlayLog","currentLog","removePlayLog","logToSend","eventStackIndex","isStopCutOff","stop","fetch","method","headers","Accept","body","JSON","stringify","then","catch","status","response","archive","find","log","logPayload","index","findIndex","textTrackChanged","audioTrackChanged","playStart","indexOf","createBaseEventPayload","playerEvent","timestamp","appa","playPosition","appr","Math","min","mediaDuration","play","convertEventTypeToEventTypePayload","baseEvent","audio_locale","audioTrack","subtitle_locale","textTrack","timeDelta","getEventTypePayloadFromEventState","time_delta","playing","paused","buffering","loading","idle","configure","PlayerLoggerService","playerLogProcessor","reset","onStart","localTimeDelta","onStopCallback","onCurrentTimeUpdated","currentTime","playerProperties","logEvent","timeupdate","onDurationUpdated","duration","onPlaying","startInterval","onPause","pause","onError","onStop","stopped","stopInterval","onTextTrackChanged","onAudioTrackChanged","updateProperties","getTimeStamp","Date","now","PlaybackRateMenuButton","videojs","getComponent","CustomPlaybackRateMenuButton","player","options","super","createEl","el","innerHTML","AudioTrackButton","MenuItem","CustomAudioTrackMenuItem","track","tracks","audioTracks","label","lang","locale","countryCode","countryISOMapping","AFG","ALA","ALB","DZA","ASM","AND","AGO","AIA","ATA","ATG","ARG","ARM","ABW","AUS","AUT","AZE","BHS","BHR","BGD","BRB","BLR","BEL","BLZ","BEN","BMU","BTN","BOL","BES","BIH","BWA","BVT","BRA","VGB","IOT","BRN","BGR","BFA","BDI","KHM","CMR","CAN","CPV","CYM","CAF","TCD","CHL","CHN","HKG","MAC","CXR","CCK","COL","COM","COG","COD","COK","CRI","CIV","HRV","CUB","CUW","CYP","CZE","DNK","DJI","DMA","DOM","ECU","EGY","SLV","GNQ","ERI","EST","ETH","FLK","FRO","FJI","FIN","FRA","GUF","PYF","ATF","GAB","GMB","GEO","DEU","GHA","GIB","GRC","GRL","GRD","GLP","GUM","GTM","GGY","GIN","GNB","GUY","HTI","HMD","VAT","HND","HUN","ISL","IND","IDN","IRN","IRQ","IRL","IMN","ISR","ITA","JAM","JPN","JEY","JOR","KAZ","KEN","KIR","PRK","KOR","KWT","KGZ","LAO","LVA","LBN","LSO","LBR","LBY","LIE","LTU","LUX","MKD","MDG","MWI","MYS","MDV","MLI","MLT","MHL","MTQ","MRT","MUS","MYT","MEX","FSM","MDA","MCO","MNG","MNE","MSR","MAR","MOZ","MMR","NAM","NRU","NPL","NLD","ANT","NCL","NZL","NIC","NER","NGA","NIU","NFK","MNP","NOR","OMN","PAK","PLW","PSE","PAN","PNG","PRY","PER","PHL","PCN","POL","PRT","PRI","QAT","REU","ROU","RUS","RWA","BLM","SHN","KNA","LCA","MAF","SPM","VCT","WSM","SMR","STP","SAU","SEN","SRB","SYC","SLE","SGP","SXM","SVK","SVN","SLB","SOM","ZAF","SGS","SSD","ESP","LKA","SDN","SUR","SJM","SWZ","SWE","CHE","SYR","TWN","TJK","TZA","THA","TLS","TGO","TKL","TON","TTO","TUN","TUR","TKM","TCA","TUV","UGA","UKR","ARE","GBR","USA","UMI","URY","UZB","VUT","VEN","VNM","VIR","WLF","ESH","YEM","ZMB","ZWE","XKX","toUpperCase","toLowerCase","substr","getLocaleFromLanguage","isoLocales","ab","name","nativeName","aa","af","ak","sq","am","ar","an","hy","as","av","ae","ay","az","bm","ba","eu","be","bn","bh","bi","bs","br","bg","my","ca","ch","ce","ny","zh","cv","kw","co","cr","hr","cs","da","dv","nl","en","eo","et","ee","fo","fj","fi","fr","ff","gl","ka","de","gn","gu","ht","ha","he","hz","hi","ho","hu","ia","id","ie","ga","ig","ik","io","is","it","iu","ja","jv","kl","kn","kr","ks","kk","km","ki","rw","ky","kv","kg","ko","ku","kj","la","lb","lg","li","ln","lo","lt","lu","lv","gv","mk","mg","ms","ml","mt","mi","mr","mh","mn","na","nv","nb","nd","ne","ng","nn","no","ii","nr","oc","oj","cu","om","or","os","pa","pi","fa","pl","ps","pt","qu","rm","rn","ro","ru","sa","sc","sd","se","sm","sg","sr","gd","sn","si","sk","sl","so","st","es","su","sw","ss","sv","ta","te","tg","th","ti","bo","tk","tl","tn","to","tr","ts","tt","tw","ty","ug","uk","ur","uz","ve","vi","vo","wa","cy","wo","fy","xh","yi","yo","za","mis","mul","und","zxx","getNativeLanguage","language","selected","enabled","addClass","kind","changeHandler","args","handleTracksChange","apply","addEventListener","on","removeEventListener","type","props","attrs","parentSpan","querySelector","options_","appendChild","className","textContent","localize","handleClick","event","player_","tech_","featuresNativeAudioTracks","CustomAudioTrackButton","createItems","items","hideThreshold_","selectable","multiSelectable","VideoPlayer","playerLoggerService","registerComponent","initParams","videoContainer","selector","Element","document","Error","videoElement","createElement","setAttribute","join","playOptions","fluid","responsive","controls","controlBar","pictureInPictureToggle","currentTimeDisplay","durationDisplay","timeDivider","skipButtons","forward","volumePanel","inline","children","aspectRatio","html5","vhs","overrideNative","eme","bindEvents","playConfig","playParams","firstPlayingEvent","currentSrc","articlePlayConfig","default","hlsSources","entitlements","filter","entitlement","configureHLSOnly","browser","IS_SAFARI","IS_IOS","playSources","map","emeOptions","protectionInfo","p","keySystems","keyDeliveryUrl","emeHeaders","Authorization","authenticationToken","certificateUri","certificateUrl","getContentId","uri","link","href","hostname","getHostnameFromUri","getLicense","contentId","keyMessage","callback","payload","a","b","c","d","byteLength","charAt","binaryToBase64","encodeURIComponent","xhr","responseType","httpHandler","err","String","fromCharCode","Uint8Array","trim","ArrayBuffer","f","g","h","buffer","base64ToBinary","parseLicenseResponse","getEmeOptionsFromEntitlement","src","playOption","fullscreen","requestFullscreen","subtitles","addRemoteTextTrack","srclang","subtitleLocale","setPoster","posterUrl","poster","ended","dispose","getPlayer","checkSelectedTracks","audioTrackList","setDefaultAudioTrack","setDefaultTextTrack","metadataLoaded","setTimeout","selectedAudioTrack","selectedTextTrack","textTracks","mode","currentTextTrack","currentAudioTrack","audioLocale","ArticlePlayErrors","toFile","file","url","base_url","fileName","file_name","toPlayConfigError","code","offlineError","notAuthenticated","needEntitlement","noPlayableAsset","maxConcurrentStreamNumberError","serverError","ChromecastSender","castContext","castPlayer","castPlayerController","chromecastReceiverAppId","Promise","resolve","reject","window","isAvailable","cast","framework","initializeCastApi","scriptElement","head","CastContext","getInstance","setOptions","receiverApplicationId","autoJoinPolicy","chrome","AutoJoinPolicy","ORIGIN_SCOPED","RemotePlayer","RemotePlayerController","getCastMediaInfo","article","option","trackId","castTrack","media","Track","TrackType","TEXT","trackContentId","trackContentType","subtype","TextTrackType","SUBTITLES","customData","contentType","supportedContentTypes","item","includes","protectionConfig","protection","token","mediaInfo","MediaInfo","streamType","StreamType","BUFFERED","metadata","GenericMediaMetadata","metadataType","MetadataType","GENERIC","title","metas","meta","m","value","getMetaValue","getArticleTitle","licenceUrlParam","getLicenseUrlFromSrc","audieLocalePram","preferredAudioLocale","licenseUrl","castVideo","continueFromPreviousPosition","isConnected","castSession","getCurrentSession","request","LoadRequest","activeTrackIds","loadMedia","message","stopCasting","endSession","getCastPlayer","getCastPlayerController","graphRequest","apiFetchUrl","query","variables","json","ApiService","setToken","getArticleAssetPlayConfig","articleId","assetId","protocols","data","errors","config","parse","issued_at","configEntitlements","encryption_type","dashWidevine","protocol","mssPlayReady","configEntitlement","manifest","mime_type","key_delivery_url","fairplay_certificate_url","locale_label","user_subtitle_locale","user_audio_locale","isNaN","aspect_ratio","toPlayConfig","ArticleAssetPlay","getArticle","Article","posters","images","EmbedPlayer","properties","apiBaseUrl","apiService","videoPlayer","castSender","initVideoPlayer","setVideoPlayerPoster","setVideoPlayerPosterFromArticle","posterSize","fileData","size","width","height","getResizedUrl","getArticleBackgroundImage","playVideo","console","getVideoPlayer","initChromecast","appendChromecastButton","castButtonContaner","castButton","all","ChromecastControls","controller","playerController","controlInitialized","totalDuration","currentStatus","playerState","createChromecastControlsTemplate","setPlayButtonClass","bindEventsToControls","setProgressBarValues","setTitle","RemotePlayerEventType","MEDIA_INFO_CHANGED","rootElement","renderTracks","renderTracksButton","CURRENT_TIME_CHANGED","PLAYER_STATE_CHANGED","checkChromecastContainerVisibility","element","insertAdjacentHTML","toggleTracksDialogue","seek","target","playAndPauseButton","getElement","PlayerState","PAUSED","classList","stopButton","playPause","tracksButtonContainerElement","sessionMediaInfo","getMediaSession","getTracksByType","style","display","removeTracks","audioTracksContainerElement","textTracksContainerElement","getTracksList","tracksListElements","getElementsByClassName","Array","from","remove","tracksContainer","tracksListElement","add","setActiveTrack","listItemElement","active","innerText","getActiveTracksByType","getTransformedDurationValue","hours","floor","minutes","seconds","round","result","currentTimeElement","totalTimeElement","progressBarElement","max","IDLE","playOrPause","newTime","HTMLLIElement","nodeName","stopPropagation","selectedTrackId","activeTracks","setActiveTracks","trackIds","tracksInfoRequest","EditTracksInfoRequest","editTracksInfo"],"sourceRoot":""}